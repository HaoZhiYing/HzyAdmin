import{d as $,x as N,a5 as L,E,q as O,m as w,r as l,o as s,e as _,w as o,a,u as r,j as p,i as m,c as k,f as V}from"./index-2f630cca.js";import{_ as F}from"./AppIcon.vue_vue_type_script_setup_true_lang-5b59e4b3.js";import{S,_ as j}from"./Info.vue_vue_type_script_setup_true_lang-55f9c3b4.js";import{_ as I}from"./PageContainer.vue_vue_type_script_setup_true_lang-554ea529.js";import{_ as U}from"./TableCurd.vue_vue_type_script_setup_true_lang-0417d9e7.js";const M={key:0},q={key:1},P=["onClick"],G=["onClick"],H=V("a",{class:"text-danger"},"\u5220\u9664",-1),J=$({name:"system_function"}),te=$({...J,setup(Q){const t=N({search:{state:!1,vm:{name:void 0}},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),i=L(),h=E(),v=E(),A=E();O(()=>{f()});async function f(){try{t.loading=!0;const d=await S.findList(t.search.vm);if(t.loading=!1,d.code!=1)return;t.data=w.genTreeData(d.data,null),t.expandedRowKeys=d.data.map(e=>e.id)}catch{t.loading=!1}}async function B(d){var C,g;let e=[];if(d?e.push(d):e=(g=(C=h.value)==null?void 0:C.getSelectedRowKeys())!=null?g:[],e.length==0)return w.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{t.loading=!0;const y=await S.deleteList(e);if(t.loading=!1,y.code!=1)return;w.message.success("\u5220\u9664\u6210\u529F!"),f()}catch{t.loading=!1}}return(d,e)=>{const C=l("a-input"),g=l("a-form-item"),y=l("a-col"),x=l("a-button"),K=l("a-space"),R=l("a-row"),z=l("a-form"),D=l("a-popconfirm"),c=l("a-table-column"),b=l("a-divider");return s(),_(I,null,{default:o(()=>[a(U,{ref_key:"refTableCurd",ref:h,config:t,onChange:e[6]||(e[6]=({page:n,pageSize:u})=>{t.page=n==0?1:n,t.size=u,f()}),onShowSizeChange:e[7]||(e[7]=({current:n,size:u})=>{t.page=n==0?1:n,t.size=u,f()}),expandedRowKeys:t.expandedRowKeys,"onUpdate:expandedRowKeys":e[8]||(e[8]=n=>t.expandedRowKeys=n)},{search:o(()=>[r(i).search?(s(),_(z,{key:0,ref_key:"refSearchForm",ref:A,model:t.search.vm},{default:o(()=>[a(R,{gutter:[16,0]},{default:o(()=>[a(y,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(g,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:o(()=>[a(C,{value:t.search.vm.name,"onUpdate:value":e[0]||(e[0]=n=>t.search.vm.name=n),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),a(y,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:o(()=>[a(K,{size:8},{default:o(()=>[a(x,{onClick:e[1]||(e[1]=n=>{var u;t.page=1,(u=A.value)==null||u.resetFields(),f()})},{default:o(()=>[p(" \u91CD\u7F6E ")]),_:1}),a(x,{type:"primary",onClick:e[2]||(e[2]=n=>{t.page=1,f()})},{default:o(()=>[p(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):m("",!0)]),"toolbar-left":o(()=>[r(i).search?(s(),_(x,{key:0,onClick:e[3]||(e[3]=n=>t.search.state=!t.search.state)},{default:o(()=>[t.search.state?(s(),k("div",M,[a(F,{name:"UpOutlined"}),p("\xA0\xA0\u6536\u8D77")])):(s(),k("div",q,[a(F,{name:"DownOutlined"}),p("\xA0\xA0\u5C55\u5F00")]))]),_:1})):m("",!0),r(i).insert?(s(),_(x,{key:1,type:"primary",onClick:e[4]||(e[4]=()=>{var n;return(n=v.value)==null?void 0:n.open()})},{icon:o(()=>[a(F,{name:"PlusOutlined"})]),default:o(()=>[p(" \u65B0\u5EFA ")]),_:1})):m("",!0),r(i).delete?(s(),_(D,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:e[5]||(e[5]=n=>B()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[a(x,{type:"primary",danger:""},{icon:o(()=>[a(F,{name:"DeleteOutlined"})]),default:o(()=>[p(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):m("",!0)]),"toolbar-right":o(()=>[]),"table-col":o(()=>[a(c,{title:"\u5206\u7EC4\u540D\u79F0/\u952E","data-index":"name"}),a(c,{title:"\u503C","data-index":"value"}),a(c,{title:"\u6240\u5C5E\u5206\u7EC4","data-index":"parentName"}),a(c,{title:"\u5E8F\u53F7","data-index":"sort"}),a(c,{title:"\u552F\u4E00\u7F16\u7801","data-index":"code"}),a(c,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),a(c,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),r(i).update||r(i).delete||r(i).insert?(s(),_(c,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:o(({record:n})=>[r(i).insert?(s(),k("a",{key:0,href:"javascript:void(0)",onClick:u=>{var T;return(T=v.value)==null?void 0:T.open(null,n.id)}},"\u65B0\u5EFA",8,P)):m("",!0),a(b,{type:"vertical"}),r(i).update?(s(),k("a",{key:1,href:"javascript:;",onClick:()=>{var u;return(u=v.value)==null?void 0:u.open(n.id,n.parentId)}},"\u7F16\u8F91",8,G)):m("",!0),a(b,{type:"vertical"}),r(i).delete?(s(),_(D,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:u=>B(n.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[H]),_:2},1032,["onConfirm"])):m("",!0)]),_:1})):m("",!0)]),_:1},8,["config","expandedRowKeys"]),a(j,{ref_key:"refInfo",ref:v,onSuccess:()=>f()},null,8,["onSuccess"])]),_:1})}}});export{te as default};
