var y=Object.defineProperty;var A=(s,o,u)=>o in s?y(s,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[o]=u;var g=(s,o,u)=>(A(s,typeof o!="symbol"?o+"":o,u),u);import{_ as b}from"./PageContainer.vue_vue_type_script_setup_true_lang-660ebdad.js";import{R as h,d as D,C as m,q as k,a2 as w,r as c,o as I,e as M,w as a,a as l,f as e,i as _,t as i,U as S,V as T}from"./index-07368c36.js";import{_ as N}from"./_plugin-vue_export-helper-c4cb8a60.js";import"./AppIcon.vue_vue_type_script_setup_true_lang-66731724.js";class v{static getEFCoreMonitorContext(){return h.post(`${this.urlPrefix}/GetEFCoreMonitorContext/`)}static getTimeConsumingRanking(){return h.post(`${this.urlPrefix}/GetTimeConsumingRanking/`)}static getNewest(){return h.post(`${this.urlPrefix}/GetNewest/`)}}g(v,"urlPrefix","/api/admin/MonitorEFCore");const n=s=>(S("data-v-48d92d4a"),s=s(),T(),s),q=n(()=>e("div",null,"\u6570\u636E\u8FDE\u63A5\u6253\u5F00",-1)),P=n(()=>e("span",null,"\u6B21",-1)),R=n(()=>e("div",null,"\u6570\u636E\u8FDE\u63A5\u65AD\u5F00",-1)),V=n(()=>e("span",null,"\u6B21",-1)),$=n(()=>e("div",null,"\u8FDE\u63A5\u5931\u8D25",-1)),G=n(()=>e("span",null,"\u6B21",-1)),U=n(()=>e("div",null,"\u521B\u5EFA\u547D\u4EE4",-1)),z=n(()=>e("span",null,"\u6B21",-1)),H=n(()=>e("div",null,"\u6267\u884C\u547D\u4EE4",-1)),j=n(()=>e("span",null,"\u6B21",-1)),J=n(()=>e("div",null,"\u547D\u4EE4\u6267\u884C\u5931\u8D25",-1)),K=n(()=>e("span",null,"\u6B21",-1)),L=n(()=>e("div",null,"\u521B\u5EFA\u4E8B\u52A1",-1)),O=n(()=>e("span",null,"\u6B21",-1)),Q=n(()=>e("div",null,"\u63D0\u4EA4\u4E8B\u52A1",-1)),W=n(()=>e("span",null,"\u6B21",-1)),X=n(()=>e("div",null,"\u56DE\u6EDA\u4E8B\u52A1",-1)),Y=n(()=>e("span",null,"\u6B21",-1)),Z=n(()=>e("div",null,"\u4E8B\u52A1\u5931\u8D25",-1)),tt=n(()=>e("span",null,"\u6B21",-1)),et={class:"text-danger"},nt=D({name:"monitor_efcore"}),ut=D({...nt,setup(s){const o=m(!1),u=m({}),C=m();let E=null;k(()=>{x(),E=setInterval(()=>{x()},15*1e3)}),w(()=>{clearInterval(E)});async function x(){o.value=!0;const r=await v.getEFCoreMonitorContext();if(o.value=!1,r.code!=1)return;u.value=r.data,o.value=!0;const p=await v.getTimeConsumingRanking();o.value=!1,p.code==1&&(C.value=p.data)}return(r,p)=>{const d=c("a-card-grid"),B=c("a-card"),f=c("a-table-column"),F=c("a-table");return I(),M(b,null,{default:a(()=>[l(B,{title:!1,bodyStyle:{display:"flex"}},{default:a(()=>[l(d,null,{default:a(()=>{var t;return[q,e("h1",null,[_(i((t=u.value.openDbConnectionCount)!=null?t:0)+" ",1),P])]}),_:1}),l(d,null,{default:a(()=>{var t;return[R,e("h1",null,[_(i((t=u.value.closeDbConnectionCount)!=null?t:0)+" ",1),V])]}),_:1}),l(d,null,{default:a(()=>{var t;return[$,e("h1",null,[_(i((t=u.value.connectionFailedCount)!=null?t:0)+" ",1),G])]}),_:1}),l(d,null,{default:a(()=>{var t;return[U,e("h1",null,[_(i((t=u.value.createCommandCount)!=null?t:0)+" ",1),z])]}),_:1}),l(d,null,{default:a(()=>{var t;return[H,e("h1",null,[_(i((t=u.value.executeCommandCount)!=null?t:0)+" ",1),j])]}),_:1})]),_:1}),l(B,{title:!1,bodyStyle:{display:"flex"},style:{"border-top":"0"}},{default:a(()=>[l(d,null,{default:a(()=>{var t;return[J,e("h1",null,[_(i((t=u.value.commandFailedCount)!=null?t:0)+" ",1),K])]}),_:1}),l(d,null,{default:a(()=>{var t;return[L,e("h1",null,[_(i((t=u.value.createTransactionCount)!=null?t:0)+" ",1),O])]}),_:1}),l(d,null,{default:a(()=>{var t;return[Q,e("h1",null,[_(i((t=u.value.submitTransactionCount)!=null?t:0)+" ",1),W])]}),_:1}),l(d,null,{default:a(()=>{var t;return[X,e("h1",null,[_(i((t=u.value.rollBackCount)!=null?t:0)+" ",1),Y])]}),_:1}),l(d,null,{default:a(()=>{var t;return[Z,e("h1",null,[_(i((t=u.value.transactionFailedCount)!=null?t:0)+" ",1),tt])]}),_:1})]),_:1}),l(F,{"data-source":C.value,size:"middle",pagination:!1},{default:a(()=>[l(f,{key:"sql",title:"Sql Script","data-index":"sql"}),l(f,{key:"elapsedMilliseconds",title:"\u8017\u65F6","data-index":"elapsedMilliseconds",width:100},{default:a(({record:t})=>[e("span",et,i(t.elapsedMilliseconds)+" \u6BEB\u79D2",1)]),_:1}),l(f,{key:"time",title:"\u6267\u884C\u65F6\u95F4","data-index":"time",width:200})]),_:1},8,["data-source"])]),_:1})}}});const dt=N(ut,[["__scopeId","data-v-48d92d4a"]]);export{dt as default};
