import{b as R,r as U,V as O,a as S,i as $,o as z,j as r,k as i,c as _,g as a,w as t,f as p,q as f,A as k,C as h,F as x,x as D,n as d,d as F,t as A,aS as K,e as M}from"./index-3c68c560.js";import q from"./List-83d6a510.js";import{I as J,s as y}from"./Info-896bfa9f.js";import"./WangEditor-8703e999.js";import"./FindBack-b4071892.js";import"./Index-cd6bf463.js";import"./Info-d1fb755a.js";import"./organizationService-73a6c5a7.js";const G=d("\u67E5\u8BE2"),H=d("\u91CD\u7F6E"),Q=d(" \u65B0\u5EFA "),W=d(" \u6279\u91CF\u5220\u9664 "),X=d("\u5BFC\u51FA Excel"),Y=d(" \u66F4\u591A\u64CD\u4F5C "),Z=d("\u91CD\u7F6E"),ee=d(" \u68C0\u7D22 "),te=["src"],ne=["onClick"],oe=["onClick"],ae=F("a",{class:"text-danger"},"\u5220\u9664",-1),le={name:"base_member"},fe=Object.assign(le,{setup(se){const j=R(),o=U({search:{state:!1,fieldCount:2,vm:{name:""}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,columns:[],data:[],domainName:O.domainName}),b=S(null),g=S(null),c=j.getPowerByMenuId($.currentRoute.value.meta.menuId),s={onChange(l){const{currentPage:e,pageSize:u}=l;o.page=e==0?1:e,o.rows=u,s.findList()},onResetSearch(){o.page=1;let l=o.search.vm;for(let e in l)l[e]="";s.findList()},findList(){o.loading=!0,y.findList(o.rows,o.page,o.search.vm).then(l=>{let e=l.data;o.loading=!1,o.page=e.page,o.rows=e.size,o.total=e.total,o.columns=e.columns,o.data=e.dataSource})},deleteList(l){let e=[];l?e.push(l):e=g.value.table.getCheckboxRecords().map(u=>u.id),y.deleteList(e).then(u=>{u.code==1&&(A.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),s.findList())})},openForm(l){b.value.openForm({visible:!0,key:l})},exportExcel(){y.exportExcel(o.search.vm)},jumpDetails(l){$.push(`/base/member/details/${l.id}/${l.name}`)},handlePhoto(l){if(l){var e=JSON.parse(l);return O.domainName+(e.length>0?e[0].url:"")}return null}};return z(()=>{s.findList()}),(l,e)=>{const u=r("a-input"),w=r("a-col"),m=r("a-button"),B=r("a-row"),L=r("a-popconfirm"),T=r("a-menu-item"),V=r("a-menu"),E=r("a-dropdown"),I=r("a-checkbox"),P=r("a-popover"),C=r("vxe-column"),N=r("a-divider");return i(),_("div",null,[a(q,{ref_key:"refList",ref:g,tableData:o,onOnChange:s.onChange},{search:t(()=>[a(B,{gutter:[15,15]},{default:t(()=>[a(w,{xs:24,sm:12,md:8,lg:6,xl:4},{default:t(()=>[a(u,{value:o.search.vm.name,"onUpdate:value":e[0]||(e[0]=n=>o.search.vm.name=n),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),a(w,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:t(()=>[a(m,{type:"primary",class:"mr-15",onClick:s.findList},{default:t(()=>[G]),_:1},8,["onClick"]),a(m,{class:"mr-15",onClick:s.onResetSearch},{default:t(()=>[H]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":t(()=>[p(c).insert?(i(),f(m,{key:0,type:"primary",onClick:e[1]||(e[1]=n=>s.openForm())},{icon:t(()=>[a(k,{name:"PlusOutlined"})]),default:t(()=>[Q]),_:1})):h("",!0),p(c).delete?(i(),f(L,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:e[2]||(e[2]=n=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[a(m,{type:"danger"},{icon:t(()=>[a(k,{name:"DeleteOutlined"})]),default:t(()=>[W]),_:1})]),_:1})):h("",!0),a(E,null,{overlay:t(()=>[a(V,null,{default:t(()=>[a(T,{key:"1",onClick:s.exportExcel},{default:t(()=>[X]),_:1},8,["onClick"])]),_:1})]),default:t(()=>[a(m,null,{default:t(()=>[Y,a(k,{name:"DownOutlined"})]),_:1})]),_:1})]),"toolbar-right":t(()=>[a(u,{value:o.search.vm.name,"onUpdate:value":e[3]||(e[3]=n=>o.search.vm.name=n),placeholder:"\u540D\u79F0",onKeyup:s.findList},null,8,["value","onKeyup"]),a(m,{onClick:s.onResetSearch},{default:t(()=>[Z]),_:1},8,["onClick"]),p(c).search?(i(),f(m,{key:0,onClick:e[4]||(e[4]=n=>o.search.state=!o.search.state)},{icon:t(()=>[a(k,{name:o.search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:t(()=>[ee]),_:1})):h("",!0),a(P,null,{content:t(()=>[(i(!0),_(x,null,D(o.columns.filter(n=>n.fieldName.substr(0,1)!="_"),n=>(i(),_("div",null,[a(I,{checked:n.show,"onUpdate:checked":v=>n.show=v,onChange:e[5]||(e[5]=()=>K(()=>g.value.table.refreshColumn()))},{default:t(()=>[d(M(n.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[a(m,null,{default:t(()=>[a(k,{name:"BarsOutlined"})]),_:1})]),_:1})]),"table-col-default":t(()=>[(i(!0),_(x,null,D(o.columns.filter(n=>n.fieldName!="id"),n=>(i(),_(x,null,[n.fieldName=="photo"?(i(),f(C,{field:n.fieldName,title:n.title,visible:n.show,key:n.id},{default:t(({row:v})=>[F("img",{src:s.handlePhoto(v.photo),width:"35",height:"35"},null,8,te)]),_:2},1032,["field","title","visible"])):(i(),f(C,{field:n.fieldName,title:n.title,visible:n.show,key:n.id},null,8,["field","title","visible"]))],64))),256)),p(c).update||p(c).delete?(i(),f(C,{key:0,field:"id",title:"\u64CD\u4F5C"},{default:t(({row:n})=>[p(c).update?(i(),_("a",{key:0,href:"javascript:void(0)",onClick:v=>s.jumpDetails(n)},"\u8BE6\u60C5",8,ne)):h("",!0),a(N,{type:"vertical"}),p(c).update?(i(),_("a",{key:1,href:"javascript:void(0)",onClick:v=>s.openForm(n.id)},"\u7F16\u8F91",8,oe)):h("",!0),a(N,{type:"vertical"}),p(c).delete?(i(),f(L,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:v=>s.deleteList(n.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[ae]),_:2},1032,["onConfirm"])):h("",!0)]),_:1})):h("",!0)]),_:1},8,["tableData","onOnChange"]),a(J,{ref_key:"refForm",ref:b,onOnSuccess:e[6]||(e[6]=()=>s.findList())},null,512)])}}});export{fe as default};
