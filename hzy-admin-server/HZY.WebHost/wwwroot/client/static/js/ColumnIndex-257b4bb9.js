import{p as h,b as A,r as G,a as y,i as M,I as q,aS as U,j as i,k as m,q as f,w as a,g as e,d as V,L as H,M as E,f as Q,A as x,C as W,n as d,e as I,t as L}from"./index-3c68c560.js";import X from"./CodeGeneration-e6c3f791.js";import{_ as Y}from"./CodeLoadToProject-a46f32bd.js";import"./code_generation_service-61fe33f0.js";import"./MdEditorShowCode-7e7bbef1.js";const w="admin/LowCodeTableInfo";var C={findList(c,k,N={}){return h(`${w}/findList/${c}/${k}`,N,!1)},deleteList(c){return c&&c.length===0?tools.message("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E!","\u8B66\u544A"):h(`${w}/deleteList`,c,!1)},synchronization(c){return h(`${w}/synchronization/${c}`,null,!1)},change(c){return h(`${w}/change`,c,!1)}};const Z=d("\u67E5\u8BE2"),ee=d("\u91CD\u7F6E"),te=d(" \u68C0\u7D22 "),ae=d(" \u540C\u6B65\u5B57\u6BB5 "),le=d(" \u63D0\u4EA4\u66F4\u6539 "),oe=d(" \u6279\u91CF\u5220\u9664 "),ne=d("\u662F"),se=d("\u5426"),ie=d("\u662F"),re=d("\u5426"),de=V("a",{class:"text-danger"},"\u5220\u9664",-1),ce={name:"LowCode-ColumnIndex"},be=Object.assign(ce,{setup(c,{expose:k}){const N=A(),t=G({table:{search:{state:!1,vm:{columnName:null,describe:null,low_Code_TableId:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:20,page:1,total:0,data:[]},row:{},title:"",activeKey:"1"}),O=y(null),z=y(null),$=y(null),P=y(null),K=N.getPowerByMenuId(M.currentRoute.value.meta.menuId),s={onChange(n){const{currentPage:l,pageSize:u}=n;t.table.page=l==0?1:l,t.table.rows=u,s.findList()},onResetSearch(){t.table.page=1;let n=t.table.search.vm;for(let l in n)l!="low_Code_TableId"&&(n[l]=null);s.findList()},findList(){t.table.loading=!0,C.findList(t.table.rows,t.table.page,t.table.search.vm).then(n=>{let l=n.data;t.table.loading=!1,t.table.page=l.page,t.table.rows=l.size,t.table.total=l.total,t.table.data=l.dataSource})},deleteList(n){let l=[];n?l.push(n):l=z.value.getCheckboxRecords().map(u=>u.id),C.deleteList(l).then(u=>{u.code==1&&(L.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),s.findList())})},openForm(n){O.value.openForm({visible:!0,key:n})},synchronization(){C.synchronization(t.row.id).then(n=>{L.message("\u540C\u6B65\u6210\u529F!","\u6210\u529F"),s.findList()})},change(){C.change(t.table.data).then(n=>{L.message("\u6570\u636E\u53D8\u66F4\u6210\u529F!","\u6210\u529F"),s.findList()})},loadData(n){t.row=n,t.table.search.vm.low_Code_TableId=t.row.id,s.findList()}};return k({...s}),q(()=>t.activeKey,n=>{n=="3"&&U(()=>{$.value.openForm({key:t.row.tableName})}),n=="4"&&U(()=>{P.value.loadData({key:t.row.id})})}),(n,l)=>{const u=i("a-input"),_=i("a-col"),p=i("a-button"),S=i("a-row"),D=i("a-card"),b=i("a-popconfirm"),F=i("a-space"),r=i("vxe-column"),g=i("a-tag"),R=i("vxe-table"),j=i("vxe-pager"),B=i("a-spin"),T=i("a-tab-pane"),J=i("a-tabs");return m(),f(J,{activeKey:t.activeKey,"onUpdate:activeKey":l[10]||(l[10]=o=>t.activeKey=o)},{default:a(()=>[e(T,{key:"1",tab:"\u5B57\u6BB5\u8BBE\u7F6E"},{default:a(()=>[V("div",null,[H(e(D,{class:"mb-15"},{default:a(()=>[e(S,{gutter:[15,15]},{default:a(()=>[e(_,{xs:24,sm:12,md:8,lg:6,xl:4},{default:a(()=>[e(u,{value:t.table.search.vm.columnName,"onUpdate:value":l[0]||(l[0]=o=>t.table.search.vm.columnName=o),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),e(_,{xs:24,sm:12,md:8,lg:6,xl:4},{default:a(()=>[e(u,{value:t.table.search.vm.describe,"onUpdate:value":l[1]||(l[1]=o=>t.table.search.vm.describe=o),placeholder:"\u663E\u793A\u540D\u79F0"},null,8,["value"])]),_:1}),e(_,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:a(()=>[e(p,{type:"primary",class:"mr-15",onClick:s.findList},{default:a(()=>[Z]),_:1},8,["onClick"]),e(p,{class:"mr-15",onClick:s.onResetSearch},{default:a(()=>[ee]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512),[[E,t.table.search.state]]),e(S,{gutter:[15,15]},{default:a(()=>[e(_,{xs:24,sm:24,md:12,lg:12,xl:12},{default:a(()=>[e(F,{size:15},{default:a(()=>[Q(K).search?(m(),f(p,{key:0,onClick:l[2]||(l[2]=o=>t.table.search.state=!t.table.search.state)},{icon:a(()=>[e(x,{name:t.table.search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:a(()=>[te]),_:1})):W("",!0),e(b,{title:"\u60A8\u786E\u5B9A\u8981\u66F4\u65B0\u8868\u5417?\u53EF\u80FD\u4F1A\u5BFC\u81F4\u6570\u636E\u4E22\u5931",onConfirm:l[3]||(l[3]=o=>s.synchronization()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[e(p,{type:"primary"},{icon:a(()=>[e(x,{name:"ReloadOutlined"})]),default:a(()=>[ae]),_:1})]),_:1}),e(b,{title:"\u60A8\u786E\u5B9A\u8981\u63D0\u4EA4\u66F4\u6539?",onConfirm:l[4]||(l[4]=o=>s.change()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[e(p,{type:"primary"},{icon:a(()=>[e(x,{name:"PlusOutlined"})]),default:a(()=>[le]),_:1})]),_:1}),e(b,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:l[5]||(l[5]=o=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[e(p,{type:"danger"},{icon:a(()=>[e(x,{name:"DeleteOutlined"})]),default:a(()=>[oe]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{xs:24,sm:24,md:12,lg:12,xl:12,class:"text-right"})]),_:1}),e(B,{spinning:t.table.loading},{default:a(()=>[e(R,{class:"mt-15",ref_key:"refTable",ref:z,size:"medium",border:"",stripe:"",data:t.table.data,"row-config":{isCurrent:!0,isHover:!0},"column-config":{isCurrent:!0,resizable:!0},"checkbox-config":{highlight:!0},"edit-config":{trigger:"click",mode:"cell"}},{default:a(()=>[e(r,{type:"seq",width:"50"}),e(r,{type:"checkbox",width:"50"}),e(r,{field:"columnName",title:"\u5217\u540D\u79F0"}),e(r,{field:"databaseColumnType",title:"\u6570\u636E\u5E93\u7C7B\u578B",width:"130px"}),e(r,{field:"csField",title:"C#\u5B57\u6BB5\u540D\u79F0"}),e(r,{field:"csType",title:"C#\u6570\u636E\u7C7B\u578B",width:"100px"}),e(r,{field:"isPrimary",title:"\u662F\u5426\u4E3B\u952E",width:"100px"},{default:a(({row:o})=>[o.isPrimary?(m(),f(g,{key:0,color:"success"},{default:a(()=>[ne]),_:1})):(m(),f(g,{key:1,color:"default"},{default:a(()=>[se]),_:1}))]),_:1}),e(r,{field:"isIdentity",title:"\u662F\u5426\u81EA\u589E",width:"100px"},{default:a(({row:o})=>[o.isIdentity?(m(),f(g,{key:0,color:"success"},{default:a(()=>[ie]),_:1})):(m(),f(g,{key:1,color:"default"},{default:a(()=>[re]),_:1}))]),_:1}),e(r,{field:"displayName",title:"\u663E\u793A\u540D\u79F0","edit-render":{},width:"150px"},{default:a(({row:o})=>[d(I(o.displayName),1)]),edit:a(({row:o})=>[e(u,{value:o.displayName,"onUpdate:value":v=>o.displayName=v,placeholder:"\u663E\u793A\u540D\u79F0"},null,8,["value","onUpdate:value"])]),_:1}),e(r,{field:"describe",title:"\u5217\u63CF\u8FF0","edit-render":{},width:"150px"},{default:a(({row:o})=>[d(I(o.describe),1)]),edit:a(({row:o})=>[e(u,{value:o.describe,"onUpdate:value":v=>o.describe=v,placeholder:"\u5217\u63CF\u8FF0"},null,8,["value","onUpdate:value"])]),_:1}),e(r,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4",width:"120px"}),e(r,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4",width:"120px"}),e(r,{field:"id",title:"\u64CD\u4F5C",width:"80px"},{default:a(({row:o})=>[e(b,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:v=>s.deleteList(o.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[de]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(j,{background:"","current-page":t.table.page,"onUpdate:current-page":l[6]||(l[6]=o=>t.table.page=o),"page-size":t.table.rows,"onUpdate:page-size":l[7]||(l[7]=o=>t.table.rows=o),total:t.table.total,"page-sizes":t.table.pageSizeOptions,layouts:["PrevJump","PrevPage","JumpNumber","NextPage","NextJump","Sizes","FullJump","Total"],onPageChange:s.onChange},null,8,["current-page","page-size","total","page-sizes","onPageChange"])]),_:1},8,["spinning"])])]),_:1}),e(T,{key:"3",tab:"\u4EE3\u7801\u9884\u89C8"},{default:a(()=>[e(X,{ref_key:"refCodeGenerationVue",ref:$,tableName:t.row.tableName,"onUpdate:tableName":l[8]||(l[8]=o=>t.row.tableName=o)},null,8,["tableName"])]),_:1}),e(T,{key:"4",tab:"\u4EE3\u7801\u8F7D\u5165\u9879\u76EE"},{default:a(()=>[e(Y,{ref_key:"refCodeLoadToProjectVue",ref:P,tableName:t.row.tableName,"onUpdate:tableName":l[9]||(l[9]=o=>t.row.tableName=o)},null,8,["tableName"])]),_:1})]),_:1},8,["activeKey"])}}});export{be as default};
