var J=Object.defineProperty;var P=(c,e,s)=>e in c?J(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s;var D=(c,e,s)=>(P(c,typeof e!="symbol"?e+"":e,s),s);import G from"./CrudList-2c7928d1.js";import{t as z,E as B}from"./tools-c6fa4d76.js";import{_ as Q}from"./Info.vue_vue_type_script_setup_true_lang-d1d501e0.js";import{J as f,y as N,I as W,d as X,p as Y,z as I,s as Z,q as ee,r as u,U as O,o as p,c as V,b as o,w as n,S as g,a as _,f as L,F as te,i as ne,k as i,$ as F,_ as oe}from"./index-5bb0c9d3.js";import"./_plugin-vue_export-helper-c4cb8a60.js";class le{constructor(){D(this,"controllerName","admin/SysOrganization")}findList(e={}){return f.post(`${this.controllerName}/findList/`,e,!1)}deleteList(e){if(console.log(e),e&&e.length===0){N.message("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E!",W.\u8B66\u544A);return}return f.post(`${this.controllerName}/deleteList`,e,!1)}findForm(e,s){return f.get(`${this.controllerName}/findForm/${e||N.guidEmpty}/${s||""}`)}saveForm(e){return e.id?f.post(`${this.controllerName}/update`,e.form):f.post(`${this.controllerName}/create`,e.form)}exportExcel(e){return f.download(`${this.controllerName}/exportExcel`,e)}sysOrganizationTree(){return f.post(`${this.controllerName}/sysOrganizationTree`)}}const ae=new le,re={class:"p-20"},ue={style:{display:"flex","justify-content":"space-between","align-items":"center"}},se=L("span",null,"\u7EC4\u7EC7\u67B6\u6784",-1),ie=i("\u67E5\u770B\u6240\u6709\u7528\u6237"),de=i("\u68C0\u7D22"),me=i("\u91CD\u7F6E"),pe=i("\u5173\u95ED"),ce=i(" \u9AD8\u7EA7\u68C0\u7D22 "),fe=i(" \u65B0\u5EFA "),_e=i(" \u6279\u91CF\u5220\u9664 "),ge=i(" \u66F4\u591A\u64CD\u4F5C "),ve=i("\u5BFC\u51FA Excel"),he=i("\u7F16\u8F91"),ye=i("\u5220\u9664"),Ce={name:"system_user"},be=X({...Ce,setup(c){const e=Y({loading:!1,rows:15,page:1,total:0,columns:[],data:[],search:{state:!1,vm:{organizationId:null,name:null,loginName:null}},tree:{loading:!1,data:[],expandedKeys:[],selectedKeys:[]}}),s=I(),C=I();Z(()=>{T()});function d(){e.loading=!0,F.findList(e.rows,e.page,e.search.vm).then(a=>{let t=a.data;e.loading=!1,e.page=t.page,e.rows=t.size,e.total=t.total,e.columns=t.columns,e.data=t.dataSource})}function A(){e.page=1;let a=e.search.vm;for(let t in a)a[t]=null;d()}function S(){F.exportExcel(e.search.vm)}function $(a){var r,v,h;let t=[];a?t.push(a):(console.log(C.value),t=(v=(r=C.value)==null?void 0:r.table)==null?void 0:v.getSelectionRows().map(m=>m.id)),(h=F.deleteList(t))==null||h.then(m=>{m.code==1&&(z.message("\u5220\u9664\u6210\u529F!",B.\u6210\u529F),d())})}function E(a){if(!a&&!e.search.vm.organizationId)return z.message("\u8BF7\u9009\u62E9\u7EC4\u7EC7!",B.\u8B66\u544A);oe(()=>{var t;(t=s.value)==null||t.init({id:a,organizationId:e.search.vm.organizationId,allOrganizationTree:e.tree.data})})}function T(){e.tree.loading=!0,ae.sysOrganizationTree().then(a=>{e.tree.loading=!1;let t=a.data;e.tree.data=t.rows,e.tree.expandedKeys=t.expandedRowKeys,d()})}return ee(()=>e.search.vm.organizationId,a=>{d()}),(a,t)=>{const r=u("el-button"),v=u("el-tree"),h=u("el-card"),m=u("el-col"),w=u("el-input"),x=u("el-form-item"),k=u("el-popconfirm"),R=u("el-dropdown-item"),K=u("el-dropdown-menu"),U=u("el-dropdown"),M=u("el-space"),b=u("el-table-column"),j=u("el-row"),q=O("loading"),y=O("power");return p(),V("div",re,[o(j,{gutter:20},{default:n(()=>[g((p(),_(m,{xs:24,sm:12,md:6,lg:5,xl:5},{default:n(()=>[o(h,{style:{height:"calc(100vh - 142px)"}},{header:n(()=>[L("div",ue,[se,o(r,{class:"button",text:"",bg:"",onClick:t[0]||(t[0]=l=>e.search.vm.organizationId=null)},{default:n(()=>[ie]),_:1})])]),default:n(()=>[o(v,{data:e.tree.data,"default-expand-all":"",props:{children:"children",label:"title"},"highlight-current":"","expand-on-click-node":!1,onNodeClick:t[1]||(t[1]=l=>e.search.vm.organizationId=l.key)},null,8,["data"])]),_:1})]),_:1})),[[q,e.tree.loading]]),o(m,{xs:24,sm:12,md:18,lg:19,xl:19},{default:n(()=>[o(G,{ref_key:"refCrudList",ref:C,tableData:e,onOnCurrentChange:t[13]||(t[13]=()=>d()),onOnSizeChange:t[14]||(t[14]=()=>d())},{search:n(()=>[o(m,{xs:24,sm:12,md:8,lg:6,xl:6},{default:n(()=>[o(x,{"label-width":"80px",label:"\u771F\u5B9E\u540D\u79F0"},{default:n(()=>[o(w,{modelValue:e.search.vm.name,"onUpdate:modelValue":t[2]||(t[2]=l=>e.search.vm.name=l),placeholder:"\u771F\u5B9E\u540D\u79F0",style:{width:"250px"}},null,8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:8,lg:6,xl:6},{default:n(()=>[o(x,{"label-width":"80px",label:"\u8D26\u6237\u540D\u79F0"},{default:n(()=>[o(w,{modelValue:e.search.vm.loginName,"onUpdate:modelValue":t[3]||(t[3]=l=>e.search.vm.loginName=l),placeholder:"\u8D26\u6237\u540D\u79F0",style:{width:"250px"}},null,8,["modelValue"])]),_:1})]),_:1}),o(m,{xs:24,sm:12,md:8,lg:6,xl:6},{default:n(()=>[o(x,null,{default:n(()=>[o(r,{plain:"",type:"primary",onClick:t[4]||(t[4]=l=>d())},{default:n(()=>[de]),_:1}),o(r,{plain:"",onClick:t[5]||(t[5]=l=>A())},{default:n(()=>[me]),_:1}),o(r,{plain:"",type:"danger",onClick:t[6]||(t[6]=l=>e.search.state=!1)},{default:n(()=>[pe]),_:1})]),_:1})]),_:1})]),toolbar:n(()=>[o(M,{wrap:"",size:[20,20]},{default:n(()=>[o(w,{modelValue:e.search.vm.name,"onUpdate:modelValue":t[8]||(t[8]=l=>e.search.vm.name=l),placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D"},{append:n(()=>[o(r,{icon:"Search",type:"primary",onClick:t[7]||(t[7]=l=>d())})]),_:1},8,["modelValue"]),o(r,{plain:"",icon:"Filter",onClick:t[9]||(t[9]=l=>e.search.state=!e.search.state)},{default:n(()=>[ce]),_:1}),g((p(),_(r,{plain:"",icon:"PlusOutlined",type:"primary",onClick:t[10]||(t[10]=l=>E(null))},{default:n(()=>[fe]),_:1})),[[y,a.$router.currentRoute.value.meta.menuId+":insert"]]),g((p(),_(k,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:t[11]||(t[11]=l=>$(null))},{reference:n(()=>[o(r,{plain:"",type:"danger",icon:"DeleteOutlined"},{default:n(()=>[_e]),_:1})]),_:1})),[[y,a.$router.currentRoute.value.meta.menuId+":delete"]]),o(U,null,{dropdown:n(()=>[o(K,null,{default:n(()=>[o(R,{onClick:t[12]||(t[12]=l=>S())},{default:n(()=>[ve]),_:1})]),_:1})]),default:n(()=>[o(r,{plain:"",icon:"DownOutlined"},{default:n(()=>[ge]),_:1})]),_:1})]),_:1})]),"table-col":n(()=>[(p(!0),V(te,null,ne(e.columns.filter(l=>l.fieldName!="id"&&l.show),l=>(p(),_(b,{key:l.id,prop:l.fieldName,label:l.title},null,8,["prop","label"]))),128)),o(b,{prop:"action",label:"\u64CD\u4F5C"},{default:n(l=>[g((p(),_(r,{link:"",type:"primary",onClick:H=>E(l.row.id)},{default:n(()=>[he]),_:2},1032,["onClick"])),[[y,a.$router.currentRoute.value.meta.menuId+":update"]]),g((p(),_(k,{title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:H=>$(l.row.id)},{reference:n(()=>[o(r,{link:"",type:"danger"},{default:n(()=>[ye]),_:1})]),_:2},1032,["onConfirm"])),[[y,a.$router.currentRoute.value.meta.menuId+":delete"]])]),_:1})]),_:1},8,["tableData"])]),_:1})]),_:1}),o(Q,{ref_key:"refInfo",ref:s,onOnSuccess:t[15]||(t[15]=()=>d())},null,512)])}}});export{be as default};
