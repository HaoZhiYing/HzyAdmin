import{d as F,r as j,L as K,b as C,e as R,f as s,o as r,l as d,w as t,a,u as m,i,x as g,c as k,B as q,t as G,F as H,g as J,T as B}from"./index-ceef6588.js";import{_ as y}from"./AppIcon.vue_vue_type_script_setup_true_lang-081834dc.js";import{S as w,_ as Q}from"./Info.vue_vue_type_script_setup_true_lang-650fe9fc.js";import{_ as W}from"./PageContainer.vue_vue_type_script_setup_true_lang-f7d2786e.js";import{_ as X}from"./TableCurd.vue_vue_type_script_setup_true_lang-3a6845a0.js";const Y={key:0},Z={key:1},ee=["onClick"],te=J("a",{class:"text-danger"},"删除",-1),ae=F({name:"system_post"}),ce=F({...ae,setup(oe){const e=j({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),u=K(),S=C(),h=C(),b=C();R(()=>{_()});async function _(){try{e.loading=!0;const l=await w.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,l.code!=1)return;e.page=l.data.page,e.size=l.data.size,e.total=l.data.total,e.columns=l.data.columns,e.data=l.data.dataSource}catch{e.loading=!1}}async function z(l){var v;let n=[];if(l?n.push(l):n=((v=S.value)==null?void 0:v.getSelectedRowKeys())??[],n.length==0)return B.message.error("请选择要删除的行!");try{e.loading=!0;const x=await w.deleteList(n);if(e.loading=!1,x.code!=1)return;B.message.success("删除成功!"),_()}catch{e.loading=!1}}function N(){w.exportExcel(e.search.vm,e.search.sort)}return(l,n)=>{const v=s("a-input"),x=s("a-form-item"),$=s("a-col"),f=s("a-button"),E=s("a-space"),O=s("a-row"),U=s("a-form"),T=s("a-popconfirm"),V=s("a-menu-item"),D=s("a-menu"),A=s("a-dropdown"),I=s("a-checkbox"),M=s("a-popover"),p=s("a-table-column"),L=s("a-tag"),P=s("a-divider");return r(),d(W,null,{default:t(()=>[a(X,{ref_key:"refTableCurd",ref:S,config:e,onChange:n[7]||(n[7]=o=>{e.page=o.pagination.current??1,e.size=o.pagination.pageSize??e.size,e.search.sort=o.sorter instanceof Array?[...o.sorter]:[o.sorter],_()}),onShowSizeChange:n[8]||(n[8]=({current:o,size:c})=>{e.page=o==0?1:o,e.size=c,_()})},{search:t(()=>[m(u).search?(r(),d(U,{key:0,ref_key:"refSearchForm",ref:b,model:e.search.vm},{default:t(()=>[a(O,{gutter:[16,0]},{default:t(()=>[a($,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[a(x,{class:"mb-0",name:"name",label:"名称"},{default:t(()=>[a(v,{value:e.search.vm.name,"onUpdate:value":n[0]||(n[0]=o=>e.search.vm.name=o),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),a($,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[a(E,{size:8},{default:t(()=>[a(f,{onClick:n[1]||(n[1]=o=>{var c;e.page=1,(c=b.value)==null||c.resetFields(),_()})},{default:t(()=>[i(" 重置 ")]),_:1}),a(f,{type:"primary",onClick:n[2]||(n[2]=o=>{e.page=1,_()})},{default:t(()=>[i(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):g("",!0)]),"toolbar-left":t(()=>[m(u).search?(r(),d(f,{key:0,onClick:n[3]||(n[3]=o=>e.search.state=!e.search.state)},{default:t(()=>[e.search.state?(r(),k("div",Y,[a(y,{name:"UpOutlined"}),i("  收起")])):(r(),k("div",Z,[a(y,{name:"DownOutlined"}),i("  展开")]))]),_:1})):g("",!0),m(u).insert?(r(),d(f,{key:1,type:"primary",onClick:n[4]||(n[4]=()=>{var o;return(o=h.value)==null?void 0:o.open()})},{icon:t(()=>[a(y,{name:"PlusOutlined"})]),default:t(()=>[i(" 新建 ")]),_:1})):g("",!0),m(u).delete?(r(),d(T,{key:2,title:"您确定要删除?",onConfirm:n[5]||(n[5]=o=>z()),okText:"确定",cancelText:"取消"},{default:t(()=>[a(f,{type:"primary",danger:""},{icon:t(()=>[a(y,{name:"DeleteOutlined"})]),default:t(()=>[i(" 批量删除 ")]),_:1})]),_:1})):g("",!0)]),"toolbar-right":t(()=>[a(A,null,{overlay:t(()=>[a(D,null,{default:t(()=>[a(V,{key:"1",onClick:n[6]||(n[6]=o=>N())},{default:t(()=>[i("导出 Excel")]),_:1})]),_:1})]),default:t(()=>[a(f,null,{default:t(()=>[i(" 更多 "),a(y,{name:"ellipsis-outlined"})]),_:1})]),_:1}),a(M,null,{content:t(()=>[(r(!0),k(H,null,q(e.columns.filter(o=>o.fieldName.substr(0,1)!="_"),o=>(r(),k("div",null,[a(I,{checked:o.show,"onUpdate:checked":c=>o.show=c},{default:t(()=>[i(G(o.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[a(f,{type:"text"},{icon:t(()=>[a(y,{name:"setting-outlined"})]),_:1})]),_:1})]),"table-col":t(()=>[a(p,{title:"编号","data-index":"number"}),a(p,{title:"岗位编码","data-index":"code"}),a(p,{title:"名称","data-index":"name"}),a(p,{title:"状态","data-index":"state"},{default:t(({record:o})=>[o.state==1?(r(),d(L,{key:0,color:"success"},{default:t(()=>[i("正常")]),_:1})):(r(),d(L,{key:1,color:"warning"},{default:t(()=>[i("停用")]),_:1}))]),_:1}),a(p,{title:"更新时间","data-index":"lastModificationTime"}),a(p,{title:"创建时间","data-index":"creationTime"}),m(u).update||m(u).delete?(r(),d(p,{key:0,title:"操作","data-index":"id"},{default:t(({record:o})=>[m(u).update?(r(),k("a",{key:0,href:"javascript:;",onClick:()=>{var c;return(c=h.value)==null?void 0:c.open(o.id)}},"编辑",8,ee)):g("",!0),a(P,{type:"vertical"}),m(u).delete?(r(),d(T,{key:1,title:"您确定要删除?",onConfirm:c=>z(o.id),okText:"确定",cancelText:"取消"},{default:t(()=>[te]),_:2},1032,["onConfirm"])):g("",!0)]),_:1})):g("",!0)]),_:1},8,["config"]),a(Q,{ref_key:"refInfo",ref:h,onSuccess:()=>_()},null,8,["onSuccess"])]),_:1})}}});export{ce as default};
