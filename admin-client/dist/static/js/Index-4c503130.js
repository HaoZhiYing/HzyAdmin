import{d as F,r as R,R as j,b as C,e as G,f as s,o as r,l as f,w as t,a,u,i as c,z as p,c as y,D as K,t as P,G as q,g as H,T as N}from"./index-1d3290fc.js";import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-5c9d9d70.js";import{S as w,_ as J}from"./Info.vue_vue_type_script_setup_true_lang-21aea0cd.js";import{_ as Q}from"./PageContainer.vue_vue_type_script_setup_true_lang-4a22be12.js";import{_ as W}from"./TableCurd.vue_vue_type_script_setup_true_lang-a4411ecd.js";const X={key:0},Y={key:1},Z=["onClick"],ee=H("a",{class:"text-danger"},"删除",-1),te=F({name:"system_function"}),ie=F({...te,setup(ae){const e=R({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),d=j(),b=C(),h=C(),S=C();G(()=>{m()});async function m(){try{e.loading=!0;const l=await w.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,l.code!=1)return;e.page=l.data.page,e.size=l.data.size,e.total=l.data.total,e.columns=l.data.columns,e.data=l.data.dataSource}catch{e.loading=!1}}async function z(l){var k;let n=[];if(l?n.push(l):n=((k=b.value)==null?void 0:k.getSelectedRowKeys())??[],n.length==0)return N.message.error("请选择要删除的行!");try{e.loading=!0;const x=await w.deleteList(n);if(e.loading=!1,x.code!=1)return;N.message.success("删除成功!"),m()}catch{e.loading=!1}}function L(){w.exportExcel(e.search.vm,e.search.sort)}return(l,n)=>{const k=s("a-input"),x=s("a-form-item"),$=s("a-col"),_=s("a-button"),B=s("a-space"),D=s("a-row"),E=s("a-form"),T=s("a-popconfirm"),O=s("a-menu-item"),U=s("a-menu"),V=s("a-dropdown"),A=s("a-checkbox"),I=s("a-popover"),g=s("a-table-column"),M=s("a-divider");return r(),f(Q,null,{default:t(()=>[a(W,{ref_key:"refTableCurd",ref:b,config:e,onChange:n[7]||(n[7]=o=>{e.page=o.pagination.current??1,e.size=o.pagination.pageSize??e.size,e.search.sort=o.sorter instanceof Array?[...o.sorter]:[o.sorter],m()}),onShowSizeChange:n[8]||(n[8]=({current:o,size:i})=>{e.page=o==0?1:o,e.size=i,m()})},{search:t(()=>[u(d).search?(r(),f(E,{key:0,ref_key:"refSearchForm",ref:S,model:e.search.vm},{default:t(()=>[a(D,{gutter:[16,0]},{default:t(()=>[a($,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[a(x,{class:"mb-0",name:"name",label:"名称"},{default:t(()=>[a(k,{value:e.search.vm.name,"onUpdate:value":n[0]||(n[0]=o=>e.search.vm.name=o),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),a($,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[a(B,{size:8},{default:t(()=>[a(_,{onClick:n[1]||(n[1]=o=>{var i;e.page=1,(i=S.value)==null||i.resetFields(),m()})},{default:t(()=>[c(" 重置 ")]),_:1}),a(_,{type:"primary",onClick:n[2]||(n[2]=o=>{e.page=1,m()})},{default:t(()=>[c(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):p("",!0)]),"toolbar-left":t(()=>[u(d).search?(r(),f(_,{key:0,onClick:n[3]||(n[3]=o=>e.search.state=!e.search.state)},{default:t(()=>[e.search.state?(r(),y("div",X,[a(v,{name:"UpOutlined"}),c("  收起")])):(r(),y("div",Y,[a(v,{name:"DownOutlined"}),c("  展开")]))]),_:1})):p("",!0),u(d).insert?(r(),f(_,{key:1,type:"primary",onClick:n[4]||(n[4]=()=>{var o;return(o=h.value)==null?void 0:o.open()})},{icon:t(()=>[a(v,{name:"PlusOutlined"})]),default:t(()=>[c(" 新建 ")]),_:1})):p("",!0),u(d).delete?(r(),f(T,{key:2,title:"您确定要删除?",onConfirm:n[5]||(n[5]=o=>z()),okText:"确定",cancelText:"取消"},{default:t(()=>[a(_,{type:"primary",danger:""},{icon:t(()=>[a(v,{name:"DeleteOutlined"})]),default:t(()=>[c(" 批量删除 ")]),_:1})]),_:1})):p("",!0)]),"toolbar-right":t(()=>[a(V,null,{overlay:t(()=>[a(U,null,{default:t(()=>[a(O,{key:"1",onClick:n[6]||(n[6]=o=>L())},{default:t(()=>[c("导出 Excel")]),_:1})]),_:1})]),default:t(()=>[a(_,null,{default:t(()=>[c(" 更多 "),a(v,{name:"ellipsis-outlined"})]),_:1})]),_:1}),a(I,null,{content:t(()=>[(r(!0),y(q,null,K(e.columns.filter(o=>o.fieldName.substr(0,1)!="_"),o=>(r(),y("div",null,[a(A,{checked:o.show,"onUpdate:checked":i=>o.show=i},{default:t(()=>[c(P(o.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[a(_,{type:"text"},{icon:t(()=>[a(v,{name:"setting-outlined"})]),_:1})]),_:1})]),"table-col":t(()=>[a(g,{title:"编号","data-index":"number"}),a(g,{title:"名称","data-index":"name"}),a(g,{title:"英文名称","data-index":"byName"}),a(g,{title:"更新时间","data-index":"lastModificationTime"}),a(g,{title:"创建时间","data-index":"creationTime"}),u(d).update||u(d).delete?(r(),f(g,{key:0,title:"操作","data-index":"id"},{default:t(({record:o})=>[u(d).update?(r(),y("a",{key:0,href:"javascript:;",onClick:()=>{var i;return(i=h.value)==null?void 0:i.open(o.id)}},"编辑",8,Z)):p("",!0),a(M,{type:"vertical"}),u(d).delete?(r(),f(T,{key:1,title:"您确定要删除?",onConfirm:i=>z(o.id),okText:"确定",cancelText:"取消"},{default:t(()=>[ee]),_:2},1032,["onConfirm"])):p("",!0)]),_:1})):p("",!0)]),_:1},8,["config"]),a(J,{ref_key:"refInfo",ref:h,onSuccess:()=>m()},null,8,["onSuccess"])]),_:1})}}});export{ie as default};
