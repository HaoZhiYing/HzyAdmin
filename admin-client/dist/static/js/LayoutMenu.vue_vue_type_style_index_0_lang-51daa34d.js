import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-7672b527.js";import{d as D,v as E,A as I,n as L,T as U,r as A,m as d,q as N,f as k,o as t,l as r,w as h,u as m,c as i,G as K,M as f,B as M,g,t as S}from"./index-5ce8de01.js";import{_ as $}from"./LayoutMenuSub.vue_vue_type_script_setup_true_lang-ed0a02a9.js";import{M as O,E as V}from"./MenuStore-d0fd35df.js";const G=D({__name:"LayoutMenu",setup(b){const w=E(),C=O(),y=I(),T=L(()=>U.genTreeData(y.state.userInfo.menus,null)),a=A({defaultSelectedKeys:[d.currentRoute.value.meta.menuId??""],selectedKeys:[d.currentRoute.value.meta.menuId??""],openKeys:B()});N(()=>d.currentRoute.value,o=>{a.selectedKeys=[o.meta.menuId??""]});function B(){let n=d.currentRoute.value.meta.levelCode;if(!n)return[];var u=[];if(n.indexOf(".")>-1)for(var c=n.split("."),s=0;s<c.length-1;s++){var p=c[s];u.push(parseInt(p))}return u}function R(o){const n=y.state.userInfo.menus.find(u=>u.id==o.key);d.push({path:(n==null?void 0:n.jumpUrl)??(n==null?void 0:n.router)??"/404"})}return(o,n)=>{const u=k("a-menu-item"),c=k("a-menu");return t(),r(c,{mode:"inline",theme:m(w).state.menuTheme.isDark?"dark":"light",onSelect:R,selectedKeys:a.selectedKeys,"onUpdate:selectedKeys":n[0]||(n[0]=s=>a.selectedKeys=s),openKeys:a.openKeys,"onUpdate:openKeys":n[1]||(n[1]=s=>a.openKeys=s)},{default:h(()=>{var s,p;return[m(C).state.menuMode!=m(V).default?(t(!0),i(f,{key:0},K((s=m(y).state.subMenus)==null?void 0:s.filter(e=>e.show),e=>{var l;return t(),i(f,null,[!e.children||((l=e.children)==null?void 0:l.filter(_=>_.show).length)==0&&e.type==2?(t(),r(u,{key:e.id,title:o.$t(`menu.${e.id}`)},{default:h(()=>[e.icon?(t(),r(v,{key:0,name:e.icon},null,8,["name"])):M("",!0),g("span",null,S(o.$t(`menu.${e.id}`)),1)]),_:2},1032,["title"])):(t(),r($,{key:1,"menu-info":e},null,8,["menu-info"]))],64)}),256)):(t(!0),i(f,{key:1},K((p=T.value)==null?void 0:p.filter(e=>e.show),e=>{var l;return t(),i(f,null,[!e.children||((l=e.children)==null?void 0:l.filter(_=>_.show).length)==0&&e.type==2?(t(),r(u,{key:e.id,title:o.$t(`menu.${e.id}`)},{default:h(()=>[e.icon?(t(),r(v,{key:0,name:e.icon},null,8,["name"])):M("",!0),g("span",null,S(o.$t(`menu.${e.id}`)),1)]),_:2},1032,["title"])):(t(),r($,{key:1,"menu-info":e},null,8,["menu-info"]))],64)}),256))]}),_:1},8,["theme","selectedKeys","openKeys"])}}});export{G as _};
