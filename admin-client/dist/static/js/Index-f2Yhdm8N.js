import{d as j,r as A,bZ as M,b as h,e as E,f as l,o as s,l as m,w as o,a,u as k,j as i,B as v,c as C,t as x,M as K,g as B,T as $}from"./index-cV5RpzD5.js";import{_ as w}from"./AppIcon.vue_vue_type_script_setup_true_lang-Fnoq4ehk.js";import{S as D,_ as P}from"./Info.vue_vue_type_script_setup_true_lang-Qh06cHN2.js";import{_ as R}from"./PageContainer.vue_vue_type_script_setup_true_lang-lZgQDTDD.js";import{_ as Z}from"./TableCurd.vue_vue_type_script_setup_true_lang-as1p4H5Y.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-JcEmfVZ2.js";const q={key:0},G={key:1},H=["onClick"],J=B("a",{class:"text-danger"},"删除",-1),oe=j({name:"system_function",__name:"Index",setup(Q){const t=A({search:{state:!1,vm:{api:void 0,browser:void 0,ip:void 0,os:void 0,rangeTime:[],startTime:void 0,endTime:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),g=M(),S=h(),T=h(),U=h();E(()=>{f()});async function f(){try{t.loading=!0;const r=await D.findList(t.page,t.size,t.search.vm,t.search.sort);if(t.loading=!1,r.code!=200)return;t.page=r.data.page,t.size=r.data.size,t.total=r.data.total,t.columns=r.data.columns,t.data=r.data.dataSource}catch{t.loading=!1}}async function z(r){var c;let n=[];if(r?n.push(r):n=((c=S.value)==null?void 0:c.getSelectedRowKeys())??[],n.length==0)return $.message.error("请选择要删除的行!");try{t.loading=!0;const u=await D.deleteList(n);if(t.loading=!1,u.code!=200)return;$.message.success("删除成功!"),f()}catch{t.loading=!1}}return(r,n)=>{const c=l("a-input"),u=l("a-form-item"),_=l("a-col"),L=l("a-range-picker"),y=l("a-button"),O=l("a-space"),F=l("a-row"),V=l("a-form"),N=l("a-popconfirm"),d=l("a-table-column"),b=l("a-tag"),I=l("a-divider");return s(),m(R,null,{default:o(()=>[a(Z,{ref_key:"refTableCurd",ref:S,config:t,"onUpdate:config":n[10]||(n[10]=e=>t=e),onChange:n[11]||(n[11]=e=>{t.page=e.pagination.current??1,t.size=e.pagination.pageSize??t.size,t.search.sort=e.sorter instanceof Array?[...e.sorter]:[e.sorter],f()}),onShowSizeChange:n[12]||(n[12]=({current:e,size:p})=>{t.page=e==0?1:e,t.size=p,f()}),"column-setting":!1},{search:o(()=>[k(g).search?(s(),m(V,{key:0,ref_key:"refSearchForm",ref:U,model:t.search.vm},{default:o(()=>[a(F,{gutter:[16,0]},{default:o(()=>[a(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(u,{name:"api",label:"接口地址"},{default:o(()=>[a(c,{value:t.search.vm.api,"onUpdate:value":n[0]||(n[0]=e=>t.search.vm.api=e),placeholder:"接口地址"},null,8,["value"])]),_:1})]),_:1}),a(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(u,{name:"browser",label:"浏览器"},{default:o(()=>[a(c,{value:t.search.vm.browser,"onUpdate:value":n[1]||(n[1]=e=>t.search.vm.browser=e),placeholder:"浏览器"},null,8,["value"])]),_:1})]),_:1}),a(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(u,{name:"ip",label:"ip地址"},{default:o(()=>[a(c,{value:t.search.vm.ip,"onUpdate:value":n[2]||(n[2]=e=>t.search.vm.ip=e),placeholder:"ip地址"},null,8,["value"])]),_:1})]),_:1}),a(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(u,{name:"os",label:"操作系统"},{default:o(()=>[a(c,{value:t.search.vm.os,"onUpdate:value":n[3]||(n[3]=e=>t.search.vm.os=e),placeholder:"操作系统"},null,8,["value"])]),_:1})]),_:1}),a(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[a(u,{name:"rangeTime",label:"日期区间"},{default:o(()=>[a(L,{value:t.search.vm.rangeTime,"onUpdate:value":n[4]||(n[4]=e=>t.search.vm.rangeTime=e),class:"w100"},null,8,["value"])]),_:1})]),_:1}),a(_,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:o(()=>[a(O,{size:8},{default:o(()=>[a(y,{onClick:n[5]||(n[5]=e=>{var p;t.page=1,(p=U.value)==null||p.resetFields(),f()})},{default:o(()=>[i(" 重置 ")]),_:1}),a(y,{type:"primary",onClick:n[6]||(n[6]=e=>{t.page=1,f()})},{default:o(()=>[i(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):v("",!0)]),"toolbar-left":o(()=>[k(g).search?(s(),m(y,{key:0,onClick:n[7]||(n[7]=e=>t.search.state=!t.search.state)},{default:o(()=>[t.search.state?(s(),C("div",q,[a(w,{name:"UpOutlined"}),i("  收起 ")])):(s(),C("div",G,[a(w,{name:"DownOutlined"}),i("  展开 ")]))]),_:1})):v("",!0),k(g).insert?(s(),m(y,{key:1,type:"primary",onClick:n[8]||(n[8]=()=>{var e;return(e=T.value)==null?void 0:e.open()})},{icon:o(()=>[a(w,{name:"PlusOutlined"})]),default:o(()=>[i(" 新建 ")]),_:1})):v("",!0),k(g).delete?(s(),m(N,{key:2,title:"您确定要删除?",onConfirm:n[9]||(n[9]=e=>z()),okText:"确定",cancelText:"取消"},{default:o(()=>[a(y,{type:"primary",danger:""},{icon:o(()=>[a(w,{name:"DeleteOutlined"})]),default:o(()=>[i(" 批量删除 ")]),_:1})]),_:1})):v("",!0)]),"toolbar-right":o(()=>[]),"table-col":o(()=>[a(d,{title:"接口地址","data-index":"api",width:250,ellipsis:!0}),a(d,{title:"操作系统","data-index":"os"}),a(d,{title:"浏览器","data-index":"browser"}),a(d,{title:"ip地址","data-index":"ip"}),a(d,{title:"接口描述",width:200},{default:o(({record:e})=>[i(x(e.controllerDisplayName)+" ",1),e.controllerDisplayName&&e.actionDisplayName?(s(),C(K,{key:0},[i(" -")],64)):v("",!0),i(" "+x(e.actionDisplayName),1)]),_:1}),a(d,{title:"接口耗时","data-index":"takeUpTime"},{default:o(({record:e})=>[e.takeUpTime>=1e3?(s(),m(b,{key:0,color:"orange"},{default:o(()=>[i(x(e.takeUpTime)+"(毫秒)",1)]),_:2},1024)):e.takeUpTime>=2e3?(s(),m(b,{key:1,color:"red"},{default:o(()=>[i(x(e.takeUpTime)+"(毫秒)",1)]),_:2},1024)):(s(),m(b,{key:2,color:"#87d068"},{default:o(()=>[i(x(e.takeUpTime)+"(毫秒)",1)]),_:2},1024))]),_:1}),a(d,{title:"操作人姓名","data-index":"userName"}),a(d,{title:"操作人账号","data-index":"loginName"}),a(d,{title:"创建时间","data-index":"creationTime",width:150}),a(d,{title:"操作","data-index":"id"},{default:o(({record:e})=>[B("a",{href:"javascript:;",onClick:()=>{var p;return(p=T.value)==null?void 0:p.open(e.id)}},"详情",8,H),a(I,{type:"vertical"}),k(g).delete?(s(),m(N,{key:0,title:"您确定要删除?",onConfirm:p=>z(e.id),okText:"确定",cancelText:"取消"},{default:o(()=>[J]),_:2},1032,["onConfirm"])):v("",!0)]),_:1})]),_:1},8,["config"]),a(P,{ref_key:"refInfo",ref:T,onSuccess:()=>f()},null,8,["onSuccess"])]),_:1})}}});export{oe as default};
