import{d as j,r as A,bZ as D,b as k,e as U,f as r,o as i,l as f,w as t,a as o,u as d,j as m,B as _,c as w,aa as K,S as R,g as Z,T as I}from"./index-5ce8de01.js";import{_ as y}from"./AppIcon.vue_vue_type_script_setup_true_lang-7672b527.js";import{S as C,_ as q}from"./Info.vue_vue_type_script_setup_true_lang-7083c1b1.js";import{_ as G}from"./PageContainer.vue_vue_type_script_setup_true_lang-ee111854.js";import{_ as H}from"./TableCurd.vue_vue_type_script_setup_true_lang-73963374.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-7211a558.js";import"./vue.runtime.esm-bundler-cadf8ebb.js";const J={key:0},Q={key:1},W=["onClick"],X=Z("a",{class:"text-danger"},"删除",-1),le=j({name:"system_function",__name:"Index",setup(Y){const e=A({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[{fieldName:"number",title:"编号",show:!0,width:"",sorter:!0,dataIndex:"number"},{fieldName:"name",title:"名称",show:!0,width:"",sorter:!0,dataIndex:"name"},{fieldName:"byName",title:"标识名称",show:!0,width:"",sorter:!0,dataIndex:"byName"},{fieldName:"lastModificationTime",title:"最后更新时间",show:!0,width:"",sorter:!0,dataIndex:"lastModificationTime"},{fieldName:"creationTime",title:"创建时间",show:!0,width:"",sorter:!0,dataIndex:"creationTime"},{fieldName:"id",title:"操作",show:!0,width:"",sorter:!1,dataIndex:"id"}],data:[]}),l=D(),S=k(),x=k(),b=k();U(()=>{u()});async function u(){try{e.loading=!0;const s=await C.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,s.code!=200)return;e.page=s.data.page,e.size=s.data.size,e.total=s.data.total,e.data=s.data.dataSource}catch{e.loading=!1}}async function N(s){var g;let a=[];if(s?a.push(s):a=((g=S.value)==null?void 0:g.getSelectedRowKeys())??[],a.length==0)return I.message.error("请选择要删除的行!");try{e.loading=!0;const v=await C.deleteList(a);if(e.loading=!1,v.code!=200)return;I.message.success("删除成功!"),u()}catch{e.loading=!1}}function T(){C.exportExcel(e.search.vm,e.search.sort)}return(s,a)=>{const g=r("a-input"),v=r("a-form-item"),z=r("a-col"),p=r("a-button"),B=r("a-space"),E=r("a-row"),F=r("a-form"),$=r("a-popconfirm"),L=r("a-menu-item"),O=r("a-menu"),V=r("a-dropdown"),M=r("a-divider"),P=r("a-table-column");return i(),f(G,null,{default:t(()=>[o(H,{ref_key:"refTableCurd",ref:S,config:e,onChange:a[7]||(a[7]=n=>{e.page=n.pagination.current??1,e.size=n.pagination.pageSize??e.size,e.search.sort=n.sorter instanceof Array?[...n.sorter]:[n.sorter],u()}),onShowSizeChange:a[8]||(a[8]=({current:n,size:c})=>{e.page=n==0?1:n,e.size=c,u()})},{search:t(()=>[d(l).search?(i(),f(F,{key:0,ref_key:"refSearchForm",ref:b,model:e.search.vm},{default:t(()=>[o(E,{gutter:[16,0]},{default:t(()=>[o(z,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[o(v,{class:"mb-0",name:"name",label:"名称"},{default:t(()=>[o(g,{value:e.search.vm.name,"onUpdate:value":a[0]||(a[0]=n=>e.search.vm.name=n),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),o(z,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[o(B,{size:8},{default:t(()=>[o(p,{onClick:a[1]||(a[1]=n=>{var c;e.page=1,(c=b.value)==null||c.resetFields(),u()})},{default:t(()=>[m(" 重置 ")]),_:1}),o(p,{type:"primary",onClick:a[2]||(a[2]=n=>{e.page=1,u()})},{default:t(()=>[m(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):_("",!0)]),"toolbar-left":t(()=>[d(l).search?(i(),f(p,{key:0,onClick:a[3]||(a[3]=n=>e.search.state=!e.search.state)},{default:t(()=>[e.search.state?(i(),w("div",J,[o(y,{name:"UpOutlined"}),m("  收起 ")])):(i(),w("div",Q,[o(y,{name:"DownOutlined"}),m("  展开 ")]))]),_:1})):_("",!0),d(l).insert?(i(),f(p,{key:1,type:"primary",onClick:a[4]||(a[4]=()=>{var n;return(n=x.value)==null?void 0:n.open()})},{icon:t(()=>[o(y,{name:"PlusOutlined"})]),default:t(()=>[m(" 新建 ")]),_:1})):_("",!0),d(l).delete?(i(),f($,{key:2,title:"您确定要删除?",onConfirm:a[5]||(a[5]=n=>N()),okText:"确定",cancelText:"取消"},{default:t(()=>[o(p,{type:"primary",danger:""},{icon:t(()=>[o(y,{name:"DeleteOutlined"})]),default:t(()=>[m(" 批量删除 ")]),_:1})]),_:1})):_("",!0)]),"toolbar-right":t(()=>[o(V,null,{overlay:t(()=>[o(O,null,{default:t(()=>[o(L,{key:"1",onClick:a[6]||(a[6]=n=>T())},{default:t(()=>[m("导出 Excel")]),_:1})]),_:1})]),default:t(()=>[o(p,null,{default:t(()=>[m(" 更多 "),o(y,{name:"ellipsis-outlined"})]),_:1})]),_:1})]),id:t(n=>[d(l).update||d(l).delete?(i(),f(P,K(R({key:0},n)),{default:t(({record:c})=>[d(l).update?(i(),w("a",{key:0,href:"javascript:;",onClick:()=>{var h;return(h=x.value)==null?void 0:h.open(c.id)}},"编辑",8,W)):_("",!0),o(M,{type:"vertical"}),d(l).delete?(i(),f($,{key:1,title:"您确定要删除?",onConfirm:h=>N(c.id),okText:"确定",cancelText:"取消"},{default:t(()=>[X]),_:2},1032,["onConfirm"])):_("",!0)]),_:2},1040)):_("",!0)]),_:1},8,["config"]),o(q,{ref_key:"refInfo",ref:x,onSuccess:()=>u()},null,8,["onSuccess"])]),_:1})}}});export{le as default};
