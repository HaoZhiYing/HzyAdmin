import{d as R,r as J,b_ as K,b as k,e as q,f as s,o as l,l as p,w as a,a as n,u as m,j as u,B as c,c as x,ab as P,ac as G,g as M,U as H,T as B,P as Q,m as W}from"./index-C9oHGpmd.js";import{_ as h}from"./AppIcon.vue_vue_type_script_setup_true_lang-o_ph5tPH.js";import{M as C,_ as X}from"./Info.vue_vue_type_script_setup_true_lang-d4u0MY-W.js";import{_ as Y}from"./PageContainer.vue_vue_type_script_setup_true_lang-w--qcJ6v.js";import{_ as Z}from"./TableCurd.vue_vue_type_script_setup_true_lang-nb7-a0jh.js";import"./WangEditor.vue_vue_type_script_setup_true_lang-dheXsGka.js";import"./FindBack-zFVZNz7c.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./Index.vue_vue_type_script_setup_true_lang-WjHWSJ-R.js";import"./Info.vue_vue_type_script_setup_true_lang-X1k4qI3h.js";import"./SysOrganizationService-BI7rxZf6.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-dsx0k3kj.js";const ee={key:0},te={key:1},ae=["src","alt"],oe=["onClick"],ne=["onClick"],re=M("a",{class:"text-danger"},"删除",-1),xe=R({name:"base_member",__name:"Index",setup(se){const e=J({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[{fieldName:"number",title:"编号",show:!0,width:"",sorter:!0,dataIndex:"number"},{fieldName:"photo",title:"头像",show:!0,width:"",sorter:!1,dataIndex:"photo"},{fieldName:"name",title:"会员名称",show:!0,width:"",sorter:!0,dataIndex:"name"},{fieldName:"phone",title:"联系电话",show:!0,width:"",sorter:!0,dataIndex:"phone"},{fieldName:"sex",title:"性别",show:!0,width:"",sorter:!0,dataIndex:"sex"},{fieldName:"birthday",title:"生日",show:!0,width:"",sorter:!0,dataIndex:"birthday"},{fieldName:"operatorName",title:"用户名称",show:!0,width:"",sorter:!0,dataIndex:"operatorName"},{fieldName:"lastModificationTime",title:"更新时间",show:!1,width:"",sorter:!0,dataIndex:"lastModificationTime"},{fieldName:"creationTime",title:"创建时间",show:!0,width:"",sorter:!0,dataIndex:"creationTime"},{fieldName:"id",title:"操作",show:!0,width:"",sorter:!1,dataIndex:"id"}],data:[]}),d=K(),b=k(),y=k(),N=k();q(()=>{f()});async function f(){try{e.loading=!0;const r=await C.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,r.code!=200)return;e.page=r.data.page,e.size=r.data.size,e.total=r.data.total,e.data=r.data.dataSource}catch{e.loading=!1}}async function I(r){var v;let t=[];if(r?t.push(r):t=((v=b.value)==null?void 0:v.getSelectedRowKeys())??[],t.length==0)return B.message.error("请选择要删除的行!");try{e.loading=!0;const g=await C.deleteList(t);if(e.loading=!1,g.code!=200)return;B.message.success("删除成功!"),f()}catch{e.loading=!1}}function O(){C.exportExcel(e.search.vm,e.search.sort)}function j(r){if(r){var t=JSON.parse(r);return Q.domainServerApi+(t.length>0?t[0].url:"")}}function E(r){W.push(`/base/member/details/${r.id}/${r.name}`)}return(r,t)=>{const v=s("a-input"),g=s("a-form-item"),$=s("a-col"),_=s("a-button"),L=s("a-space"),U=s("a-row"),V=s("a-form"),S=s("a-popconfirm"),A=s("a-menu-item"),D=s("a-menu"),F=s("a-dropdown"),z=s("a-table-column"),T=s("a-divider");return l(),p(Y,null,{default:a(()=>[n(Z,{ref_key:"refTableCurd",ref:b,config:e,"onUpdate:config":t[7]||(t[7]=o=>e=o),onChange:t[8]||(t[8]=o=>{e.page=o.pagination.current??1,e.size=o.pagination.pageSize??e.size,e.search.sort=o.sorter instanceof Array?[...o.sorter]:[o.sorter],f()}),onShowSizeChange:t[9]||(t[9]=({current:o,size:i})=>{e.page=o==0?1:o,e.size=i,f()})},{search:a(()=>[m(d).search?(l(),p(V,{key:0,ref_key:"refSearchForm",ref:N,model:e.search.vm},{default:a(()=>[n(U,{gutter:[16,0]},{default:a(()=>[n($,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[n(g,{class:"mb-0",name:"name",label:"名称"},{default:a(()=>[n(v,{value:e.search.vm.name,"onUpdate:value":t[0]||(t[0]=o=>e.search.vm.name=o),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),n($,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:a(()=>[n(L,{size:8},{default:a(()=>[n(_,{onClick:t[1]||(t[1]=o=>{var i;e.page=1,(i=N.value)==null||i.resetFields(),f()})},{default:a(()=>[u(" 重置 ")]),_:1}),n(_,{type:"primary",onClick:t[2]||(t[2]=o=>{e.page=1,f()})},{default:a(()=>[u(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):c("",!0)]),"toolbar-left":a(()=>[m(d).search?(l(),p(_,{key:0,onClick:t[3]||(t[3]=o=>e.search.state=!e.search.state)},{default:a(()=>[e.search.state?(l(),x("div",ee,[n(h,{name:"UpOutlined"}),u("  收起 ")])):(l(),x("div",te,[n(h,{name:"DownOutlined"}),u("  展开 ")]))]),_:1})):c("",!0),m(d).insert?(l(),p(_,{key:1,type:"primary",onClick:t[4]||(t[4]=()=>{var o;return(o=y.value)==null?void 0:o.open()})},{icon:a(()=>[n(h,{name:"PlusOutlined"})]),default:a(()=>[u(" 新建 ")]),_:1})):c("",!0),m(d).delete?(l(),p(S,{key:2,title:"您确定要删除?",onConfirm:t[5]||(t[5]=o=>I()),okText:"确定",cancelText:"取消"},{default:a(()=>[n(_,{type:"primary",danger:""},{icon:a(()=>[n(h,{name:"DeleteOutlined"})]),default:a(()=>[u(" 批量删除 ")]),_:1})]),_:1})):c("",!0)]),"toolbar-right":a(()=>[n(F,null,{overlay:a(()=>[n(D,null,{default:a(()=>[n(A,{key:"1",onClick:t[6]||(t[6]=o=>O())},{default:a(()=>[u("导出 Excel")]),_:1})]),_:1})]),default:a(()=>[n(_,null,{default:a(()=>[u(" 更多 "),n(h,{name:"ellipsis-outlined"})]),_:1})]),_:1})]),photo:a(o=>[n(z,P(G(o)),{default:a(({record:i})=>[M("img",{src:j(i.photo),width:"35",height:"35",alt:i.name},null,8,ae)]),_:2},1040)]),id:a(o=>[m(d).update||m(d).delete?(l(),p(z,P(H({key:0},o)),{default:a(({record:i})=>[m(d).update?(l(),x("a",{key:0,href:"javascript:void(0)",onClick:w=>E(i)},"详情",8,oe)):c("",!0),n(T,{type:"vertical"}),m(d).update?(l(),x("a",{key:1,href:"javascript:;",onClick:()=>{var w;return(w=y.value)==null?void 0:w.open(i.id)}},"编辑",8,ne)):c("",!0),n(T,{type:"vertical"}),m(d).delete?(l(),p(S,{key:2,title:"您确定要删除?",onConfirm:w=>I(i.id),okText:"确定",cancelText:"取消"},{default:a(()=>[re]),_:2},1032,["onConfirm"])):c("",!0)]),_:2},1040)):c("",!0)]),_:1},8,["config"]),n(X,{ref_key:"refInfo",ref:y,onSuccess:()=>f()},null,8,["onSuccess"])]),_:1})}}});export{xe as default};
