import{d as R,y as N,a4 as L,C as w,q as O,m as A,r as i,o as s,e as p,w as o,a as n,u as l,i as _,l as m,c as F,f as V}from"./index-1d0f4517.js";import{_ as E}from"./AppIcon.vue_vue_type_script_setup_true_lang-35292c61.js";import{S as K,_ as I}from"./Info.vue_vue_type_script_setup_true_lang-7560de6d.js";import{_ as U}from"./PageContainer.vue_vue_type_script_setup_true_lang-5b68ebe0.js";import{_ as j}from"./TableCurd.vue_vue_type_script_setup_true_lang-c8a44d07.js";const M={key:0},q={key:1},P=["onClick"],G=["onClick"],H=V("a",{class:"text-danger"},"\u5220\u9664",-1),J=R({name:"system_function"}),te=R({...J,setup(Q){const e=N({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),r=L(),B=w(),C=w(),D=w();O(()=>{f()});async function f(){try{e.loading=!0;const d=await K.findList(e.search.vm);if(e.loading=!1,d.code!=1)return;e.data=A.genTreeData(d.data,null),e.expandedRowKeys=d.data.map(t=>t.id)}catch{e.loading=!1}}async function h(d){var g,k;let t=[];if(d?t.push(d):t=(k=(g=B.value)==null?void 0:g.getSelectedRowKeys())!=null?k:[],t.length==0)return A.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{e.loading=!0;const y=await K.deleteList(t);if(e.loading=!1,y.code!=1)return;A.message.success("\u5220\u9664\u6210\u529F!"),f()}catch{e.loading=!1}}return(d,t)=>{const g=i("a-input"),k=i("a-form-item"),y=i("a-col"),v=i("a-button"),b=i("a-space"),z=i("a-row"),T=i("a-form"),S=i("a-popconfirm"),c=i("a-table-column"),$=i("a-divider");return s(),p(U,null,{default:o(()=>[n(j,{ref_key:"refTableCurd",ref:B,config:e,onChange:t[6]||(t[6]=a=>{var u,x;e.page=(u=a.pagination.current)!=null?u:1,e.size=(x=a.pagination.pageSize)!=null?x:e.size,e.search.sort=a.sorter instanceof Array?[...a.sorter]:[a.sorter],f()}),onShowSizeChange:t[7]||(t[7]=({current:a,size:u})=>{e.page=a==0?1:a,e.size=u,f()}),expandedRowKeys:e.expandedRowKeys,"onUpdate:expandedRowKeys":t[8]||(t[8]=a=>e.expandedRowKeys=a)},{search:o(()=>[l(r).search?(s(),p(T,{key:0,ref_key:"refSearchForm",ref:D,model:e.search.vm},{default:o(()=>[n(z,{gutter:[16,0]},{default:o(()=>[n(y,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[n(k,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:o(()=>[n(g,{value:e.search.vm.name,"onUpdate:value":t[0]||(t[0]=a=>e.search.vm.name=a),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),n(y,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:o(()=>[n(b,{size:8},{default:o(()=>[n(v,{onClick:t[1]||(t[1]=a=>{var u;e.page=1,(u=D.value)==null||u.resetFields(),f()})},{default:o(()=>[_(" \u91CD\u7F6E ")]),_:1}),n(v,{type:"primary",onClick:t[2]||(t[2]=a=>{e.page=1,f()})},{default:o(()=>[_(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):m("",!0)]),"toolbar-left":o(()=>[l(r).search?(s(),p(v,{key:0,onClick:t[3]||(t[3]=a=>e.search.state=!e.search.state)},{default:o(()=>[e.search.state?(s(),F("div",M,[n(E,{name:"UpOutlined"}),_("\xA0\xA0\u6536\u8D77")])):(s(),F("div",q,[n(E,{name:"DownOutlined"}),_("\xA0\xA0\u5C55\u5F00")]))]),_:1})):m("",!0),l(r).insert?(s(),p(v,{key:1,type:"primary",onClick:t[4]||(t[4]=()=>{var a;return(a=C.value)==null?void 0:a.open()})},{icon:o(()=>[n(E,{name:"PlusOutlined"})]),default:o(()=>[_(" \u65B0\u5EFA ")]),_:1})):m("",!0),l(r).delete?(s(),p(S,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:t[5]||(t[5]=a=>h()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[n(v,{type:"primary",danger:""},{icon:o(()=>[n(E,{name:"DeleteOutlined"})]),default:o(()=>[_(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):m("",!0)]),"toolbar-right":o(()=>[]),"table-col":o(()=>[n(c,{title:"\u5206\u7EC4\u540D\u79F0/\u952E","data-index":"name"}),n(c,{title:"\u503C","data-index":"value"}),n(c,{title:"\u6240\u5C5E\u5206\u7EC4","data-index":"parentName"}),n(c,{title:"\u5E8F\u53F7","data-index":"sort"}),n(c,{title:"\u552F\u4E00\u7F16\u7801","data-index":"code"}),n(c,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),n(c,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),l(r).update||l(r).delete||l(r).insert?(s(),p(c,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:o(({record:a})=>[l(r).insert?(s(),F("a",{key:0,href:"javascript:void(0)",onClick:u=>{var x;return(x=C.value)==null?void 0:x.open(null,a.id)}},"\u65B0\u5EFA",8,P)):m("",!0),n($,{type:"vertical"}),l(r).update?(s(),F("a",{key:1,href:"javascript:;",onClick:()=>{var u;return(u=C.value)==null?void 0:u.open(a.id,a.parentId)}},"\u7F16\u8F91",8,G)):m("",!0),n($,{type:"vertical"}),l(r).delete?(s(),p(S,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:u=>h(a.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[H]),_:2},1032,["onConfirm"])):m("",!0)]),_:1})):m("",!0)]),_:1},8,["config","expandedRowKeys"]),n(I,{ref_key:"refInfo",ref:C,onSuccess:()=>f()},null,8,["onSuccess"])]),_:1})}}});export{te as default};
