import{d as H,r as J,b as K,f as r,o as v,l as p,w as l,a as t,j as a,t as V,B as g,g as b,T as F}from"./index-C9oHGpmd.js";import{S as $}from"./SysMenuService-bO_TQrmD.js";import W from"./AppIconList-sWATNq9S.js";import{_ as x}from"./AppIcon.vue_vue_type_script_setup_true_lang-o_ph5tPH.js";const X=b("a",{href:"https://next.antdv.com/components/icon-cn",target:"black"}," AntdV 3.0 官方icon ",-1),Y=b("p",null,"http://ip:port/#/页面地址/{menuid}/{token}",-1),Z=b("p",null,"1、加入菜单id采用代码 {menuid}",-1),ee=b("p",null,"2、加入token 采用代码 {token}",-1),le=b("p",null,"参考模板：http://ip:port/pages/页面存放目录/index.html#/页面地址/{menuid}",-1),te=b("p",null,"1、加入菜单id采用代码 {menuid}",-1),ne=b("p",null,"2、加入token 采用代码 {token}",-1),oe={class:"text-center p-15"},re=H({__name:"Info",props:{onSuccess:{type:Function}},setup(I,{expose:O}){const S=I,e=J({vm:{id:"",form:{},allFunctions:[],menuFunctionList:[]},visible:!1,loading:!1,parentId:null,checkAll:!1,indeterminate:!1,iconFormVisible:!1}),C=K();O({open:(m="",n="")=>{var u;e.visible=!0,e.visible&&(e.vm.id=m),(u=C.value)==null||u.resetFields(),e.parentId=n,e.loading=!0,$.findForm(m).then(_=>{e.loading=!1,_.code==200&&(e.vm=_.data,e.vm.menuFunctionList.length==0&&e.vm.allFunctions.length>0&&L())})}});function Q(){var m;(m=C.value)==null||m.validate().then(async()=>{if(e.vm.form.type==2&&e.vm.menuFunctionList.length==0)return F.message.warning("请设置功能模块!");if(e.vm.form.type==2&&e.vm.menuFunctionList.length>0){var n=e.vm.menuFunctionList;for(let u=0;u<n.length;u++){const _=n[u];if(!_.number)return F.message.warning(`功能模块设置第${u+1}行 请填写序号!`);if(!_.functionCode)return F.message.warning(`功能模块设置第${u+1}行 请填写功能编码!`);if(!_.functionName)return F.message.warning(`功能模块设置第${u+1}行 请填写功能名称!`)}}try{e.loading=!0,e.vm.form.parentId=e.parentId??e.vm.form.parentId;const u=await $.saveForm(e.vm.id,e.vm);if(e.loading=!1,u.code!=200)return;F.message.success("操作成功!"),S.onSuccess(),e.visible=!1}catch{e.loading=!1}})}function w(m){return{number:m.number,menuId:e.vm.id?e.vm.id:0,functionCode:m.byName,functionName:m.name,remark:m.remark}}function L(){e.vm.menuFunctionList=[],e.vm.allFunctions.forEach(m=>{h(w(m))})}function A(){e.vm.menuFunctionList=[];var m=e.vm.allFunctions.filter(n=>n.byName=="Display");m.length>0&&e.vm.menuFunctionList.push(w(m[0]))}function B(m){var n=e.vm.menuFunctionList;e.vm.menuFunctionList=[];for(let u=0;u<n.length;u++){const _=n[u];u!=m&&e.vm.menuFunctionList.push(_)}}function h(m){m?e.vm.menuFunctionList.push(m):(e.vm.menuFunctionList.push({number:0,menuId:e.vm.id?e.vm.id:0,functionCode:"",functionName:"",remark:""}),console.log(e.vm.menuFunctionList))}function j(){e.vm.form.mode==2&&(e.vm.form.url="core/components/layouts/LayoutIframe.vue",e.vm.form.moduleUrl="http://ip:port/#/页面地址/{menuid}/{token}",e.vm.form.moduleUrlPro="http://ip:port/pages/页面存放目录/index.html#/页面地址/{menuid}")}function D(){e.vm.form.router=e.vm.form.componentName?"/"+e.vm.form.componentName:""}return(m,n)=>{const u=r("a-button"),_=r("a-space"),d=r("a-form-item"),i=r("a-col"),s=r("a-radio"),y=r("a-radio-group"),f=r("a-input"),P=r("a-input-search"),T=r("a-modal"),k=r("a-tooltip"),N=r("a-row"),U=r("a-table-column"),M=r("a-input-number"),z=r("a-popconfirm"),E=r("a-table"),R=r("a-form"),q=r("a-spin"),G=r("a-drawer");return v(),p(G,{open:e.visible,"onUpdate:open":n[24]||(n[24]=o=>e.visible=o),title:e.vm.id?"编辑":"新建",centered:"",onOk:n[25]||(n[25]=o=>e.visible=!1),width:1300},{footer:l(()=>[t(_,{size:8},{default:l(()=>[t(u,{type:"primary",loading:e.loading,onClick:n[0]||(n[0]=o=>Q())},{default:l(()=>[a(" 提交")]),_:1},8,["loading"]),t(u,{onClick:n[1]||(n[1]=o=>e.visible=!1)},{default:l(()=>[a("关闭")]),_:1})]),_:1})]),default:l(()=>[t(q,{spinning:e.loading},{default:l(()=>[t(R,{ref_key:"refForm",ref:C,layout:"vertical",model:e.vm.form},{default:l(()=>[t(N,{gutter:[16,0]},{default:l(()=>[t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"菜单Id"},{default:l(()=>[a(V(e.vm.form.id),1)]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"选项类型"},{default:l(()=>[t(y,{value:e.vm.form.type,"onUpdate:value":n[2]||(n[2]=o=>e.vm.form.type=o)},{default:l(()=>[t(s,{value:1},{default:l(()=>[a("目录")]),_:1}),t(s,{value:2},{default:l(()=>[a("菜单")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"模式"},{default:l(()=>[t(y,{value:e.vm.form.mode,"onUpdate:value":n[3]||(n[3]=o=>e.vm.form.mode=o),onChange:j},{default:l(()=>[t(s,{value:1},{default:l(()=>[a("普通")]),_:1}),t(s,{value:2},{default:l(()=>[a("微前端")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"编号"},{default:l(()=>[t(f,{value:e.vm.form.number,"onUpdate:value":n[4]||(n[4]=o=>e.vm.form.number=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"菜单名称"},{default:l(()=>[t(f,{value:e.vm.form.name,"onUpdate:value":n[5]||(n[5]=o=>e.vm.form.name=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,null,{label:l(()=>[a(" 图标  "),X]),default:l(()=>[t(P,{value:e.vm.form.icon,"onUpdate:value":n[6]||(n[6]=o=>e.vm.form.icon=o),placeholder:"请输入",onSearch:n[7]||(n[7]=o=>e.iconFormVisible=!e.iconFormVisible)},{enterButton:l(()=>[e.vm.form.icon?(v(),p(x,{key:0,name:e.vm.form.icon},null,8,["name"])):(v(),p(x,{key:1,name:"search-outlined"}))]),_:1},8,["value"]),t(T,{open:e.iconFormVisible,"onUpdate:open":n[10]||(n[10]=o=>e.iconFormVisible=o),title:"图标库",width:"100%","wrap-class-name":"full-modal",footer:!1},{default:l(()=>[t(W,{name:e.vm.form.icon,"onUpdate:name":n[8]||(n[8]=o=>e.vm.form.icon=o),onOnChangeName:n[9]||(n[9]=()=>e.iconFormVisible=!e.iconFormVisible)},null,8,["name"])]),_:1},8,["open"])]),_:1})]),_:1}),e.vm.form.type==2?(v(),p(i,{key:0,xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"组件名称"},{default:l(()=>[t(f,{value:e.vm.form.componentName,"onUpdate:value":n[11]||(n[11]=o=>e.vm.form.componentName=o),placeholder:"请输入",onChange:D},null,8,["value"])]),_:1})]),_:1})):g("",!0),e.vm.form.type==2?(v(),p(i,{key:1,xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"菜单页面物理地址"},{default:l(()=>[t(f,{value:e.vm.form.url,"onUpdate:value":n[12]||(n[12]=o=>e.vm.form.url=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})):g("",!0),e.vm.form.type==2?(v(),p(i,{key:2,xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,null,{label:l(()=>[a(" 菜单路由    "),t(k,null,{title:l(()=>[a("跳转外部地址使用此表达式：/external/jump/:path(.*) 。并且要在跳转地址填上外部网址")]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(f,{value:e.vm.form.router,"onUpdate:value":n[13]||(n[13]=o=>e.vm.form.router=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})):g("",!0),e.vm.form.type==2?(v(),p(i,{key:3,xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,null,{label:l(()=>[a(" 跳转地址    "),t(k,null,{title:l(()=>[a("跳转地址（不填默认使用 菜单路由地址）支持 http、https")]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(f,{value:e.vm.form.jumpUrl,"onUpdate:value":n[14]||(n[14]=o=>e.vm.form.jumpUrl=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})):g("",!0),e.vm.form.type==2?(v(),p(i,{key:4,xs:24},{default:l(()=>[t(N,{style:{width:"100%"}},{default:l(()=>[t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,null,{label:l(()=>[a(" 显示状态   "),t(k,null,{title:l(()=>[a(" 隐藏后菜单不会显示在左侧显示，但是路由会自动添加到程序中 ")]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(y,{value:e.vm.form.show,"onUpdate:value":n[15]||(n[15]=o=>e.vm.form.show=o)},{default:l(()=>[t(s,{value:!0},{default:l(()=>[a("显示")]),_:1}),t(s,{value:!1},{default:l(()=>[a("隐藏")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,null,{label:l(()=>[a(" 菜单状态    "),t(k,null,{title:l(()=>[a("停用后菜单不会显示在左侧显示，并且路由也不会自动添加到程序中")]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(y,{value:e.vm.form.state,"onUpdate:value":n[16]||(n[16]=o=>e.vm.form.state=o)},{default:l(()=>[t(s,{value:!0},{default:l(()=>[a("正常")]),_:1}),t(s,{value:!1},{default:l(()=>[a("停用")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"是否缓存组件"},{default:l(()=>[t(y,{value:e.vm.form.keepAlive,"onUpdate:value":n[17]||(n[17]=o=>e.vm.form.keepAlive=o)},{default:l(()=>[t(s,{value:!0},{default:l(()=>[a("是")]),_:1}),t(s,{value:!1},{default:l(()=>[a("否")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{xs:24,sm:12,md:12,lg:12,xl:6},{default:l(()=>[t(d,{label:"选项卡能否关闭"},{default:l(()=>[t(y,{value:e.vm.form.close,"onUpdate:value":n[18]||(n[18]=o=>e.vm.form.close=o)},{default:l(()=>[t(s,{value:!0},{default:l(()=>[a("是")]),_:1}),t(s,{value:!1},{default:l(()=>[a("否")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})):g("",!0),e.vm.form.type==2?(v(),p(N,{key:5,gutter:[16,0],style:{width:"100%"}},{default:l(()=>[e.vm.form.type==2&&e.vm.form.mode==2?(v(),p(i,{key:0,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(d,null,{label:l(()=>[a(" 模块地址（Dev 开发模式）    "),t(k,null,{title:l(()=>[a(" 参考模板: "),Y,Z,ee]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(f,{value:e.vm.form.moduleUrl,"onUpdate:value":n[19]||(n[19]=o=>e.vm.form.moduleUrl=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})):g("",!0),e.vm.form.type==2&&e.vm.form.mode==2?(v(),p(i,{key:1,xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(d,null,{label:l(()=>[a(" 模块地址（Pro 生产模式）    "),t(k,null,{title:l(()=>[a(" 参考模板: "),le,te,ne]),default:l(()=>[t(x,{name:"QuestionCircleOutlined",class:"text-danger"})]),_:1})]),default:l(()=>[t(f,{value:e.vm.form.moduleUrlPro,"onUpdate:value":n[20]||(n[20]=o=>e.vm.form.moduleUrlPro=o),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})):g("",!0)]),_:1})):g("",!0),t(i,{xs:24},{default:l(()=>[t(E,{"data-source":e.vm.menuFunctionList,size:"small",pagination:!1},{default:l(()=>[t(U,{key:"index",title:"索引"},{default:l(({index:o})=>[a(V(o+1),1)]),_:1}),t(U,{key:"number",title:"序号","data-index":"number"},{default:l(({record:o})=>[t(M,{value:o.number,"onUpdate:value":c=>o.number=c,min:1,max:500},null,8,["value","onUpdate:value"])]),_:1}),t(U,{key:"functionCode",title:"功能编码","data-index":"functionCode"},{default:l(({record:o})=>[t(f,{value:o.functionCode,"onUpdate:value":c=>o.functionCode=c,placeholder:"功能编码"},null,8,["value","onUpdate:value"])]),_:1}),t(U,{key:"functionName",title:"功能名称","data-index":"functionName"},{default:l(({record:o})=>[t(f,{value:o.functionName,"onUpdate:value":c=>o.functionName=c,placeholder:"功能编码"},null,8,["value","onUpdate:value"])]),_:1}),t(U,{key:"remark",title:"备注","data-index":"remark"},{default:l(({record:o})=>[t(f,{value:o.remark,"onUpdate:value":c=>o.remark=c,placeholder:"功能编码"},null,8,["value","onUpdate:value"])]),_:1}),t(U,{key:"action",title:"操作"},{default:l(({index:o})=>[t(z,{title:"确定要移除吗？","ok-text":"是","cancel-text":"否",onConfirm:c=>B(o)},{default:l(()=>[t(u,{type:"link",danger:""},{default:l(()=>[a("移除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data-source"]),b("div",oe,[t(u,{type:"primary",onClick:n[21]||(n[21]=o=>h())},{default:l(()=>[a("添加一行")]),_:1}),t(u,{class:"ml-15",onClick:n[22]||(n[22]=o=>L())},{default:l(()=>[a("使用默认功能集")]),_:1}),t(u,{class:"ml-15",onClick:n[23]||(n[23]=o=>A())},{default:l(()=>[a("使用显示功能")]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])]),_:1},8,["open","title"])}}});export{re as _};
