import{d as B,r as P,R as q,b as h,e as H,f as r,o as s,l as c,w as e,a as t,u as k,i,z as d,c as C,D as J,t as Q,G as W,g as $,T as U}from"./index-1d3290fc.js";import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-5c9d9d70.js";import{S as T,_ as X}from"./Info.vue_vue_type_script_setup_true_lang-bf5b7076.js";import{_ as Y}from"./PageContainer.vue_vue_type_script_setup_true_lang-4a22be12.js";import{_ as Z}from"./TableCurd.vue_vue_type_script_setup_true_lang-a4411ecd.js";import{_ as ee}from"./DataAuthority.vue_vue_type_script_setup_true_lang-831e93fb.js";import{_ as te}from"./FunctionAuthority.vue_vue_type_script_setup_true_lang-4646cafd.js";import"./SysOrganizationService-c4d109f1.js";const ae={key:0},oe={key:1},ne=["onClick"],se=$("a",{class:"text-danger"},"删除",-1),le=["onClick"],re=["onClick"],ie=B({name:"system_role"}),ve=B({...ie,setup(ce){const o=P({search:{state:!1,vm:{name:void 0,loginName:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),y=q(),z=h(),S=h(),N=h(),L=h(),A=h();H(()=>{m()});async function m(){try{o.loading=!0;const u=await T.findList(o.page,o.size,o.search.vm,o.search.sort);if(o.loading=!1,u.code!=1)return;o.page=u.data.page,o.size=u.data.size,o.total=u.data.total,o.columns=u.data.columns,o.data=u.data.dataSource}catch{o.loading=!1}}async function D(u){var g;let n=[];if(u?n.push(u):n=((g=z.value)==null?void 0:g.getSelectedRowKeys())??[],n.length==0)return U.message.error("请选择要删除的行!");try{o.loading=!0;const x=await T.deleteList(n);if(o.loading=!1,x.code!=1)return;U.message.success("删除成功!"),m()}catch{o.loading=!1}}function E(){T.exportExcel(o.search.vm,o.search.sort)}return(u,n)=>{const g=r("a-input"),x=r("a-form-item"),w=r("a-col"),f=r("a-button"),O=r("a-space"),V=r("a-row"),j=r("a-form"),F=r("a-popconfirm"),R=r("a-menu-item"),I=r("a-menu"),M=r("a-dropdown"),G=r("a-checkbox"),K=r("a-popover"),_=r("a-table-column"),p=r("a-tag"),b=r("a-divider");return s(),c(Y,null,{default:e(()=>[t(Z,{ref_key:"refTableCurd",ref:z,config:o,onChange:n[8]||(n[8]=a=>{o.page=a.pagination.current??1,o.size=a.pagination.pageSize??o.size,o.search.sort=a.sorter instanceof Array?[...a.sorter]:[a.sorter],m()}),onShowSizeChange:n[9]||(n[9]=({current:a,size:l})=>{o.page=a==0?1:a,o.size=l,m()})},{search:e(()=>[k(y).search?(s(),c(j,{key:0,ref_key:"refSearchForm",ref:N,model:o.search.vm},{default:e(()=>[t(V,{gutter:[16,0]},{default:e(()=>[t(w,{xs:24,sm:12,md:8,lg:6,xl:6},{default:e(()=>[t(x,{class:"mb-0",name:"name",label:"真实姓名"},{default:e(()=>[t(g,{value:o.search.vm.name,"onUpdate:value":n[0]||(n[0]=a=>o.search.vm.name=a),placeholder:"真实名称"},null,8,["value"])]),_:1})]),_:1}),t(w,{xs:24,sm:12,md:8,lg:6,xl:6},{default:e(()=>[t(x,{class:"mb-0",name:"loginName",label:"账户名称"},{default:e(()=>[t(g,{value:o.search.vm.loginName,"onUpdate:value":n[1]||(n[1]=a=>o.search.vm.loginName=a),placeholder:"账户名称"},null,8,["value"])]),_:1})]),_:1}),t(w,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:e(()=>[t(O,{size:8},{default:e(()=>[t(f,{onClick:n[2]||(n[2]=a=>{var l;o.page=1,(l=N.value)==null||l.resetFields(),m()})},{default:e(()=>[i(" 重置 ")]),_:1}),t(f,{type:"primary",onClick:n[3]||(n[3]=a=>{o.page=1,m()})},{default:e(()=>[i(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):d("",!0)]),"toolbar-left":e(()=>[k(y).search?(s(),c(f,{key:0,onClick:n[4]||(n[4]=a=>o.search.state=!o.search.state)},{default:e(()=>[o.search.state?(s(),C("div",ae,[t(v,{name:"UpOutlined"}),i("  收起")])):(s(),C("div",oe,[t(v,{name:"DownOutlined"}),i("  展开")]))]),_:1})):d("",!0),k(y).insert?(s(),c(f,{key:1,type:"primary",onClick:n[5]||(n[5]=()=>{var a;return(a=S.value)==null?void 0:a.open()})},{icon:e(()=>[t(v,{name:"PlusOutlined"})]),default:e(()=>[i(" 新建 ")]),_:1})):d("",!0),k(y).delete?(s(),c(F,{key:2,title:"您确定要删除?",onConfirm:n[6]||(n[6]=a=>D()),okText:"确定",cancelText:"取消"},{default:e(()=>[t(f,{type:"primary",danger:""},{icon:e(()=>[t(v,{name:"DeleteOutlined"})]),default:e(()=>[i(" 批量删除 ")]),_:1})]),_:1})):d("",!0)]),"toolbar-right":e(()=>[t(M,null,{overlay:e(()=>[t(I,null,{default:e(()=>[t(R,{key:"1",onClick:n[7]||(n[7]=a=>E())},{default:e(()=>[i("导出 Excel")]),_:1})]),_:1})]),default:e(()=>[t(f,null,{default:e(()=>[i(" 更多 "),t(v,{name:"ellipsis-outlined"})]),_:1})]),_:1}),t(K,null,{content:e(()=>[(s(!0),C(W,null,J(o.columns.filter(a=>a.fieldName.substr(0,1)!="_"),a=>(s(),C("div",null,[t(G,{checked:a.show,"onUpdate:checked":l=>a.show=l},{default:e(()=>[i(Q(a.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:e(()=>[t(f,{type:"text"},{icon:e(()=>[t(v,{name:"setting-outlined"})]),_:1})]),_:1})]),"table-col":e(()=>[t(_,{title:"编号","data-index":"number"}),t(_,{title:"角色名称","data-index":"name"}),t(_,{title:"数据权限","data-index":"permissionType"},{default:e(({record:a})=>[a.permissionType==1?(s(),c(p,{key:0,color:"success"},{default:e(()=>[i("自定义权限")]),_:1})):d("",!0),a.permissionType==2?(s(),c(p,{key:1,color:"success"},{default:e(()=>[i("查看所有数据")]),_:1})):d("",!0),a.permissionType==3?(s(),c(p,{key:2,color:"success"},{default:e(()=>[i("仅查看本组织")]),_:1})):d("",!0),a.permissionType==4?(s(),c(p,{key:3,color:"success"},{default:e(()=>[i("仅查看本组织和下属组织")]),_:1})):d("",!0),a.permissionType==5?(s(),c(p,{key:4,color:"success"},{default:e(()=>[i("仅查看本人")]),_:1})):d("",!0)]),_:1}),t(_,{title:"删除锁定","data-index":"deleteLock"},{default:e(({record:a})=>[a.deleteLock?(s(),c(p,{key:0,color:"success"},{default:e(()=>[i("锁定")]),_:1})):(s(),c(p,{key:1,color:"warning"},{default:e(()=>[i("不锁定")]),_:1}))]),_:1}),t(_,{title:"备注","data-index":"remark"}),t(_,{title:"更新时间","data-index":"lastModificationTime"}),t(_,{title:"创建时间","data-index":"creationTime"}),t(_,{title:"操作","data-index":"id"},{default:e(({record:a})=>[k(y).update?(s(),C("a",{key:0,href:"javascript:;",onClick:()=>{var l;return(l=S.value)==null?void 0:l.open(a.id)}},"编辑",8,ne)):d("",!0),t(b,{type:"vertical"}),k(y).delete?(s(),c(F,{key:1,title:"您确定要删除?",onConfirm:l=>D(a.id),okText:"确定",cancelText:"取消"},{default:e(()=>[se]),_:2},1032,["onConfirm"])):d("",!0),t(b,{type:"vertical"}),$("a",{href:"javascript:;",onClick:()=>{var l;return(l=A.value)==null?void 0:l.open(a.id)}},"功能权限",8,le),t(b,{type:"vertical"}),$("a",{href:"javascript:;",onClick:()=>{var l;return(l=L.value)==null?void 0:l.open(a.id)}},"数据权限",8,re)]),_:1})]),_:1},8,["config"]),t(X,{ref_key:"refInfo",ref:S,onSuccess:()=>m()},null,8,["onSuccess"]),t(ee,{ref_key:"refDataAuthority",ref:L,onSuccess:()=>m()},null,8,["onSuccess"]),t(te,{ref_key:"refFunctionAuthority",ref:A,onSuccess:()=>m()},null,8,["onSuccess"])]),_:1})}}});export{ve as default};
