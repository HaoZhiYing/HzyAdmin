import{d as B,r as F,R as I,b as w,e as U,T as h,f as r,o as s,l as c,w as o,a as n,u as l,i as u,z as f,c as x,g as j}from"./index-1d3290fc.js";import{_ as C}from"./AppIcon.vue_vue_type_script_setup_true_lang-5c9d9d70.js";import{_ as A}from"./Info.vue_vue_type_script_setup_true_lang-4af0dccf.js";import{_ as M}from"./PageContainer.vue_vue_type_script_setup_true_lang-4a22be12.js";import{_ as E}from"./TableCurd.vue_vue_type_script_setup_true_lang-a4411ecd.js";import{S as O}from"./SysOrganizationService-c4d109f1.js";const P={key:0},q={key:1},G=["onClick"],H=["onClick"],J=j("a",{class:"text-danger"},"删除",-1),Q=B({name:"system_function"}),oe=B({...Q,setup(W){const e=F({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),i=I(),S=w(),g=w(),$=w();U(()=>{_()});async function _(){try{e.loading=!0;const m=await O.findList(e.search.vm);if(e.loading=!1,m.code!=1)return;e.data=h.genTreeData(m.data,null),e.expandedRowKeys=m.data.map(a=>a.id)}catch{e.loading=!1}}async function b(m){var v;let a=[];if(m?a.push(m):a=((v=S.value)==null?void 0:v.getSelectedRowKeys())??[],a.length==0)return h.message.error("请选择要删除的行!");try{e.loading=!0;const k=await O.deleteList(a);if(e.loading=!1,k.code!=1)return;h.message.success("删除成功!"),_()}catch{e.loading=!1}}return(m,a)=>{const v=r("a-input"),k=r("a-form-item"),z=r("a-col"),y=r("a-button"),L=r("a-space"),V=r("a-row"),D=r("a-form"),R=r("a-popconfirm"),p=r("a-table-column"),K=r("a-tag"),T=r("a-divider");return s(),c(M,null,{default:o(()=>[n(E,{ref_key:"refTableCurd",ref:S,config:e,onChange:a[6]||(a[6]=t=>{e.page=t.pagination.current??1,e.size=t.pagination.pageSize??e.size,e.search.sort=t.sorter instanceof Array?[...t.sorter]:[t.sorter],_()}),onShowSizeChange:a[7]||(a[7]=({current:t,size:d})=>{e.page=t==0?1:t,e.size=d,_()}),"is-pagination":!1,expandedRowKeys:e.expandedRowKeys,"onUpdate:expandedRowKeys":a[8]||(a[8]=t=>e.expandedRowKeys=t)},{search:o(()=>[l(i).search?(s(),c(D,{key:0,ref_key:"refSearchForm",ref:$,model:e.search.vm},{default:o(()=>[n(V,{gutter:[16,0]},{default:o(()=>[n(z,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[n(k,{class:"mb-0",name:"name",label:"名称"},{default:o(()=>[n(v,{value:e.search.vm.name,"onUpdate:value":a[0]||(a[0]=t=>e.search.vm.name=t),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),n(z,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:o(()=>[n(L,{size:8},{default:o(()=>[n(y,{onClick:a[1]||(a[1]=t=>{var d;e.page=1,(d=$.value)==null||d.resetFields(),_()})},{default:o(()=>[u(" 重置 ")]),_:1}),n(y,{type:"primary",onClick:a[2]||(a[2]=t=>{e.page=1,_()})},{default:o(()=>[u(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):f("",!0)]),"toolbar-left":o(()=>[l(i).search?(s(),c(y,{key:0,onClick:a[3]||(a[3]=t=>e.search.state=!e.search.state)},{default:o(()=>[e.search.state?(s(),x("div",P,[n(C,{name:"UpOutlined"}),u("  收起")])):(s(),x("div",q,[n(C,{name:"DownOutlined"}),u("  展开")]))]),_:1})):f("",!0),l(i).insert?(s(),c(y,{key:1,type:"primary",onClick:a[4]||(a[4]=()=>{var t;return(t=g.value)==null?void 0:t.open()})},{icon:o(()=>[n(C,{name:"PlusOutlined"})]),default:o(()=>[u(" 新建 ")]),_:1})):f("",!0),l(i).delete?(s(),c(R,{key:2,title:"您确定要删除?",onConfirm:a[5]||(a[5]=t=>b()),okText:"确定",cancelText:"取消"},{default:o(()=>[n(y,{type:"primary",danger:""},{icon:o(()=>[n(C,{name:"DeleteOutlined"})]),default:o(()=>[u(" 批量删除 ")]),_:1})]),_:1})):f("",!0)]),"toolbar-right":o(()=>[]),"table-col":o(()=>[n(p,{title:"组织名称","data-index":"name"}),n(p,{title:"排序号","data-index":"orderNumber"}),n(p,{title:"级别码","data-index":"levelCode"}),n(p,{title:"状态","data-index":"state"},{default:o(({record:t})=>[t.state==1?(s(),c(K,{key:0,color:"success"},{default:o(()=>[u("正常")]),_:1})):(s(),c(K,{key:1,color:"warning"},{default:o(()=>[u("停用")]),_:1}))]),_:1}),n(p,{title:"更新时间","data-index":"lastModificationTime"}),n(p,{title:"创建时间","data-index":"creationTime"}),l(i).update||l(i).delete||l(i).insert?(s(),c(p,{key:0,title:"操作","data-index":"id"},{default:o(({record:t})=>[l(i).insert?(s(),x("a",{key:0,href:"javascript:void(0)",onClick:d=>{var N;return(N=g.value)==null?void 0:N.open(null,t.id)}},"新建",8,G)):f("",!0),n(T,{type:"vertical"}),l(i).update?(s(),x("a",{key:1,href:"javascript:;",onClick:()=>{var d;return(d=g.value)==null?void 0:d.open(t.id,t.parentId)}},"编辑",8,H)):f("",!0),n(T,{type:"vertical"}),l(i).delete?(s(),c(R,{key:2,title:"您确定要删除?",onConfirm:d=>b(t.id),okText:"确定",cancelText:"取消"},{default:o(()=>[J]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["config","expandedRowKeys"]),n(A,{ref_key:"refInfo",ref:g,onSuccess:()=>_()},null,8,["onSuccess"])]),_:1})}}});export{oe as default};
