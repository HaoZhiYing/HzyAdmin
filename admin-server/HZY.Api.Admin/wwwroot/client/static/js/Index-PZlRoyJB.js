import{d as V,r as j,b_ as D,b as w,e as F,T as h,f as r,o as s,l as c,w as a,a as n,u as l,j as m,B as u,c as x,g as U}from"./index-C9oHGpmd.js";import{_ as C}from"./AppIcon.vue_vue_type_script_setup_true_lang-o_ph5tPH.js";import{_ as A}from"./Info.vue_vue_type_script_setup_true_lang-wXslfctO.js";import{_ as M}from"./PageContainer.vue_vue_type_script_setup_true_lang-w--qcJ6v.js";import{_ as E}from"./TableCurd.vue_vue_type_script_setup_true_lang-nb7-a0jh.js";import{S as N}from"./SysOrganizationService-BI7rxZf6.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-dsx0k3kj.js";const P={key:0},q={key:1},G=["onClick"],H=["onClick"],J=U("a",{class:"text-danger"},"删除",-1),oe=V({name:"system_function",__name:"Index",setup(Q){const t=j({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),i=D(),S=w(),g=w(),b=w();F(()=>{f()});async function f(){try{t.loading=!0;const _=await N.findList(t.search.vm);if(t.loading=!1,_.code!=200)return;t.data=h.genTreeData(_.data,null)}catch{t.loading=!1}}async function $(_){var v;let o=[];if(_?o.push(_):o=((v=S.value)==null?void 0:v.getSelectedRowKeys())??[],o.length==0)return h.message.error("请选择要删除的行!");try{t.loading=!0;const k=await N.deleteList(o);if(t.loading=!1,k.code!=200)return;h.message.success("删除成功!"),f()}catch{t.loading=!1}}return(_,o)=>{const v=r("a-input"),k=r("a-form-item"),z=r("a-col"),y=r("a-button"),O=r("a-space"),I=r("a-row"),L=r("a-form"),T=r("a-popconfirm"),p=r("a-table-column"),K=r("a-tag"),R=r("a-divider");return s(),c(M,null,{default:a(()=>[n(E,{ref_key:"refTableCurd",ref:S,config:t,onChange:o[6]||(o[6]=e=>{t.page=e.pagination.current??1,t.size=e.pagination.pageSize??t.size,t.search.sort=e.sorter instanceof Array?[...e.sorter]:[e.sorter],f()}),onShowSizeChange:o[7]||(o[7]=({current:e,size:d})=>{t.page=e==0?1:e,t.size=d,f()}),"is-pagination":!1,expandedRowKeys:t.expandedRowKeys,"onUpdate:expandedRowKeys":o[8]||(o[8]=e=>t.expandedRowKeys=e)},{search:a(()=>[l(i).search?(s(),c(L,{key:0,ref_key:"refSearchForm",ref:b,model:t.search.vm},{default:a(()=>[n(I,{gutter:[16,0]},{default:a(()=>[n(z,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[n(k,{class:"mb-0",name:"name",label:"名称"},{default:a(()=>[n(v,{value:t.search.vm.name,"onUpdate:value":o[0]||(o[0]=e=>t.search.vm.name=e),placeholder:"名称"},null,8,["value"])]),_:1})]),_:1}),n(z,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:a(()=>[n(O,{size:8},{default:a(()=>[n(y,{onClick:o[1]||(o[1]=e=>{var d;t.page=1,(d=b.value)==null||d.resetFields(),f()})},{default:a(()=>[m(" 重置 ")]),_:1}),n(y,{type:"primary",onClick:o[2]||(o[2]=e=>{t.page=1,f()})},{default:a(()=>[m(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):u("",!0)]),"toolbar-left":a(()=>[l(i).search?(s(),c(y,{key:0,onClick:o[3]||(o[3]=e=>t.search.state=!t.search.state)},{default:a(()=>[t.search.state?(s(),x("div",P,[n(C,{name:"UpOutlined"}),m("  收起")])):(s(),x("div",q,[n(C,{name:"DownOutlined"}),m("  展开")]))]),_:1})):u("",!0),l(i).insert?(s(),c(y,{key:1,type:"primary",onClick:o[4]||(o[4]=()=>{var e;return(e=g.value)==null?void 0:e.open()})},{icon:a(()=>[n(C,{name:"PlusOutlined"})]),default:a(()=>[m(" 新建 ")]),_:1})):u("",!0),l(i).delete?(s(),c(T,{key:2,title:"您确定要删除?",onConfirm:o[5]||(o[5]=e=>$()),okText:"确定",cancelText:"取消"},{default:a(()=>[n(y,{type:"primary",danger:""},{icon:a(()=>[n(C,{name:"DeleteOutlined"})]),default:a(()=>[m(" 批量删除 ")]),_:1})]),_:1})):u("",!0)]),"toolbar-right":a(()=>[]),"table-col":a(()=>[n(p,{title:"组织名称","data-index":"name"}),n(p,{title:"排序号","data-index":"orderNumber"}),n(p,{title:"级别码","data-index":"levelCode"}),n(p,{title:"状态","data-index":"state"},{default:a(({record:e})=>[e.state==1?(s(),c(K,{key:0,color:"success"},{default:a(()=>[m("正常")]),_:1})):(s(),c(K,{key:1,color:"warning"},{default:a(()=>[m("停用")]),_:1}))]),_:1}),n(p,{title:"更新时间","data-index":"lastModificationTime"}),n(p,{title:"创建时间","data-index":"creationTime"}),l(i).update||l(i).delete||l(i).insert?(s(),c(p,{key:0,title:"操作","data-index":"id"},{default:a(({record:e})=>[l(i).insert?(s(),x("a",{key:0,href:"javascript:void(0)",onClick:d=>{var B;return(B=g.value)==null?void 0:B.open(null,e.id)}},"新建",8,G)):u("",!0),n(R,{type:"vertical"}),l(i).update?(s(),x("a",{key:1,href:"javascript:;",onClick:()=>{var d;return(d=g.value)==null?void 0:d.open(e.id,e.parentId)}},"编辑",8,H)):u("",!0),n(R,{type:"vertical"}),l(i).delete?(s(),c(T,{key:2,title:"您确定要删除?",onConfirm:d=>$(e.id),okText:"确定",cancelText:"取消"},{default:a(()=>[J]),_:2},1032,["onConfirm"])):u("",!0)]),_:1})):u("",!0)]),_:1},8,["config","expandedRowKeys"]),n(A,{ref_key:"refInfo",ref:g,onSuccess:()=>f()},null,8,["onSuccess"])]),_:1})}}});export{oe as default};
