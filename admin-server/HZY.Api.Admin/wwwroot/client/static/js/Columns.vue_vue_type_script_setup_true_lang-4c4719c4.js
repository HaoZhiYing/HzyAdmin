var B=Object.defineProperty;var F=(u,s,e)=>s in u?B(u,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[s]=e;var L=(u,s,e)=>(F(u,typeof s!="symbol"?s+"":s,e),e);import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-7672b527.js";import{H as T,d as V,r as E,b as N,bS as H,f as r,o as f,l as x,w as a,a as t,j as d,c as P,g as R,T as k}from"./index-5ce8de01.js";import{_ as j}from"./TableCurd.vue_vue_type_script_setup_true_lang-73963374.js";class y{static findList(s,e,b={},h=[]){return T.post(`${this.urlPrefix}/findList`,{page:s,size:e,search:b,searchSort:h})}static deleteList(s){return T.post(`${this.urlPrefix}/deleteList`,{data:s})}static synchronization(s){return T.post(`${this.urlPrefix}/synchronization/${s}`)}static change(s){return T.post(`${this.urlPrefix}/change`,s)}}L(y,"urlPrefix","/api/v1/admin/LowCodeTableInfo");const K={key:0},M={key:1},q=R("a",{class:"text-danger"},"删除",-1),W=V({__name:"Columns",props:{rowData:{}},setup(u){const s=u,e=E({search:{state:!1,vm:{Low_Code_TableId:void 0,columnName:void 0,describe:void 0},sort:[]},loading:!1,page:1,size:100,total:100,columns:[],data:[]}),b=N(),h=N();H(()=>{s.rowData&&m()},s.rowData);async function m(){e.loading=!0,e.search.vm.Low_Code_TableId=s.rowData.id;const l=await y.findList(e.page,e.size,e.search.vm,e.search.sort);e.loading=!1,l.code==200&&(e.page=l.data.page,e.size=l.data.size,e.total=l.data.total,e.columns=l.data.columns,e.data=l.data.dataSource)}async function $(l){var g;let o=[];if(l?o.push(l):o=((g=b.value)==null?void 0:g.getSelectedRowKeys())??[],o.length==0)return k.message.error("请选择要删除的行!");e.loading=!0;const p=await y.deleteList(o);e.loading=!1,p.code==200&&(k.message.success("删除成功!"),m())}function S(){y.synchronization(s.rowData.id).then(l=>{k.message.success("同步成功!"),m()})}function D(){y.change(e.data).then(l=>{k.message.success("数据变更成功!"),m()})}return(l,o)=>{const p=r("a-input"),g=r("a-form-item"),z=r("a-col"),_=r("a-button"),U=r("a-space"),I=r("a-row"),O=r("a-form"),C=r("a-popconfirm"),i=r("a-table-column"),w=r("a-tag");return f(),x(j,{ref_key:"refTableCurd",ref:b,config:e,onChange:o[8]||(o[8]=n=>{e.page=n.pagination.current??1,e.size=n.pagination.pageSize??e.size,m()}),onShowSizeChange:o[9]||(o[9]=({current:n,size:c})=>{e.page=n==0?1:n,e.size=c,m()})},{search:a(()=>[t(O,{ref_key:"refSearchForm",ref:h,model:e.search.vm},{default:a(()=>[t(I,{gutter:[16,0]},{default:a(()=>[t(z,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[t(g,{class:"mb-0",name:"columnName",label:"列名称"},{default:a(()=>[t(p,{value:e.search.vm.columnName,"onUpdate:value":o[0]||(o[0]=n=>e.search.vm.columnName=n),placeholder:"列名称"},null,8,["value"])]),_:1})]),_:1}),t(z,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[t(g,{class:"mb-0",name:"describe",label:"显示名称"},{default:a(()=>[t(p,{value:e.search.vm.describe,"onUpdate:value":o[1]||(o[1]=n=>e.search.vm.describe=n),placeholder:"显示名称"},null,8,["value"])]),_:1})]),_:1}),t(z,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:a(()=>[t(U,{size:8},{default:a(()=>[t(_,{onClick:o[2]||(o[2]=n=>{var c;e.page=1,(c=h.value)==null||c.resetFields(),m()})},{default:a(()=>[d(" 重置 ")]),_:1}),t(_,{type:"primary",onClick:o[3]||(o[3]=n=>{e.page=1,m()})},{default:a(()=>[d(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"toolbar-left":a(()=>[t(_,{onClick:o[4]||(o[4]=n=>e.search.state=!e.search.state)},{default:a(()=>[e.search.state?(f(),P("div",K,[t(v,{name:"UpOutlined"}),d("  收起")])):(f(),P("div",M,[t(v,{name:"DownOutlined"}),d("  展开")]))]),_:1}),t(C,{title:"您确定要更新表吗?可能会导致数据丢失",onConfirm:o[5]||(o[5]=n=>S()),okText:"确定",cancelText:"取消"},{default:a(()=>[t(_,{type:"primary"},{icon:a(()=>[t(v,{name:"ReloadOutlined"})]),default:a(()=>[d(" 同步字段 ")]),_:1})]),_:1}),t(C,{title:"您确定要提交更改?",onConfirm:o[6]||(o[6]=n=>D()),okText:"确定",cancelText:"取消"},{default:a(()=>[t(_,{type:"primary"},{icon:a(()=>[t(v,{name:"PlusOutlined"})]),default:a(()=>[d(" 提交更改 ")]),_:1})]),_:1}),t(C,{title:"您确定要删除?",onConfirm:o[7]||(o[7]=n=>$()),okText:"确定",cancelText:"取消"},{default:a(()=>[t(_,{type:"primary",danger:""},{icon:a(()=>[t(v,{name:"DeleteOutlined"})]),default:a(()=>[d(" 批量删除 ")]),_:1})]),_:1})]),"toolbar-right":a(()=>[]),"table-col":a(()=>[t(i,{title:"列名称","data-index":"columnName"}),t(i,{title:"数据库类型","data-index":"databaseColumnType"}),t(i,{title:"C#字段名称","data-index":"csField"}),t(i,{title:"C#数据类型","data-index":"csType"}),t(i,{title:"是否主键","data-index":"isPrimary"},{default:a(({record:n})=>[n.isPrimary?(f(),x(w,{key:0,color:"success"},{default:a(()=>[d("是")]),_:1})):(f(),x(w,{key:1,color:"default"},{default:a(()=>[d("否")]),_:1}))]),_:1}),t(i,{title:"是否自增","data-index":"isIdentity"},{default:a(({record:n})=>[n.isIdentity?(f(),x(w,{key:0,color:"success"},{default:a(()=>[d("是")]),_:1})):(f(),x(w,{key:1,color:"default"},{default:a(()=>[d("否")]),_:1}))]),_:1}),t(i,{title:"显示名称","data-index":"displayName"},{default:a(({record:n})=>[t(p,{value:n.displayName,"onUpdate:value":c=>n.displayName=c},null,8,["value","onUpdate:value"])]),_:1}),t(i,{title:"列描述","data-index":"describe"},{default:a(({record:n})=>[t(p,{value:n.describe,"onUpdate:value":c=>n.describe=c},null,8,["value","onUpdate:value"])]),_:1}),t(i,{title:"更新时间","data-index":"lastModificationTime",width:"120px"}),t(i,{title:"创建时间","data-index":"creationTime",width:"120px"}),t(i,{title:"操作","data-index":"id"},{default:a(({record:n})=>[t(C,{title:"您确定要删除?",onConfirm:c=>$(n.id),okText:"确定",cancelText:"取消"},{default:a(()=>[q]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["config"])}}});export{W as _};
