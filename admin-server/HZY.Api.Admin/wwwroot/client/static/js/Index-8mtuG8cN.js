import{_ as c}from"./AppIcon.vue_vue_type_script_setup_true_lang-o_ph5tPH.js";import{_ as O}from"./Info.vue_vue_type_script_setup_true_lang-nPdJNlyA.js";import{d as A,r as F,b as y,e as I,f as i,o as k,l as V,w as t,a as e,j as d,c as z,u as j,g as C,T as g}from"./index-C9oHGpmd.js";import{_ as M}from"./PageContainer.vue_vue_type_script_setup_true_lang-w--qcJ6v.js";import{_ as G}from"./TableCurd.vue_vue_type_script_setup_true_lang-nb7-a0jh.js";import{L as x}from"./CodeLoadToProject.vue_vue_type_script_setup_true_lang-51yJt-l_.js";import{C as K}from"./CodeGenerationService-8YLzxRT5.js";import{_ as R}from"./TableEditor.vue_vue_type_script_setup_true_lang-mL7e02dY.js";import"./Columns.vue_vue_type_script_setup_true_lang-xyZEhB1b.js";import"./CodeGeneration-aXynYJsw.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-dsx0k3kj.js";const q=C("span",{class:"text-danger"},"请在数据库中建表。在此界面点击扫描新表，然后在此界面配置表信息后点击提交变更保存数据即可!",-1),H={key:0},J={key:1},P=["onClick"],Q=C("a",{class:"text-danger"},"删除",-1),de=A({name:"LowCode",__name:"Index",setup(W){const a=F({search:{state:!1,vm:{tableName:void 0,entityName:void 0,displayName:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),b=y(),N=y(),h=y(),T=y();I(()=>{r()});async function r(){a.loading=!0;const l=await x.findList(a.page,a.size,a.search.vm,a.search.sort);a.loading=!1,l.code==200&&(a.page=l.data.page,a.size=l.data.size,a.total=l.data.total,a.columns=l.data.columns,a.data=l.data.dataSource)}async function w(l){var p;let o=[];if(l?o.push(l):o=((p=b.value)==null?void 0:p.getSelectedRowKeys())??[],o.length==0)return g.message.error("请选择要删除的行!");a.loading=!0;const m=await x.deleteList(o);a.loading=!1,m.code==200&&(g.message.success("删除成功!"),r())}function $(){x.synchronization().then(l=>{g.message.success("同步成功!"),r()})}function S(){x.change(a.data).then(l=>{g.message.success("数据变更成功!"),r()})}function U(){var l;(l=T.value)==null||l.open()}return(l,o)=>{const m=i("a-input"),p=i("a-form-item"),_=i("a-col"),u=i("a-button"),L=i("a-space"),B=i("a-row"),D=i("a-form"),v=i("a-popconfirm"),f=i("a-table-column"),E=i("a-divider");return k(),V(M,null,{describe:t(()=>[q]),default:t(()=>[e(G,{ref_key:"refTableCurd",ref:b,config:a,onChange:o[10]||(o[10]=n=>{a.page=n.pagination.current??1,a.size=n.pagination.pageSize??a.size,a.search.sort=n.sorter instanceof Array?[...n.sorter]:[n.sorter],r()}),onShowSizeChange:o[11]||(o[11]=({current:n,size:s})=>{a.page=n==0?1:n,a.size=s,r()})},{search:t(()=>[e(D,{ref_key:"refSearchForm",ref:h,model:a.search.vm},{default:t(()=>[e(B,{gutter:[16,0]},{default:t(()=>[e(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[e(p,{class:"mb-0",name:"tableName",label:"表名称"},{default:t(()=>[e(m,{value:a.search.vm.tableName,"onUpdate:value":o[0]||(o[0]=n=>a.search.vm.tableName=n),placeholder:"表名称"},null,8,["value"])]),_:1})]),_:1}),e(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[e(p,{class:"mb-0",name:"entityName",label:"实体名称"},{default:t(()=>[e(m,{value:a.search.vm.entityName,"onUpdate:value":o[1]||(o[1]=n=>a.search.vm.entityName=n),placeholder:"实体名称"},null,8,["value"])]),_:1})]),_:1}),e(_,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[e(p,{class:"mb-0",name:"displayName",label:"显示名称"},{default:t(()=>[e(m,{value:a.search.vm.displayName,"onUpdate:value":o[2]||(o[2]=n=>a.search.vm.displayName=n),placeholder:"显示名称"},null,8,["value"])]),_:1})]),_:1}),e(_,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[e(L,{size:8},{default:t(()=>[e(u,{onClick:o[3]||(o[3]=n=>{var s;a.page=1,(s=h.value)==null||s.resetFields(),r()})},{default:t(()=>[d(" 重置 ")]),_:1}),e(u,{type:"primary",onClick:o[4]||(o[4]=n=>{a.page=1,r()})},{default:t(()=>[d(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),"toolbar-left":t(()=>[e(u,{onClick:o[5]||(o[5]=n=>a.search.state=!a.search.state)},{default:t(()=>[a.search.state?(k(),z("div",H,[e(c,{name:"UpOutlined"}),d("  收起")])):(k(),z("div",J,[e(c,{name:"DownOutlined"}),d("  展开")]))]),_:1}),e(v,{title:"您确定要更新表吗?可能会导致数据丢失",onConfirm:o[6]||(o[6]=n=>$()),okText:"确定",cancelText:"取消"},{default:t(()=>[e(u,{type:"primary"},{icon:t(()=>[e(c,{name:"scan-outlined"})]),default:t(()=>[d(" 扫描新表 ")]),_:1})]),_:1}),e(v,{title:"您确定要提交更改?",onConfirm:o[7]||(o[7]=n=>S()),okText:"确定",cancelText:"取消"},{default:t(()=>[e(u,{type:"primary"},{icon:t(()=>[e(c,{name:"check-outlined"})]),default:t(()=>[d(" 提交变更 ")]),_:1})]),_:1}),e(u,{type:"primary",onClick:o[8]||(o[8]=()=>j(K).createDataDictionary())},{icon:t(()=>[e(c,{name:"cloud-download-outlined"})]),default:t(()=>[d(" 下载数据库表设计 ")]),_:1}),e(v,{title:"您确定要删除?",onConfirm:o[9]||(o[9]=n=>w()),okText:"确定",cancelText:"取消"},{default:t(()=>[e(u,{type:"primary",danger:""},{icon:t(()=>[e(c,{name:"DeleteOutlined"})]),default:t(()=>[d(" 批量删除 ")]),_:1})]),_:1}),e(u,{type:"primary",onClick:U},{icon:t(()=>[e(c,{name:"AppstoreAddOutlined"})]),default:t(()=>[d(" 在线建表 ")]),_:1})]),"toolbar-right":t(()=>[]),"table-col":t(()=>[e(f,{title:"表名称","data-index":"tableName"}),e(f,{title:"显示名称","data-index":"displayName"},{default:t(({record:n})=>[e(m,{value:n.displayName,"onUpdate:value":s=>n.displayName=s},null,8,["value","onUpdate:value"])]),_:1}),e(f,{title:"实体名称","data-index":"entityName"},{default:t(({record:n})=>[e(m,{value:n.entityName,"onUpdate:value":s=>n.entityName=s},null,8,["value","onUpdate:value"])]),_:1}),e(f,{title:"备注","data-index":"remark"},{default:t(({record:n})=>[e(m,{value:n.remark,"onUpdate:value":s=>n.remark=s},null,8,["value","onUpdate:value"])]),_:1}),e(f,{title:"更新时间","data-index":"lastModificationTime",width:"120px"}),e(f,{title:"创建时间","data-index":"creationTime",width:"120px"}),e(f,{title:"操作","data-index":"id"},{default:t(({record:n})=>[C("a",{href:"javascript:;",onClick:()=>{var s;return(s=N.value)==null?void 0:s.open(n)}},"配置",8,P),e(E,{type:"vertical"}),e(v,{title:"您确定要删除?",onConfirm:s=>w(n.id),okText:"确定",cancelText:"取消"},{default:t(()=>[Q]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["config"]),e(O,{ref_key:"refInfo",ref:N,onSuccess:()=>r()},null,8,["onSuccess"]),e(R,{ref_key:"refTableEditor",ref:T},null,512)]),_:1})}}});export{de as default};
