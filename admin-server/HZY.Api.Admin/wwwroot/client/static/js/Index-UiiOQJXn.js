import{d as U,r as K,b_ as P,b as h,e as R,T as b,f as s,o as r,l as p,w as a,a as e,u as l,j as m,B as f,c as g,t as B,c6 as E,g as q}from"./index-C9oHGpmd.js";import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-o_ph5tPH.js";import{_ as H}from"./Info.vue_vue_type_script_setup_true_lang-Q_m0Unhk.js";import{_ as Q}from"./PageContainer.vue_vue_type_script_setup_true_lang-w--qcJ6v.js";import{_ as W}from"./TableCurd.vue_vue_type_script_setup_true_lang-nb7-a0jh.js";import{S as w}from"./SysMenuService-bO_TQrmD.js";import{_ as X}from"./GlobalNameJson.vue_vue_type_script_setup_true_lang-PCIs1ys2.js";import"./AppIconList-sWATNq9S.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./ColumnSetting.vue_vue_type_script_setup_true_lang-dsx0k3kj.js";const Z={key:0},ee={key:1},te=["onClick"],ae=["onClick"],ne=["onClick"],oe=q("a",{class:"text-danger"},"删除",-1),ye=U({name:"system_menu",__name:"Index",setup(se){const n=K({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),d=P(),S=h(),k=h(),M=h(),T=h();R(()=>{_()});async function _(){try{n.loading=!0;const i=await w.getAll(n.search.vm);if(n.loading=!1,i.code!=200)return;n.data=b.genTreeData(i.data,null)}catch{n.loading=!1}}async function D(i){var x;let o=[];if(i?o.push(i):o=((x=S.value)==null?void 0:x.getSelectedRowKeys())??[],o.length==0)return b.message.error("请选择要删除的行!");try{n.loading=!0;const C=await w.deleteList(o);if(n.loading=!1,C.code!=200)return;b.message.success("删除成功!"),_()}catch{n.loading=!1}}function I(){w.exportExcel(n.search.vm,n.search.sort)}async function J(i){n.loading=!0;const o=await w.copyMenu(i);n.loading=!1,o.code==200&&(b.message.success("复制成功!"),_())}function O(){var i;(i=T.value)==null||i.open()}return(i,o)=>{const x=s("a-input"),C=s("a-form-item"),N=s("a-col"),y=s("a-button"),V=s("a-space"),A=s("a-row"),F=s("a-form"),Y=s("a-popconfirm"),z=s("a-menu-item"),G=s("a-menu"),L=s("a-dropdown"),u=s("a-table-column"),$=s("a-divider");return r(),p(Q,null,{default:a(()=>[e(W,{ref_key:"refTableCurd",ref:S,config:n,onChange:o[8]||(o[8]=t=>{n.page=t.pagination.current??1,n.size=t.pagination.pageSize??n.size,n.search.sort=t.sorter instanceof Array?[...t.sorter]:[t.sorter],_()}),onShowSizeChange:o[9]||(o[9]=({current:t,size:c})=>{n.page=t==0?1:t,n.size=c,_()}),"is-pagination":!1},{search:a(()=>[l(d).search?(r(),p(F,{key:0,ref_key:"refSearchForm",ref:M,model:n.search.vm},{default:a(()=>[e(A,{gutter:[16,0]},{default:a(()=>[e(N,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[e(C,{class:"mb-0",name:"name",label:"菜单名称"},{default:a(()=>[e(x,{value:n.search.vm.name,"onUpdate:value":o[0]||(o[0]=t=>n.search.vm.name=t),placeholder:"菜单名称"},null,8,["value"])]),_:1})]),_:1}),e(N,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:a(()=>[e(V,{size:8},{default:a(()=>[e(y,{onClick:o[1]||(o[1]=t=>{var c;n.page=1,(c=M.value)==null||c.resetFields(),_()})},{default:a(()=>[m(" 重置 ")]),_:1}),e(y,{type:"primary",onClick:o[2]||(o[2]=t=>{n.page=1,_()})},{default:a(()=>[m(" 查询 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):f("",!0)]),"toolbar-left":a(()=>[l(d).search?(r(),p(y,{key:0,onClick:o[3]||(o[3]=t=>n.search.state=!n.search.state)},{default:a(()=>[n.search.state?(r(),g("div",Z,[e(v,{name:"UpOutlined"}),m("  收起 ")])):(r(),g("div",ee,[e(v,{name:"DownOutlined"}),m("  展开 ")]))]),_:1})):f("",!0),l(d).insert?(r(),p(y,{key:1,type:"primary",onClick:o[4]||(o[4]=()=>{var t;return(t=k.value)==null?void 0:t.open()})},{icon:a(()=>[e(v,{name:"PlusOutlined"})]),default:a(()=>[m(" 新建 ")]),_:1})):f("",!0),l(d).delete?(r(),p(Y,{key:2,title:"您确定要删除?",onConfirm:o[5]||(o[5]=t=>D()),okText:"确定",cancelText:"取消"},{default:a(()=>[e(y,{type:"primary",danger:""},{icon:a(()=>[e(v,{name:"DeleteOutlined"})]),default:a(()=>[m(" 批量删除 ")]),_:1})]),_:1})):f("",!0)]),"toolbar-right":a(()=>[e(L,null,{overlay:a(()=>[e(G,null,{default:a(()=>[e(z,{key:"1",onClick:o[6]||(o[6]=t=>I())},{default:a(()=>[m("导出 Excel")]),_:1}),e(z,{key:"2",onClick:o[7]||(o[7]=t=>O())},{default:a(()=>[m("打开国际化Json")]),_:1})]),_:1})]),default:a(()=>[e(y,null,{default:a(()=>[m(" 更多 "),e(v,{name:"ellipsis-outlined"})]),_:1})]),_:1})]),"table-col":a(()=>[e(u,{title:"名称","data-index":"name"}),e(u,{title:"图标","data-index":"icon"},{default:a(({record:t})=>[e(v,{name:t.icon},null,8,["name"])]),_:1}),e(u,{title:"编号","data-index":"number"}),e(u,{title:"组件名称","data-index":"componentName"}),e(u,{title:"组件地址","data-index":"url"}),e(u,{title:"路由地址","data-index":"router"}),e(u,{title:"更新时间","data-index":"lastModificationTime"},{default:a(({record:t})=>[m(B(l(E)(t.lastModificationTime).format("YYYY-MM-DD")),1)]),_:1}),e(u,{title:"创建时间","data-index":"creationTime"},{default:a(({record:t})=>[m(B(l(E)(t.creationTime).format("YYYY-MM-DD")),1)]),_:1}),l(d).update||l(d).delete||l(d).insert?(r(),p(u,{key:0,title:"操作","data-index":"id"},{default:a(({record:t})=>[l(d).insert?(r(),g("a",{key:0,href:"javascript:void(0)",onClick:c=>{var j;return(j=k.value)==null?void 0:j.open(null,t.id)}},"新建",8,te)):f("",!0),e($,{type:"vertical"}),l(d).update?(r(),g("a",{key:1,href:"javascript:;",onClick:()=>{var c;return(c=k.value)==null?void 0:c.open(t.id,t.parentId)}},"编辑",8,ae)):f("",!0),e($,{type:"vertical"}),l(d).update?(r(),g("a",{key:2,href:"javascript:;",onClick:()=>J(t.id)},"复制",8,ne)):f("",!0),e($,{type:"vertical"}),l(d).delete?(r(),p(Y,{key:3,title:"您确定要删除?",onConfirm:c=>D(t.id),okText:"确定",cancelText:"取消"},{default:a(()=>[oe]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["config"]),e(H,{ref_key:"refInfo",ref:k,onSuccess:()=>_()},null,8,["onSuccess"]),e(X,{ref_key:"refGlobalNameJson",ref:T},null,512)]),_:1})}}});export{ye as default};
