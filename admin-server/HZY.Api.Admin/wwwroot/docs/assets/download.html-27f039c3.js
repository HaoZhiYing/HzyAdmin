import{_ as n,o as s,c as a,a as t}from"./app-4f4af2d5.js";const p={},o=t(`<h1 id="前端下载文件注意事项" tabindex="-1"><a class="header-anchor" href="#前端下载文件注意事项" aria-hidden="true">#</a> 前端下载文件注意事项</h1><blockquote><p>如果前端下载没有名称，需要通过一下方式在后端返回文件流时，设置文件名称</p></blockquote><h2 id="后端返回文件流" tabindex="-1"><a class="header-anchor" href="#后端返回文件流" aria-hidden="true">#</a> 后端返回文件流</h2><blockquote><p>HttpContext.DownLoadFile(data, Tools.GetFileContentType[&quot;.xls&quot;].ToStr(), name);</p></blockquote><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// 导出Excel</span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>summary</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pagingSearchInput<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param</span><span class="token punctuation">&gt;</span></span></span>
<span class="token doc-comment comment">/// <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>returns</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>returns</span><span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">[</span><span class="token function">ApiResourceCacheFilter</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ActionDescriptor</span><span class="token attribute-arguments"><span class="token punctuation">(</span>PermissionFunctionConsts<span class="token punctuation">.</span>Function_Export<span class="token punctuation">,</span> DisplayName <span class="token operator">=</span> <span class="token string">&quot;导出数据&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">HttpPost</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">ExportExcelAsync</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FromBody</span></span><span class="token punctuation">]</span> <span class="token class-name">PagingSearchInput<span class="token punctuation">&lt;</span>Member<span class="token punctuation">&gt;</span></span> pagingSearchInput<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> data <span class="token operator">=</span> <span class="token keyword">await</span> _defaultService<span class="token punctuation">.</span><span class="token function">ExportExcelAsync</span><span class="token punctuation">(</span>pagingSearchInput<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name"><span class="token keyword">var</span></span> name <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">$&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">PermissionUtil<span class="token punctuation">.</span><span class="token function">GetControllerDisplayName</span><span class="token punctuation">(</span><span class="token function">GetType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">列表数据 </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp">DateTime<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span></span><span class="token string">.xls&quot;</span></span><span class="token punctuation">;</span>
    HttpContext<span class="token punctuation">.</span><span class="token function">DownLoadFile</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> Tools<span class="token punctuation">.</span>GetFileContentType<span class="token punctuation">[</span><span class="token string">&quot;.xls&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),e=[o];function c(l,u){return s(),a("div",null,e)}const k=n(p,[["render",c],["__file","download.html.vue"]]);export{k as default};
