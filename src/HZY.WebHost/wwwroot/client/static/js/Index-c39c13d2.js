import{_ as j,b as P,r as M,K as q,a as O,i as G,I as S,o as H,c as i,j as d,d as w,f as n,w as a,e as T,l as r,q as v,A as x,C as m,F as z,x as J,n as u,g as Q,h as W,aV as B,t as I}from"./index-fb834bef.js";import X from"./List-252f7c02.js";import Y from"./Info-e1d6f50f.js";import{o as Z}from"./organizationService-71817d40.js";const ee=y=>(Q("data-v-64fcc224"),y=y(),W(),y),te=u("\u67E5\u8BE2"),ae=u("\u91CD\u7F6E"),ne=u(" \u65B0\u5EFA "),oe=u(" \u6279\u91CF\u5220\u9664 "),se=u(" \u5E26\u56DE\u6570\u636E "),le=u("\u5BFC\u51FA Excel"),re=u(" \u66F4\u591A\u64CD\u4F5C "),ie=u("\u91CD\u7F6E"),de=u(" \u68C0\u7D22 "),ce=["onClick"],ue=ee(()=>T("a",{class:"text-danger"},"\u5220\u9664",-1)),pe={name:"system_user"},me=Object.assign(pe,{props:{isFindBack:{type:Boolean,default(){return!1}},defaultRowIds:Array,type:{type:Boolean,default(){return!0}}},emits:["onChange"],setup(y,{emit:$}){const f=y,N=P(),e=M({search:{state:!1,vm:{name:null,loginName:null,organizationId:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,columns:[],data:[],tree:{data:[],expandedKeys:[],selectedKeys:[],loadingTree:!1},findBack:{defaultRowIds:q(()=>f.defaultRowIds)}}),R=O(null),k=O(null),_=N.getPowerByMenuId(G.currentRoute.value.meta.menuId),s={onChange(o){const{currentPage:t,pageSize:c}=o;e.page=t==0?1:t,e.rows=c,s.findList()},onResetSearch(){e.page=1;let o=e.search.vm;for(let t in o)o[t]=null;s.findList()},findList(){e.loading=!0,B.findList(e.rows,e.page,e.search.vm).then(o=>{let t=o.data;e.loading=!1,e.page=t.page,e.rows=t.size,e.total=t.total,e.columns=t.columns,e.data=t.dataSource,s.findBack.setCheckboxRow()})},deleteList(o){let t=[];o?t.push(o):t=k.value.table.getCheckboxRecords().map(c=>c.id),B.deleteList(t).then(c=>{c.code==1&&(I.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),s.findList())})},openForm(o){if(!o&&!e.search.vm.organizationId)return I.message("\u8BF7\u9009\u62E9\u7EC4\u7EC7!","\u8B66\u544A");R.value.openForm({visible:!0,key:o,organizationId:e.search.vm.organizationId})},exportExcel(){B.exportExcel(e.search.vm)},sysOrganizationTree(){e.tree.loadingTree=!0,Z.sysOrganizationTree().then(o=>{e.tree.loadingTree=!1;let t=o.data;e.tree.data=t.rows,e.tree.expandedKeys=t.expandedRowKeys,s.findList()})},getFirst(){e.tree.selectedKeys=[]},findBack:{initRows(){!f.isFindBack||S(()=>f.defaultRowIds,o=>{s.findBack.setCheckboxRow()})},setCheckboxRow(){!f.isFindBack||(k.value.table.setAllCheckboxRow(!1),k.value.table.setCheckboxRow(s.findBack.getRowsByIds(e.findBack.defaultRowIds),!0))},onChange(){if(!!f.isFindBack){var o=k.value.table.getCheckboxRecords();if(f.type&&o.length>1)return I.message("\u53EA\u80FD\u9009\u62E9\u4E00\u6761\u6570\u636E!","\u8B66\u544A");$("onChange",k.value.table.getCheckboxRecords())}},getRowsByIds(o){if(!!f.isFindBack){var t=[],c=e.data;for(let h=0;h<c.length;h++){const C=c[h];o.filter(g=>g==C.id).length>0&&t.push(C)}return t}}}};return s.findBack.initRows(),S(()=>e.tree.selectedKeys,o=>{e.search.vm.organizationId=o.length>0?o[0]:null,s.findList()}),H(()=>{s.sysOrganizationTree()}),(o,t)=>{const c=i("a-tree"),h=i("a-spin"),C=i("a-card"),g=i("a-col"),b=i("a-input"),p=i("a-button"),F=i("a-row"),K=i("a-popconfirm"),U=i("a-menu-item"),V=i("a-menu"),A=i("a-dropdown"),L=i("vxe-column"),D=i("a-divider");return d(),w("div",null,[n(F,{gutter:[15,15]},{default:a(()=>[n(g,{xs:24,sm:12,md:12,lg:5,xl:5},{default:a(()=>[n(C,{title:"\u7EC4\u7EC7\u67B6\u6784",class:"w100 mb-15 min-height"},{extra:a(()=>[T("a",{href:"javascript:void(0)",onClick:t[0]||(t[0]=(...l)=>s.getFirst&&s.getFirst(...l))},"\u67E5\u770B\u4E00\u7EA7")]),default:a(()=>[n(h,{spinning:r(e).tree.loadingTree},{default:a(()=>[n(c,{expandedKeys:r(e).tree.expandedKeys,"onUpdate:expandedKeys":t[1]||(t[1]=l=>r(e).tree.expandedKeys=l),selectedKeys:r(e).tree.selectedKeys,"onUpdate:selectedKeys":t[2]||(t[2]=l=>r(e).tree.selectedKeys=l),"tree-data":r(e).tree.data},null,8,["expandedKeys","selectedKeys","tree-data"])]),_:1},8,["spinning"])]),_:1})]),_:1}),n(g,{xs:24,sm:12,md:12,lg:19,xl:19},{default:a(()=>[n(X,{ref_key:"refList",ref:k,tableData:r(e),onOnChange:s.onChange},{search:a(()=>[n(F,{gutter:[15,15]},{default:a(()=>[n(g,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[n(b,{value:r(e).search.vm.name,"onUpdate:value":t[3]||(t[3]=l=>r(e).search.vm.name=l),placeholder:"\u771F\u5B9E\u540D\u79F0"},null,8,["value"])]),_:1}),n(g,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[n(b,{value:r(e).search.vm.loginName,"onUpdate:value":t[4]||(t[4]=l=>r(e).search.vm.loginName=l),placeholder:"\u8D26\u6237\u540D\u79F0"},null,8,["value"])]),_:1}),n(g,{xs:24,sm:12,md:8,lg:6,xl:6,style:{float:"right"}},{default:a(()=>[n(p,{type:"primary",class:"mr-15",onClick:s.findList},{default:a(()=>[te]),_:1},8,["onClick"]),n(p,{class:"mr-15",onClick:s.onResetSearch},{default:a(()=>[ae]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":a(()=>[r(_).insert&&!o.$props.isFindBack?(d(),v(p,{key:0,type:"primary",onClick:t[5]||(t[5]=l=>s.openForm())},{icon:a(()=>[n(x,{name:"PlusOutlined"})]),default:a(()=>[ne]),_:1})):m("",!0),r(_).delete&&!o.$props.isFindBack?(d(),v(K,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:t[6]||(t[6]=l=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[n(p,{type:"danger"},{icon:a(()=>[n(x,{name:"DeleteOutlined"})]),default:a(()=>[oe]),_:1})]),_:1})):m("",!0),o.$props.isFindBack?(d(),v(p,{key:2,type:"primary",onClick:t[7]||(t[7]=l=>s.findBack.onChange())},{icon:a(()=>[n(x,{name:"CheckOutlined"})]),default:a(()=>[se]),_:1})):m("",!0),n(A,null,{overlay:a(()=>[n(V,null,{default:a(()=>[n(U,{key:"1",onClick:s.exportExcel},{default:a(()=>[le]),_:1},8,["onClick"])]),_:1})]),default:a(()=>[n(p,null,{default:a(()=>[re,n(x,{name:"DownOutlined"})]),_:1})]),_:1})]),"toolbar-right":a(()=>[n(b,{value:r(e).search.vm.name,"onUpdate:value":t[8]||(t[8]=l=>r(e).search.vm.name=l),placeholder:"\u540D\u79F0",onKeyup:s.findList},null,8,["value","onKeyup"]),n(p,{onClick:s.onResetSearch},{default:a(()=>[ie]),_:1},8,["onClick"]),r(_).search?(d(),v(p,{key:0,onClick:t[9]||(t[9]=l=>r(e).search.state=!r(e).search.state)},{icon:a(()=>[n(x,{name:r(e).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:a(()=>[de]),_:1})):m("",!0)]),"table-col-default":a(()=>[(d(!0),w(z,null,J(r(e).columns,l=>(d(),w(z,null,[l.fieldName!="id"?(d(),v(L,{field:l.fieldName,title:l.title,visible:l.show,key:l.id},null,8,["field","title","visible"])):m("",!0)],64))),256)),(r(_).update||r(_).delete)&&!o.$props.isFindBack?(d(),v(L,{key:0,field:"id",title:"\u64CD\u4F5C"},{default:a(({row:l})=>[r(_).update?(d(),w("a",{key:0,href:"javascript:void(0)",onClick:E=>s.openForm(l.id)},"\u7F16\u8F91",8,ce)):m("",!0),n(D,{type:"vertical"}),r(_).delete?(d(),v(K,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:E=>s.deleteList(l.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[ue]),_:2},1032,["onConfirm"])):m("",!0)]),_:1})):m("",!0)]),_:1},8,["tableData","onOnChange"])]),_:1})]),_:1}),n(Y,{ref_key:"refForm",ref:R,onOnSuccess:t[10]||(t[10]=()=>s.findList())},null,512)])}}});var ke=j(me,[["__scopeId","data-v-64fcc224"]]);export{ke as default};
