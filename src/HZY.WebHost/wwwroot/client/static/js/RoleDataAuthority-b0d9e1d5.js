var T=Object.defineProperty;var v=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var K=(e,t,s)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,f=(e,t)=>{for(var s in t||(t={}))E.call(t,s)&&K(e,s,t[s]);if(v)for(var s of v(t))I.call(t,s)&&K(e,s,t[s]);return e};import{p as m,t as c,d as x,f as F,_ as B}from"./index-ea35a67a.js";import{o as R}from"./organizationService-90cd6248.js";import{d as S,s as z,w as A,u as O,f as r,q as k,j as U,m as a,y as n,v as H,x as _,A as N,B as d}from"./vendor-e651fafa.js";const i="admin/SysDataAuthority";var $={findList(e,t,s={}){return m(`${i}/findList/${e}/${t}`,s,!1)},deleteList(e){return console.log(e),e&&e.length===0?c.message("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u6570\u636E!","\u8B66\u544A"):m(`${i}/deleteList`,e,!1)},findForm(e){return x(`${i}/findForm${e?"/"+e:""}`)},saveForm(e){return m(`${i}/saveForm`,e)},exportExcel(e){return F(`${i}/exportExcel`,e)},getDataAuthorityByRoleId(e){return x(`${i}/getDataAuthorityByRoleId/${e}`)}};const V=S({name:"RoleDataAuthorityCom",setup(){const e=z({roleId:"",loading:!1,visible:!1,form:{sysDataAuthority:{},sysDataAuthorityCustomList:[]},selectAll:!1,expandedAll:!1,tree:{data:[],expandedKeys:[],selectedKeys:[],checkedKeys:[],allKeys:[],allExpandedKeys:[],loadingTree:!1}}),t={openWindow({visible:s,key:l}){e.visible=s,e.roleId=l,this.findForm()},findForm(){e.saveLoading=!0,$.getDataAuthorityByRoleId(e.roleId).then(s=>{e.saveLoading=!1,s.code==1&&(e.form=s.data,e.form.sysDataAuthority.roleId=e.roleId,this.sysOrganizationTree())})},sysOrganizationTree(){e.tree.loadingTree=!0,e.tree.checkedKeys=[],R.sysOrganizationTree().then(s=>{e.tree.loadingTree=!1;let l=s.data;e.tree.data=l.rows,e.tree.expandedKeys=l.expandedRowKeys,e.tree.allKeys=l.allKeys,e.tree.allExpandedKeys=l.expandedRowKeys;var y=e.form.sysDataAuthorityCustomList;for(let h=0;h<y.length;h++){const u=y[h];e.tree.checkedKeys.push(u.sysOrganizationId)}e.selectAll=e.tree.checkedKeys.length==e.tree.allKeys.length,e.expandedAll=e.tree.expandedKeys.length==e.tree.allExpandedKeys.length})},saveForm(){if(e.form.sysDataAuthority.permissionType===1){var s=e.tree.checkedKeys;e.form.sysDataAuthorityCustomList=[];for(let l=0;l<s.length;l++){const y=s[l];e.form.sysDataAuthorityCustomList.push({sysOrganizationId:y})}}else e.form.sysDataAuthorityCustomList=[];$.saveForm(e.form).then(l=>{if(l.code!=1)return c.message("\u4FDD\u5B58\u5931\u8D25!","\u9519\u8BEF");c.message("\u4FDD\u5B58\u6210\u529F!","\u6210\u529F")})},onSelectAll(){e.selectAll?e.tree.checkedKeys=e.tree.allKeys:e.tree.checkedKeys=[]},onExpandedAll(){e.expandedAll?e.tree.expandedKeys=e.tree.allExpandedKeys:e.tree.expandedKeys=[]}};return A(()=>e.tree.checkedKeys,s=>{console.log("checkedKeys",s),e.selectAll=s.length==e.tree.allKeys.length}),A(()=>e.tree.expandedKeys,s=>{e.expandedAll=s.length==e.tree.allExpandedKeys.length}),f(f({},O(e)),t)}}),j=d("\u63D0\u4EA4"),q=d("\u5173\u95ED"),W=d("\u81EA\u5B9A\u4E49\u6743\u9650"),Y=d("\u67E5\u770B\u6240\u6709\u6570\u636E"),G=d("\u4EC5\u67E5\u770B\u672C\u7EC4\u7EC7"),J=d("\u4EC5\u67E5\u770B\u672C\u7EC4\u7EC7\u548C\u4E0B\u5C5E\u7EC4\u7EC7"),M=d("\u4EC5\u67E5\u770B\u672C\u4EBA"),P={key:0},Q=d("\u81EA\u5B9A\u4E49\u6570\u636E\u6743\u9650"),X={class:"mb-15"},Z=d("\u5168\u9009/\u5168\u4E0D\u9009"),ee=d("\u5C55\u5F00/\u6298\u53E0"),te={style:{"max-height":"280px","overflow-y":"auto"}};function se(e,t,s,l,y,h){const u=r("a-button"),p=r("a-radio"),D=r("a-radio-group"),b=r("a-divider"),g=r("a-checkbox"),C=r("a-tree"),L=r("a-spin"),w=r("a-modal");return k(),U(w,{visible:e.visible,"onUpdate:visible":t[9]||(t[9]=o=>e.visible=o),title:"\u6570\u636E\u6743\u9650\u8BBE\u7F6E",centered:"",onOk:t[10]||(t[10]=o=>e.visible=!1),width:400,bodyStyle:{overflowY:"auto",height:"calc(100vh - 300px)"}},{footer:a(()=>[n(u,{type:"primary",onClick:t[0]||(t[0]=o=>e.saveForm()),loading:e.saveLoading},{default:a(()=>[j]),_:1},8,["loading"]),n(u,{type:"danger",ghost:"",onClick:t[1]||(t[1]=o=>e.visible=!1),class:"ml-15"},{default:a(()=>[q]),_:1})]),default:a(()=>[n(L,{spinning:e.loading},{default:a(()=>[n(D,{value:e.form.sysDataAuthority.permissionType,"onUpdate:value":t[2]||(t[2]=o=>e.form.sysDataAuthority.permissionType=o)},{default:a(()=>[n(p,{style:{display:"flex",height:"30px",lineHeight:"30px"},value:1},{default:a(()=>[W]),_:1}),n(p,{style:{display:"flex",height:"30px",lineHeight:"30px"},value:2},{default:a(()=>[Y]),_:1}),n(p,{style:{display:"flex",height:"30px",lineHeight:"30px"},value:3},{default:a(()=>[G]),_:1}),n(p,{style:{display:"flex",height:"30px",lineHeight:"30px"},value:4},{default:a(()=>[J]),_:1}),n(p,{style:{display:"flex",height:"30px",lineHeight:"30px"},value:5},{default:a(()=>[M]),_:1})]),_:1},8,["value"]),e.form.sysDataAuthority.permissionType===1?(k(),H("div",P,[n(b,null,{default:a(()=>[Q]),_:1}),_("div",X,[n(g,{checked:e.selectAll,"onUpdate:checked":t[3]||(t[3]=o=>e.selectAll=o),onChange:t[4]||(t[4]=o=>e.onSelectAll())},{default:a(()=>[Z]),_:1},8,["checked"]),n(g,{checked:e.expandedAll,"onUpdate:checked":t[5]||(t[5]=o=>e.expandedAll=o),onChange:t[6]||(t[6]=o=>e.onExpandedAll())},{default:a(()=>[ee]),_:1},8,["checked"])]),_("div",te,[n(C,{expandedKeys:e.tree.expandedKeys,"onUpdate:expandedKeys":t[7]||(t[7]=o=>e.tree.expandedKeys=o),checkedKeys:e.tree.checkedKeys,"onUpdate:checkedKeys":t[8]||(t[8]=o=>e.tree.checkedKeys=o),checkable:"","tree-data":e.tree.data},null,8,["expandedKeys","checkedKeys","tree-data"])])])):N("",!0)]),_:1},8,["spinning"])]),_:1},8,["visible","bodyStyle"])}var de=B(V,[["render",se]]);export{de as default};
