import{d as $,y as q,a4 as K,C as h,q as R,r as u,o as s,e as c,w as t,a,u as m,i,l as g,c as v,j as G,t as H,F as J,f as Q,m as z}from"./index-07368c36.js";import{_ as y}from"./AppIcon.vue_vue_type_script_setup_true_lang-66731724.js";import{S as A,_ as W}from"./Info.vue_vue_type_script_setup_true_lang-c6405c7a.js";import{_ as X}from"./PageContainer.vue_vue_type_script_setup_true_lang-660ebdad.js";import{_ as Y}from"./TableCurd.vue_vue_type_script_setup_true_lang-e38ba039.js";const Z={key:0},ee={key:1},te=["onClick"],ae=Q("a",{class:"text-danger"},"\u5220\u9664",-1),oe=$({name:"system_post"}),ce=$({...oe,setup(ne){const e=q({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),d=K(),B=h(),C=h(),w=h();R(()=>{_()});async function _(){try{e.loading=!0;const l=await A.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,l.code!=1)return;e.page=l.data.page,e.size=l.data.size,e.total=l.data.total,e.columns=l.data.columns,e.data=l.data.dataSource}catch{e.loading=!1}}async function E(l){var x,F;let n=[];if(l?n.push(l):n=(F=(x=B.value)==null?void 0:x.getSelectedRowKeys())!=null?F:[],n.length==0)return z.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{e.loading=!0;const k=await A.deleteList(n);if(e.loading=!1,k.code!=1)return;z.message.success("\u5220\u9664\u6210\u529F!"),_()}catch{e.loading=!1}}function T(){A.exportExcel(e.search.vm,e.search.sort)}return(l,n)=>{const x=u("a-input"),F=u("a-form-item"),k=u("a-col"),f=u("a-button"),L=u("a-space"),N=u("a-row"),O=u("a-form"),D=u("a-popconfirm"),U=u("a-menu-item"),V=u("a-menu"),j=u("a-dropdown"),I=u("a-checkbox"),M=u("a-popover"),p=u("a-table-column"),S=u("a-tag"),P=u("a-divider");return s(),c(X,null,{default:t(()=>[a(Y,{ref_key:"refTableCurd",ref:B,config:e,onChange:n[7]||(n[7]=o=>{var r,b;e.page=(r=o.pagination.current)!=null?r:1,e.size=(b=o.pagination.pageSize)!=null?b:e.size,e.search.sort=o.sorter instanceof Array?[...o.sorter]:[o.sorter],_()}),onShowSizeChange:n[8]||(n[8]=({current:o,size:r})=>{e.page=o==0?1:o,e.size=r,_()})},{search:t(()=>[m(d).search?(s(),c(O,{key:0,ref_key:"refSearchForm",ref:w,model:e.search.vm},{default:t(()=>[a(N,{gutter:[16,0]},{default:t(()=>[a(k,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[a(F,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:t(()=>[a(x,{value:e.search.vm.name,"onUpdate:value":n[0]||(n[0]=o=>e.search.vm.name=o),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),a(k,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[a(L,{size:8},{default:t(()=>[a(f,{onClick:n[1]||(n[1]=o=>{var r;e.page=1,(r=w.value)==null||r.resetFields(),_()})},{default:t(()=>[i(" \u91CD\u7F6E ")]),_:1}),a(f,{type:"primary",onClick:n[2]||(n[2]=o=>{e.page=1,_()})},{default:t(()=>[i(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):g("",!0)]),"toolbar-left":t(()=>[m(d).search?(s(),c(f,{key:0,onClick:n[3]||(n[3]=o=>e.search.state=!e.search.state)},{default:t(()=>[e.search.state?(s(),v("div",Z,[a(y,{name:"UpOutlined"}),i("\xA0\xA0\u6536\u8D77")])):(s(),v("div",ee,[a(y,{name:"DownOutlined"}),i("\xA0\xA0\u5C55\u5F00")]))]),_:1})):g("",!0),m(d).insert?(s(),c(f,{key:1,type:"primary",onClick:n[4]||(n[4]=()=>{var o;return(o=C.value)==null?void 0:o.open()})},{icon:t(()=>[a(y,{name:"PlusOutlined"})]),default:t(()=>[i(" \u65B0\u5EFA ")]),_:1})):g("",!0),m(d).delete?(s(),c(D,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:n[5]||(n[5]=o=>E()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[a(f,{type:"primary",danger:""},{icon:t(()=>[a(y,{name:"DeleteOutlined"})]),default:t(()=>[i(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):g("",!0)]),"toolbar-right":t(()=>[a(j,null,{overlay:t(()=>[a(V,null,{default:t(()=>[a(U,{key:"1",onClick:n[6]||(n[6]=o=>T())},{default:t(()=>[i("\u5BFC\u51FA Excel")]),_:1})]),_:1})]),default:t(()=>[a(f,null,{default:t(()=>[i(" \u66F4\u591A "),a(y,{name:"ellipsis-outlined"})]),_:1})]),_:1}),a(M,null,{content:t(()=>[(s(!0),v(J,null,G(e.columns.filter(o=>o.fieldName.substr(0,1)!="_"),o=>(s(),v("div",null,[a(I,{checked:o.show,"onUpdate:checked":r=>o.show=r},{default:t(()=>[i(H(o.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[a(f,{type:"text"},{icon:t(()=>[a(y,{name:"setting-outlined"})]),_:1})]),_:1})]),"table-col":t(()=>[a(p,{title:"\u7F16\u53F7","data-index":"number"}),a(p,{title:"\u5C97\u4F4D\u7F16\u7801","data-index":"code"}),a(p,{title:"\u540D\u79F0","data-index":"name"}),a(p,{title:"\u72B6\u6001","data-index":"state"},{default:t(({record:o})=>[o.state==1?(s(),c(S,{key:0,color:"success"},{default:t(()=>[i("\u6B63\u5E38")]),_:1})):(s(),c(S,{key:1,color:"warning"},{default:t(()=>[i("\u505C\u7528")]),_:1}))]),_:1}),a(p,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),a(p,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),m(d).update||m(d).delete?(s(),c(p,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:t(({record:o})=>[m(d).update?(s(),v("a",{key:0,href:"javascript:;",onClick:()=>{var r;return(r=C.value)==null?void 0:r.open(o.id)}},"\u7F16\u8F91",8,te)):g("",!0),a(P,{type:"vertical"}),m(d).delete?(s(),c(D,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:r=>E(o.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[ae]),_:2},1032,["onConfirm"])):g("",!0)]),_:1})):g("",!0)]),_:1},8,["config"]),a(W,{ref_key:"refInfo",ref:C,onSuccess:()=>_()},null,8,["onSuccess"])]),_:1})}}});export{ce as default};
