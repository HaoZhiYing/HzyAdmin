import{d as z,y as q,a4 as K,C as h,q as P,r as u,o as r,e as f,w as t,a,u as d,i,l as p,c as x,j as R,t as G,F as H,f as J,m as b}from"./index-294e8e84.js";import{_ as v}from"./AppIcon.vue_vue_type_script_setup_true_lang-a041bba6.js";import{S as A,_ as Q}from"./Info.vue_vue_type_script_setup_true_lang-2fb7dab9.js";import{_ as W}from"./PageContainer.vue_vue_type_script_setup_true_lang-b0c3a0a7.js";import{_ as X}from"./TableCurd.vue_vue_type_script_setup_true_lang-c21e52c1.js";const Y={key:0},Z={key:1},ee=["onClick"],te=J("a",{class:"text-danger"},"\u5220\u9664",-1),ae=z({name:"system_function"}),ie=z({...ae,setup(oe){const e=q({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[]}),c=K(),w=h(),C=h(),B=h();P(()=>{m()});async function m(){try{e.loading=!0;const l=await A.findList(e.page,e.size,e.search.vm,e.search.sort);if(e.loading=!1,l.code!=1)return;e.page=l.data.page,e.size=l.data.size,e.total=l.data.total,e.columns=l.data.columns,e.data=l.data.dataSource}catch{e.loading=!1}}async function D(l){var k,F;let n=[];if(l?n.push(l):n=(F=(k=w.value)==null?void 0:k.getSelectedRowKeys())!=null?F:[],n.length==0)return b.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{e.loading=!0;const g=await A.deleteList(n);if(e.loading=!1,g.code!=1)return;b.message.success("\u5220\u9664\u6210\u529F!"),m()}catch{e.loading=!1}}function $(){A.exportExcel(e.search.vm,e.search.sort)}return(l,n)=>{const k=u("a-input"),F=u("a-form-item"),g=u("a-col"),_=u("a-button"),N=u("a-space"),T=u("a-row"),L=u("a-form"),E=u("a-popconfirm"),O=u("a-menu-item"),U=u("a-menu"),V=u("a-dropdown"),j=u("a-checkbox"),I=u("a-popover"),y=u("a-table-column"),M=u("a-divider");return r(),f(W,null,{default:t(()=>[a(X,{ref_key:"refTableCurd",ref:w,config:e,onChange:n[7]||(n[7]=o=>{var s,S;e.page=(s=o.pagination.current)!=null?s:1,e.size=(S=o.pagination.pageSize)!=null?S:e.size,e.search.sort=o.sorter instanceof Array?[...o.sorter]:[o.sorter],m()}),onShowSizeChange:n[8]||(n[8]=({current:o,size:s})=>{e.page=o==0?1:o,e.size=s,m()})},{search:t(()=>[d(c).search?(r(),f(L,{key:0,ref_key:"refSearchForm",ref:B,model:e.search.vm},{default:t(()=>[a(T,{gutter:[16,0]},{default:t(()=>[a(g,{xs:24,sm:12,md:8,lg:6,xl:6},{default:t(()=>[a(F,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:t(()=>[a(k,{value:e.search.vm.name,"onUpdate:value":n[0]||(n[0]=o=>e.search.vm.name=o),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),a(g,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:t(()=>[a(N,{size:8},{default:t(()=>[a(_,{onClick:n[1]||(n[1]=o=>{var s;e.page=1,(s=B.value)==null||s.resetFields(),m()})},{default:t(()=>[i(" \u91CD\u7F6E ")]),_:1}),a(_,{type:"primary",onClick:n[2]||(n[2]=o=>{e.page=1,m()})},{default:t(()=>[i(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):p("",!0)]),"toolbar-left":t(()=>[d(c).search?(r(),f(_,{key:0,onClick:n[3]||(n[3]=o=>e.search.state=!e.search.state)},{default:t(()=>[e.search.state?(r(),x("div",Y,[a(v,{name:"UpOutlined"}),i("\xA0\xA0\u6536\u8D77")])):(r(),x("div",Z,[a(v,{name:"DownOutlined"}),i("\xA0\xA0\u5C55\u5F00")]))]),_:1})):p("",!0),d(c).insert?(r(),f(_,{key:1,type:"primary",onClick:n[4]||(n[4]=()=>{var o;return(o=C.value)==null?void 0:o.open()})},{icon:t(()=>[a(v,{name:"PlusOutlined"})]),default:t(()=>[i(" \u65B0\u5EFA ")]),_:1})):p("",!0),d(c).delete?(r(),f(E,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:n[5]||(n[5]=o=>D()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[a(_,{type:"primary",danger:""},{icon:t(()=>[a(v,{name:"DeleteOutlined"})]),default:t(()=>[i(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):p("",!0)]),"toolbar-right":t(()=>[a(V,null,{overlay:t(()=>[a(U,null,{default:t(()=>[a(O,{key:"1",onClick:n[6]||(n[6]=o=>$())},{default:t(()=>[i("\u5BFC\u51FA Excel")]),_:1})]),_:1})]),default:t(()=>[a(_,null,{default:t(()=>[i(" \u66F4\u591A "),a(v,{name:"ellipsis-outlined"})]),_:1})]),_:1}),a(I,null,{content:t(()=>[(r(!0),x(H,null,R(e.columns.filter(o=>o.fieldName.substr(0,1)!="_"),o=>(r(),x("div",null,[a(j,{checked:o.show,"onUpdate:checked":s=>o.show=s},{default:t(()=>[i(G(o.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[a(_,{type:"text"},{icon:t(()=>[a(v,{name:"setting-outlined"})]),_:1})]),_:1})]),"table-col":t(()=>[a(y,{title:"\u7F16\u53F7","data-index":"number"}),a(y,{title:"\u540D\u79F0","data-index":"name"}),a(y,{title:"\u82F1\u6587\u540D\u79F0","data-index":"byName"}),a(y,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),a(y,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),d(c).update||d(c).delete?(r(),f(y,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:t(({record:o})=>[d(c).update?(r(),x("a",{key:0,href:"javascript:;",onClick:()=>{var s;return(s=C.value)==null?void 0:s.open(o.id)}},"\u7F16\u8F91",8,ee)):p("",!0),a(M,{type:"vertical"}),d(c).delete?(r(),f(E,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:s=>D(o.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[te]),_:2},1032,["onConfirm"])):p("",!0)]),_:1})):p("",!0)]),_:1},8,["config"]),a(Q,{ref_key:"refInfo",ref:C,onSuccess:()=>m()},null,8,["onSuccess"])]),_:1})}}});export{ie as default};
