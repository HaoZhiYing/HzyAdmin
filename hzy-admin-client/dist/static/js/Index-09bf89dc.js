import{d as K,x as O,a5 as L,E as w,q as V,m as E,r as l,o as u,e as d,w as a,a as o,u as i,j as m,i as f,c as k,f as j}from"./index-2f630cca.js";import{_ as F}from"./AppIcon.vue_vue_type_script_setup_true_lang-5b59e4b3.js";import{_ as I}from"./Info.vue_vue_type_script_setup_true_lang-f84c395b.js";import{_ as U}from"./PageContainer.vue_vue_type_script_setup_true_lang-554ea529.js";import{_ as M}from"./TableCurd.vue_vue_type_script_setup_true_lang-0417d9e7.js";import{S as $}from"./SysOrganizationService-f0fe49b3.js";const q={key:0},P={key:1},G=["onClick"],H=["onClick"],J=j("a",{class:"text-danger"},"\u5220\u9664",-1),Q=K({name:"system_function"}),ne=K({...Q,setup(W){const t=O({search:{state:!1,vm:{name:void 0}},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),r=L(),B=w(),x=w(),h=w();V(()=>{_()});async function _(){try{t.loading=!0;const c=await $.findList(t.search.vm);if(t.loading=!1,c.code!=1)return;t.data=E.genTreeData(c.data,null),t.expandedRowKeys=c.data.map(e=>e.id)}catch{t.loading=!1}}async function A(c){var g,C;let e=[];if(c?e.push(c):e=(C=(g=B.value)==null?void 0:g.getSelectedRowKeys())!=null?C:[],e.length==0)return E.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{t.loading=!0;const y=await $.deleteList(e);if(t.loading=!1,y.code!=1)return;E.message.success("\u5220\u9664\u6210\u529F!"),_()}catch{t.loading=!1}}return(c,e)=>{const g=l("a-input"),C=l("a-form-item"),y=l("a-col"),v=l("a-button"),R=l("a-space"),z=l("a-row"),N=l("a-form"),D=l("a-popconfirm"),p=l("a-table-column"),b=l("a-tag"),T=l("a-divider");return u(),d(U,null,{default:a(()=>[o(M,{ref_key:"refTableCurd",ref:B,config:t,onChange:e[6]||(e[6]=({page:n,pageSize:s})=>{t.page=n==0?1:n,t.size=s,_()}),onShowSizeChange:e[7]||(e[7]=({current:n,size:s})=>{t.page=n==0?1:n,t.size=s,_()}),expandedRowKeys:t.expandedRowKeys,"onUpdate:expandedRowKeys":e[8]||(e[8]=n=>t.expandedRowKeys=n)},{search:a(()=>[i(r).search?(u(),d(N,{key:0,ref_key:"refSearchForm",ref:h,model:t.search.vm},{default:a(()=>[o(z,{gutter:[16,0]},{default:a(()=>[o(y,{xs:24,sm:12,md:8,lg:6,xl:6},{default:a(()=>[o(C,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:a(()=>[o(g,{value:t.search.vm.name,"onUpdate:value":e[0]||(e[0]=n=>t.search.vm.name=n),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),o(y,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:a(()=>[o(R,{size:8},{default:a(()=>[o(v,{onClick:e[1]||(e[1]=n=>{var s;t.page=1,(s=h.value)==null||s.resetFields(),_()})},{default:a(()=>[m(" \u91CD\u7F6E ")]),_:1}),o(v,{type:"primary",onClick:e[2]||(e[2]=n=>{t.page=1,_()})},{default:a(()=>[m(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):f("",!0)]),"toolbar-left":a(()=>[i(r).search?(u(),d(v,{key:0,onClick:e[3]||(e[3]=n=>t.search.state=!t.search.state)},{default:a(()=>[t.search.state?(u(),k("div",q,[o(F,{name:"UpOutlined"}),m("\xA0\xA0\u6536\u8D77")])):(u(),k("div",P,[o(F,{name:"DownOutlined"}),m("\xA0\xA0\u5C55\u5F00")]))]),_:1})):f("",!0),i(r).insert?(u(),d(v,{key:1,type:"primary",onClick:e[4]||(e[4]=()=>{var n;return(n=x.value)==null?void 0:n.open()})},{icon:a(()=>[o(F,{name:"PlusOutlined"})]),default:a(()=>[m(" \u65B0\u5EFA ")]),_:1})):f("",!0),i(r).delete?(u(),d(D,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:e[5]||(e[5]=n=>A()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[o(v,{type:"primary",danger:""},{icon:a(()=>[o(F,{name:"DeleteOutlined"})]),default:a(()=>[m(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):f("",!0)]),"toolbar-right":a(()=>[]),"table-col":a(()=>[o(p,{title:"\u7EC4\u7EC7\u540D\u79F0","data-index":"name"}),o(p,{title:"\u6392\u5E8F\u53F7","data-index":"orderNumber"}),o(p,{title:"\u7EA7\u522B\u7801","data-index":"levelCode"}),o(p,{title:"\u72B6\u6001","data-index":"state"},{default:a(({record:n})=>[n.state==1?(u(),d(b,{key:0,color:"success"},{default:a(()=>[m("\u6B63\u5E38")]),_:1})):(u(),d(b,{key:1,color:"warning"},{default:a(()=>[m("\u505C\u7528")]),_:1}))]),_:1}),o(p,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),o(p,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),i(r).update||i(r).delete||i(r).insert?(u(),d(p,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:a(({record:n})=>[i(r).insert?(u(),k("a",{key:0,href:"javascript:void(0)",onClick:s=>{var S;return(S=x.value)==null?void 0:S.open(null,n.id)}},"\u65B0\u5EFA",8,G)):f("",!0),o(T,{type:"vertical"}),i(r).update?(u(),k("a",{key:1,href:"javascript:;",onClick:()=>{var s;return(s=x.value)==null?void 0:s.open(n.id,n.parentId)}},"\u7F16\u8F91",8,H)):f("",!0),o(T,{type:"vertical"}),i(r).delete?(u(),d(D,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:s=>A(n.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[J]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["config","expandedRowKeys"]),o(I,{ref_key:"refInfo",ref:x,onSuccess:()=>_()},null,8,["onSuccess"])]),_:1})}}});export{ne as default};
