import{d as K,y as O,a4 as L,C as B,q as V,m as E,r,o as u,e as d,w as o,a as n,u as l,i as m,l as f,c as F,f as I}from"./index-0b0c7006.js";import{_ as w}from"./AppIcon.vue_vue_type_script_setup_true_lang-14707d57.js";import{_ as U}from"./Info.vue_vue_type_script_setup_true_lang-06167a0d.js";import{_ as j}from"./PageContainer.vue_vue_type_script_setup_true_lang-79d7f1c7.js";import{_ as M}from"./TableCurd.vue_vue_type_script_setup_true_lang-5b25c5de.js";import{S as z}from"./SysOrganizationService-222012f9.js";const q={key:0},P={key:1},G=["onClick"],H=["onClick"],J=I("a",{class:"text-danger"},"\u5220\u9664",-1),Q=K({name:"system_function"}),oe=K({...Q,setup(W){const e=O({search:{state:!1,vm:{name:void 0},sort:[]},loading:!1,page:1,size:10,total:100,columns:[],data:[],expandedRowKeys:[]}),i=L(),A=B(),g=B(),D=B();V(()=>{_()});async function _(){try{e.loading=!0;const c=await z.findList(e.search.vm);if(e.loading=!1,c.code!=1)return;e.data=E.genTreeData(c.data,null),e.expandedRowKeys=c.data.map(a=>a.id)}catch{e.loading=!1}}async function h(c){var C,k;let a=[];if(c?a.push(c):a=(k=(C=A.value)==null?void 0:C.getSelectedRowKeys())!=null?k:[],a.length==0)return E.message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u884C!");try{e.loading=!0;const y=await z.deleteList(a);if(e.loading=!1,y.code!=1)return;E.message.success("\u5220\u9664\u6210\u529F!"),_()}catch{e.loading=!1}}return(c,a)=>{const C=r("a-input"),k=r("a-form-item"),y=r("a-col"),v=r("a-button"),R=r("a-space"),T=r("a-row"),N=r("a-form"),S=r("a-popconfirm"),p=r("a-table-column"),$=r("a-tag"),b=r("a-divider");return u(),d(j,null,{default:o(()=>[n(M,{ref_key:"refTableCurd",ref:A,config:e,onChange:a[6]||(a[6]=t=>{var s,x;e.page=(s=t.pagination.current)!=null?s:1,e.size=(x=t.pagination.pageSize)!=null?x:e.size,e.search.sort=t.sorter instanceof Array?[...t.sorter]:[t.sorter],_()}),onShowSizeChange:a[7]||(a[7]=({current:t,size:s})=>{e.page=t==0?1:t,e.size=s,_()}),expandedRowKeys:e.expandedRowKeys,"onUpdate:expandedRowKeys":a[8]||(a[8]=t=>e.expandedRowKeys=t)},{search:o(()=>[l(i).search?(u(),d(N,{key:0,ref_key:"refSearchForm",ref:D,model:e.search.vm},{default:o(()=>[n(T,{gutter:[16,0]},{default:o(()=>[n(y,{xs:24,sm:12,md:8,lg:6,xl:6},{default:o(()=>[n(k,{class:"mb-0",name:"name",label:"\u540D\u79F0"},{default:o(()=>[n(C,{value:e.search.vm.name,"onUpdate:value":a[0]||(a[0]=t=>e.search.vm.name=t),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1})]),_:1}),n(y,{xs:24,sm:12,md:8,lg:6,xl:6,class:"text-right"},{default:o(()=>[n(R,{size:8},{default:o(()=>[n(v,{onClick:a[1]||(a[1]=t=>{var s;e.page=1,(s=D.value)==null||s.resetFields(),_()})},{default:o(()=>[m(" \u91CD\u7F6E ")]),_:1}),n(v,{type:"primary",onClick:a[2]||(a[2]=t=>{e.page=1,_()})},{default:o(()=>[m(" \u67E5\u8BE2 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):f("",!0)]),"toolbar-left":o(()=>[l(i).search?(u(),d(v,{key:0,onClick:a[3]||(a[3]=t=>e.search.state=!e.search.state)},{default:o(()=>[e.search.state?(u(),F("div",q,[n(w,{name:"UpOutlined"}),m("\xA0\xA0\u6536\u8D77")])):(u(),F("div",P,[n(w,{name:"DownOutlined"}),m("\xA0\xA0\u5C55\u5F00")]))]),_:1})):f("",!0),l(i).insert?(u(),d(v,{key:1,type:"primary",onClick:a[4]||(a[4]=()=>{var t;return(t=g.value)==null?void 0:t.open()})},{icon:o(()=>[n(w,{name:"PlusOutlined"})]),default:o(()=>[m(" \u65B0\u5EFA ")]),_:1})):f("",!0),l(i).delete?(u(),d(S,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:a[5]||(a[5]=t=>h()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[n(v,{type:"primary",danger:""},{icon:o(()=>[n(w,{name:"DeleteOutlined"})]),default:o(()=>[m(" \u6279\u91CF\u5220\u9664 ")]),_:1})]),_:1})):f("",!0)]),"toolbar-right":o(()=>[]),"table-col":o(()=>[n(p,{title:"\u7EC4\u7EC7\u540D\u79F0","data-index":"name"}),n(p,{title:"\u6392\u5E8F\u53F7","data-index":"orderNumber"}),n(p,{title:"\u7EA7\u522B\u7801","data-index":"levelCode"}),n(p,{title:"\u72B6\u6001","data-index":"state"},{default:o(({record:t})=>[t.state==1?(u(),d($,{key:0,color:"success"},{default:o(()=>[m("\u6B63\u5E38")]),_:1})):(u(),d($,{key:1,color:"warning"},{default:o(()=>[m("\u505C\u7528")]),_:1}))]),_:1}),n(p,{title:"\u66F4\u65B0\u65F6\u95F4","data-index":"lastModificationTime"}),n(p,{title:"\u521B\u5EFA\u65F6\u95F4","data-index":"creationTime"}),l(i).update||l(i).delete||l(i).insert?(u(),d(p,{key:0,title:"\u64CD\u4F5C","data-index":"id"},{default:o(({record:t})=>[l(i).insert?(u(),F("a",{key:0,href:"javascript:void(0)",onClick:s=>{var x;return(x=g.value)==null?void 0:x.open(null,t.id)}},"\u65B0\u5EFA",8,G)):f("",!0),n(b,{type:"vertical"}),l(i).update?(u(),F("a",{key:1,href:"javascript:;",onClick:()=>{var s;return(s=g.value)==null?void 0:s.open(t.id,t.parentId)}},"\u7F16\u8F91",8,H)):f("",!0),n(b,{type:"vertical"}),l(i).delete?(u(),d(S,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664?",onConfirm:s=>h(t.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:o(()=>[J]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["config","expandedRowKeys"]),n(U,{ref_key:"refInfo",ref:g,onSuccess:()=>_()},null,8,["onSuccess"])]),_:1})}}});export{oe as default};
