import{b as S,r as T,a as x,i as O,o as F,c as m,j as p,d as C,f as e,w as l,l as n,q as _,A as b,C as g,n as i,k as v,F as B,e as I,t as V}from"./index-29f07e0f.js";import A from"./List-1fd6d626.js";import{I as R,s as k}from"./Info-809a23ea.js";const $=i("\u67E5\u8BE2"),j=i("\u91CD\u7F6E"),z=i(" \u6E05\u7A7A\u6240\u6709\u6570\u636E "),E=i("\u91CD\u7F6E"),K=i(" \u68C0\u7D22 "),M=i(" - "),P=["onClick"],q={name:"sys_operation_log"},X=Object.assign(q,{setup(G){const L=S(),t=T({search:{state:!1,fieldCount:2,vm:{name:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,data:[],form:{visible:!1,key:""}}),y=x(null),U=x(null),w=L.getPowerByMenuId(O.currentRoute.value.meta.menuId),d={onChange(s){const{currentPage:a,pageSize:u}=s;t.page=a==0?1:a,t.rows=u,d.findList()},onResetSearch(){t.page=1;let s=t.search.vm;for(let a in s)s[a]=null;d.findList()},findList(){t.loading=!0,k.findList(t.rows,t.page,t.search.vm).then(s=>{let a=s.data;t.loading=!1,t.page=a.page,t.rows=a.size,t.total=a.total,t.data=a.dataSource})},deleteList(){k.deleteAllData().then(s=>{s.code==1&&(V.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),d.findList())})},openForm(s){y.value.openForm({visible:!0,key:s})},exportExcel(){k.exportExcel(t.search.vm)}};return F(()=>{d.findList()}),(s,a)=>{const u=m("a-input"),c=m("a-col"),f=m("a-button"),D=m("a-row"),N=m("a-popconfirm"),r=m("vxe-column"),h=m("a-tag");return p(),C("div",null,[e(A,{ref_key:"refList",ref:U,tableData:n(t),onOnChange:d.onChange},{search:l(()=>[e(D,{gutter:[15,15]},{default:l(()=>[e(c,{xs:24,sm:12,md:8,lg:6,xl:4},{default:l(()=>[e(u,{value:n(t).search.vm.api,"onUpdate:value":a[0]||(a[0]=o=>n(t).search.vm.api=o),placeholder:"\u63A5\u53E3\u5730\u5740"},null,8,["value"])]),_:1}),e(c,{xs:24,sm:12,md:8,lg:6,xl:4},{default:l(()=>[e(u,{value:n(t).search.vm.browser,"onUpdate:value":a[1]||(a[1]=o=>n(t).search.vm.browser=o),placeholder:"\u6D4F\u89C8\u5668"},null,8,["value"])]),_:1}),e(c,{xs:24,sm:12,md:8,lg:6,xl:4},{default:l(()=>[e(u,{value:n(t).search.vm.ip,"onUpdate:value":a[2]||(a[2]=o=>n(t).search.vm.ip=o),placeholder:"ip\u5730\u5740"},null,8,["value"])]),_:1}),e(c,{xs:24,sm:12,md:8,lg:6,xl:4},{default:l(()=>[e(u,{value:n(t).search.vm.os,"onUpdate:value":a[3]||(a[3]=o=>n(t).search.vm.os=o),placeholder:"\u64CD\u4F5C\u7CFB\u7EDF"},null,8,["value"])]),_:1}),e(c,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:l(()=>[e(f,{type:"primary",class:"mr-15",onClick:s.findList},{default:l(()=>[$]),_:1},8,["onClick"]),e(f,{class:"mr-15",onClick:s.onResetSearch},{default:l(()=>[j]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":l(()=>[n(w).delete?(p(),_(N,{key:0,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:a[4]||(a[4]=o=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:l(()=>[e(f,{type:"danger"},{icon:l(()=>[e(b,{name:"DeleteOutlined"})]),default:l(()=>[z]),_:1})]),_:1})):g("",!0)]),"toolbar-right":l(()=>[e(u,{value:n(t).search.vm.api,"onUpdate:value":a[5]||(a[5]=o=>n(t).search.vm.api=o),placeholder:"\u63A5\u53E3\u5730\u5740",onKeyup:d.findList},null,8,["value","onKeyup"]),e(f,{onClick:d.onResetSearch},{default:l(()=>[E]),_:1},8,["onClick"]),n(w).search?(p(),_(f,{key:0,onClick:a[6]||(a[6]=o=>n(t).search.state=!n(t).search.state)},{icon:l(()=>[e(b,{name:n(t).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:l(()=>[K]),_:1})):g("",!0)]),"table-col":l(()=>[e(r,{field:"api",title:"\u63A5\u53E3\u5730\u5740","show-overflow":"","min-width":"300"}),e(r,{field:"os",title:"\u64CD\u4F5C\u7CFB\u7EDF",width:"120"}),e(r,{field:"browser",title:"\u6D4F\u89C8\u5668",width:"120"}),e(r,{field:"ip",title:"ip\u5730\u5740",width:"100"}),e(r,{title:"\u63A5\u53E3\u63CF\u8FF0",width:"300"},{default:l(({row:o})=>[i(v(o.controllerDisplayName)+" ",1),o.controllerDisplayName&&o.actionDisplayName?(p(),C(B,{key:0},[M],64)):g("",!0),i(" "+v(o.actionDisplayName),1)]),_:1}),e(r,{field:"takeUpTime",title:"\u63A5\u53E3\u8017\u65F6",width:"100"},{default:l(({row:o})=>[o.takeUpTime>=1e3?(p(),_(h,{key:0,color:"orange"},{default:l(()=>[i(v(o.takeUpTime)+"(\u6BEB\u79D2)",1)]),_:2},1024)):o.takeUpTime>=2e3?(p(),_(h,{key:1,color:"red"},{default:l(()=>[i(v(o.takeUpTime)+"(\u6BEB\u79D2)",1)]),_:2},1024)):(p(),_(h,{key:2,color:"#87d068"},{default:l(()=>[i(v(o.takeUpTime)+"(\u6BEB\u79D2)",1)]),_:2},1024))]),_:1}),e(r,{field:"userName",title:"\u64CD\u4F5C\u4EBA\u59D3\u540D",width:"120"}),e(r,{field:"loginName",title:"\u64CD\u4F5C\u4EBA\u8D26\u53F7",width:"120"}),e(r,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4",width:"180"}),e(r,{field:"id",title:"\u64CD\u4F5C",width:"100"},{default:l(({row:o})=>[I("a",{href:"javascript:void(0)",onClick:H=>d.openForm(o.id)},"\u8BE6\u60C5",8,P)]),_:1})]),_:1},8,["tableData","onOnChange"]),e(R,{ref_key:"refForm",ref:y,onOnSuccess:a[7]||(a[7]=()=>d.findList())},null,512)])}}});export{X as default};
