import{b as R,r as U,V as z,a as O,i as S,o as A,c as d,j as r,d as _,f as n,w as t,l,q as h,A as k,C as f,F as g,x as $,n as c,e as D,t as P,aS as K,k as M}from"./index-fa41bd02.js";import q from"./List-46ca3144.js";import{I as G,s as x}from"./Info-cb69ac13.js";import"./WangEditor-572c7c5e.js";import"./FindBack-c3d4a1f4.js";import"./Index-b23d086a.js";import"./Info-cb1dc99b.js";import"./organizationService-9c4e8e24.js";const H=c("\u67E5\u8BE2"),J=c("\u91CD\u7F6E"),Q=c(" \u65B0\u5EFA "),W=c(" \u6279\u91CF\u5220\u9664 "),X=c("\u5BFC\u51FA Excel"),Y=c(" \u66F4\u591A\u64CD\u4F5C "),Z=c("\u91CD\u7F6E"),ee=c(" \u68C0\u7D22 "),te=["src"],oe=["onClick"],ne=["onClick"],ae=D("a",{class:"text-danger"},"\u5220\u9664",-1),le={name:"base_member"},fe=Object.assign(le,{setup(se){const F=R(),o=U({search:{state:!1,fieldCount:2,vm:{name:""}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,columns:[],data:[],domainName:z.domainName}),b=O(null),C=O(null),u=F.getPowerByMenuId(S.currentRoute.value.meta.menuId),s={onChange(i){const{currentPage:e,pageSize:m}=i;o.page=e==0?1:e,o.rows=m,s.findList()},onResetSearch(){o.page=1;let i=o.search.vm;for(let e in i)i[e]="";s.findList()},findList(){o.loading=!0,x.findList(o.rows,o.page,o.search.vm).then(i=>{let e=i.data;o.loading=!1,o.page=e.page,o.rows=e.size,o.total=e.total,o.columns=e.columns,o.data=e.dataSource})},deleteList(i){let e=[];i?e.push(i):e=C.value.table.getCheckboxRecords().map(m=>m.id),x.deleteList(e).then(m=>{m.code==1&&(P.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),s.findList())})},openForm(i){b.value.openForm({visible:!0,key:i})},exportExcel(){x.exportExcel(o.search.vm)},jumpDetails(i){S.push(`/base/member/details/${i.id}/${i.name}`)}};return A(()=>{s.findList()}),(i,e)=>{const m=d("a-input"),L=d("a-col"),p=d("a-button"),j=d("a-row"),w=d("a-popconfirm"),B=d("a-menu-item"),T=d("a-menu"),V=d("a-dropdown"),E=d("a-checkbox"),I=d("a-popover"),y=d("vxe-column"),N=d("a-divider");return r(),_("div",null,[n(q,{ref_key:"refList",ref:C,tableData:l(o),onOnChange:s.onChange},{search:t(()=>[n(j,{gutter:[15,15]},{default:t(()=>[n(L,{xs:24,sm:12,md:8,lg:6,xl:4},{default:t(()=>[n(m,{value:l(o).search.vm.name,"onUpdate:value":e[0]||(e[0]=a=>l(o).search.vm.name=a),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),n(L,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:t(()=>[n(p,{type:"primary",class:"mr-15",onClick:s.findList},{default:t(()=>[H]),_:1},8,["onClick"]),n(p,{class:"mr-15",onClick:s.onResetSearch},{default:t(()=>[J]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":t(()=>[l(u).insert?(r(),h(p,{key:0,type:"primary",onClick:e[1]||(e[1]=a=>s.openForm())},{icon:t(()=>[n(k,{name:"PlusOutlined"})]),default:t(()=>[Q]),_:1})):f("",!0),l(u).delete?(r(),h(w,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:e[2]||(e[2]=a=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[n(p,{type:"danger"},{icon:t(()=>[n(k,{name:"DeleteOutlined"})]),default:t(()=>[W]),_:1})]),_:1})):f("",!0),n(V,null,{overlay:t(()=>[n(T,null,{default:t(()=>[n(B,{key:"1",onClick:s.exportExcel},{default:t(()=>[X]),_:1},8,["onClick"])]),_:1})]),default:t(()=>[n(p,null,{default:t(()=>[Y,n(k,{name:"DownOutlined"})]),_:1})]),_:1})]),"toolbar-right":t(()=>[n(m,{value:l(o).search.vm.name,"onUpdate:value":e[3]||(e[3]=a=>l(o).search.vm.name=a),placeholder:"\u540D\u79F0",onKeyup:s.findList},null,8,["value","onKeyup"]),n(p,{onClick:s.onResetSearch},{default:t(()=>[Z]),_:1},8,["onClick"]),l(u).search?(r(),h(p,{key:0,onClick:e[4]||(e[4]=a=>l(o).search.state=!l(o).search.state)},{icon:t(()=>[n(k,{name:l(o).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:t(()=>[ee]),_:1})):f("",!0),n(I,null,{content:t(()=>[(r(!0),_(g,null,$(l(o).columns.filter(a=>a.fieldName.substr(0,1)!="_"),a=>(r(),_("div",null,[n(E,{checked:a.show,"onUpdate:checked":v=>a.show=v,onChange:e[5]||(e[5]=()=>K(()=>C.value.table.refreshColumn()))},{default:t(()=>[c(M(a.title),1)]),_:2},1032,["checked","onUpdate:checked"])]))),256))]),default:t(()=>[n(p,null,{default:t(()=>[n(k,{name:"BarsOutlined"})]),_:1})]),_:1})]),"table-col-default":t(()=>[(r(!0),_(g,null,$(l(o).columns,a=>(r(),_(g,null,[a.fieldName=="photo"?(r(),h(y,{key:0,field:"photo",title:"\u5934\u50CF"},{default:t(({row:v})=>[D("img",{src:i.domainName+v.photo,width:"35",height:"35"},null,8,te)]),_:1})):(r(),_(g,{key:1},[a.fieldName!="id"?(r(),h(y,{field:a.fieldName,title:a.title,visible:a.show,key:a.id},null,8,["field","title","visible"])):f("",!0)],64))],64))),256)),l(u).update||l(u).delete?(r(),h(y,{key:0,field:"id",title:"\u64CD\u4F5C"},{default:t(({row:a})=>[l(u).update?(r(),_("a",{key:0,href:"javascript:void(0)",onClick:v=>s.jumpDetails(a)},"\u8BE6\u60C5",8,oe)):f("",!0),n(N,{type:"vertical"}),l(u).update?(r(),_("a",{key:1,href:"javascript:void(0)",onClick:v=>s.openForm(a.id)},"\u7F16\u8F91",8,ne)):f("",!0),n(N,{type:"vertical"}),l(u).delete?(r(),h(w,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:v=>s.deleteList(a.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:t(()=>[ae]),_:2},1032,["onConfirm"])):f("",!0)]),_:1})):f("",!0)]),_:1},8,["tableData","onOnChange"]),n(G,{ref_key:"refForm",ref:b,onOnSuccess:e[6]||(e[6]=()=>s.findList())},null,512)])}}});export{fe as default};
