var A=Object.defineProperty,B=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var L=(e,t,i)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,w=(e,t)=>{for(var i in t||(t={}))N.call(t,i)&&L(e,i,t[i]);if(F)for(var i of F(t))V.call(t,i)&&L(e,i,t[i]);return e},R=(e,t)=>B(e,j(t));import{d as z,k as P,r as $,l as U,t as q,O as H,b as d,o as m,m as v,A as J,B as G,s as o,h as n,c as g,x as h,y as u,u as E,F as D,q as b,J as K}from"./vendor-621951b9.js";import{_ as Q,A as W,a as X,r as Z,t as ee}from"./index-7aa787f9.js";import{I as te,s as M}from"./Info-e7530bee.js";const oe=z({name:"system_menu",components:{AppIcon:W,Info:te},setup(){const e=X(),t=P({table:{search:{state:!1,fieldCount:2,vm:{name:null}},loading:!1,data:[],expandRows:[]}}),i=$(null),f=$(null),k=e.getPowerByMenuId(Z.currentRoute.value.meta.menuId),p={onChange(s){const{currentPage:a,pageSize:r}=s;t.table.page=a==0?1:a,t.table.rows=r,p.findList()},onResetSearch(){t.table.page=1;let s=t.table.search.vm;for(let a in s)s[a]=null;p.findList()},findList(){t.table.loading=!0,M.getAll(t.table.search.vm).then(s=>{let a=s.data;t.table.loading=!1,t.table.data=a,K(()=>p.recoveryOpenRows())})},deleteList(s){let a=[];s?a.push(s):a=f.value.getCheckboxRecords().map(r=>r.id),M.deleteList(a).then(r=>{r.code==1&&(ee.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),p.findList())})},openForm(s,a){i.value.openForm({visible:!0,key:s,parentId:a})},onToggleTreeExpand(){t.table.expandRows=f.value.getTreeExpandRecords()},recoveryOpenRows(){var s=t.table.expandRows;s.length>0&&(f.value.setTreeExpand(t.table.data[1],!0),s.forEach(a=>{f.value.setTreeExpand(t.table.data.filter(r=>r.id==a.id),!0)}))}};return U(()=>{p.findList()}),R(w(w({},q(t)),p),{power:k,refForm:i,refTable:f,dayjs:H})}}),ne=u("\u67E5\u8BE2"),ae=u("\u91CD\u7F6E"),se={key:0},le=u("\xA0\xA0\u6536\u8D77"),ie={key:1},re=u("\xA0\xA0\u5C55\u5F00"),de=u(" \u65B0\u5EFA "),ce=u(" \u6279\u91CF\u5220\u9664 "),me=["onClick"],ue=["onClick"],pe=b("a",{class:"text-danger"},"\u5220\u9664",-1);function fe(e,t,i,f,k,p){const s=d("a-input"),a=d("a-col"),r=d("a-button"),y=d("a-row"),T=d("a-card"),_=d("AppIcon"),C=d("a-popconfirm"),c=d("vxe-column"),x=d("a-divider"),O=d("vxe-table"),S=d("a-spin"),Y=d("Info");return m(),v("div",null,[J(o(T,{class:"mb-15"},{default:n(()=>[o(y,{gutter:[15,15]},{default:n(()=>[o(a,{xs:24,sm:12,md:8,lg:6,xl:4},{default:n(()=>[o(s,{value:e.table.search.vm.name,"onUpdate:value":t[0]||(t[0]=l=>e.table.search.vm.name=l),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),o(a,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:n(()=>[o(r,{type:"primary",class:"mr-15",onClick:e.findList},{default:n(()=>[ne]),_:1},8,["onClick"]),o(r,{class:"mr-15",onClick:e.onResetSearch},{default:n(()=>[ae]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512),[[G,e.table.search.state]]),o(T,null,{default:n(()=>[o(y,{gutter:[15,15]},{default:n(()=>[o(a,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[e.power.search?(m(),g(r,{key:0,class:"mr-15",onClick:t[1]||(t[1]=l=>e.table.search.state=!e.table.search.state)},{default:n(()=>[e.table.search.state?(m(),v("div",se,[o(_,{name:"UpOutlined"}),le])):(m(),v("div",ie,[o(_,{name:"DownOutlined"}),re]))]),_:1})):h("",!0),e.power.insert?(m(),g(r,{key:1,type:"primary",class:"mr-15",onClick:t[2]||(t[2]=l=>e.openForm())},{icon:n(()=>[o(_,{name:"PlusOutlined"})]),default:n(()=>[de]),_:1})):h("",!0),e.power.delete?(m(),g(C,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:t[3]||(t[3]=l=>e.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[o(r,{type:"danger",class:"mr-15"},{icon:n(()=>[o(_,{name:"DeleteOutlined"})]),default:n(()=>[ce]),_:1})]),_:1})):h("",!0)]),_:1}),o(a,{xs:24,sm:24,md:12,lg:12,xl:12,class:"text-right"})]),_:1}),o(S,{spinning:e.table.loading},{default:n(()=>[o(O,{class:"mt-15",ref:"refTable",size:"medium",border:"",stripe:"",data:e.table.data,"row-config":{isCurrent:!0,isHover:!0},"column-config":{isCurrent:!0,resizable:!0},"checkbox-config":{highlight:!0},"tree-config":{transform:!0,rowField:"id",parentField:"parentId"},onToggleTreeExpand:e.onToggleTreeExpand},{default:n(()=>[o(c,{type:"checkbox",width:"40"}),o(c,{field:"name",title:"\u540D\u79F0","show-overflow":"","tree-node":"",width:"200"}),o(c,{field:"icon",title:"\u56FE\u6807",width:"60"},{default:n(({row:l})=>[o(_,{name:l.icon},null,8,["name"])]),_:1}),o(c,{field:"number",title:"\u7F16\u53F7",width:"80"}),o(c,{field:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0","show-overflow":"","min-width":"220"}),o(c,{field:"url",title:"\u7EC4\u4EF6\u5730\u5740","show-overflow":"",width:"250"}),o(c,{field:"router",title:"\u8DEF\u7531\u5730\u5740","show-overflow":"",width:"250"}),o(c,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4",width:"120"},{default:n(({row:l})=>[u(E(e.dayjs(l.lastModificationTime).format("YYYY-MM-DD")),1)]),_:1}),o(c,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4",width:"120"},{default:n(({row:l})=>[u(E(e.dayjs(l.creationTime).format("YYYY-MM-DD")),1)]),_:1}),o(c,{field:"id",title:"\u64CD\u4F5C",width:"200"},{default:n(({row:l})=>[e.power.insert?(m(),v(D,{key:0},[b("a",{href:"javascript:void(0)",onClick:I=>e.openForm(null,l.id)},"\u65B0\u5EFA",8,me),o(x,{type:"vertical"})],64)):h("",!0),e.power.update?(m(),v(D,{key:1},[b("a",{href:"javascript:void(0)",onClick:I=>e.openForm(l.id,l.parentId)},"\u7F16\u8F91",8,ue),o(x,{type:"vertical"})],64)):h("",!0),e.power.delete?(m(),g(C,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:I=>e.deleteList(l.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[pe]),_:2},1032,["onConfirm"])):h("",!0)]),_:1})]),_:1},8,["data","onToggleTreeExpand"])]),_:1},8,["spinning"])]),_:1}),o(Y,{ref:"refForm",onOnSuccess:t[4]||(t[4]=()=>e.findList())},null,512)])}var we=Q(oe,[["render",fe]]);export{we as default};
