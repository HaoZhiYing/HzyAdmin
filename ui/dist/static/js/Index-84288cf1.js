var O=Object.defineProperty,j=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var L=(e,t,i)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,w=(e,t)=>{for(var i in t||(t={}))N.call(t,i)&&L(e,i,t[i]);if(F)for(var i of F(t))V.call(t,i)&&L(e,i,t[i]);return e},R=(e,t)=>j(e,B(t));import{d as P,h as z,r as $,v as H,t as U,I as q,i as d,o as p,p as h,A as G,B as J,l as o,j as a,c as g,e as _,q as m,s as E,F as S,k as b,H as K}from"./vendor-73d99709.js";import{_ as Q,A as W,u as X,r as Z,t as ee}from"./index-f2a5d0fa.js";import{I as te,s as D}from"./Info-fc261280.js";const oe=P({name:"system_menu",components:{AppIcons:W,Info:te},setup(){const e=X(),t=z({table:{search:{state:!1,fieldCount:2,vm:{name:null}},loading:!1,data:[],expandRows:[]}}),i=$(null),f=$(null),k=e.getPowerByMenuId(Z.currentRoute.value.meta.menuId),u={onChange(s){const{currentPage:n,pageSize:r}=s;t.table.page=n==0?1:n,t.table.rows=r,u.findList()},onResetSearch(){t.table.page=1;let s=t.table.search.vm;for(let n in s)s[n]=null;u.findList()},findList(){t.table.loading=!0,D.getAll(t.table.search.vm).then(s=>{let n=s.data;t.table.loading=!1,t.table.data=n,K(()=>u.recoveryOpenRows())})},deleteList(s){let n=[];s?n.push(s):n=f.value.getCheckboxRecords().map(r=>r.id),D.deleteList(n).then(r=>{r.code==1&&(ee.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),u.findList())})},openForm(s,n){i.value.openForm({visible:!0,key:s,parentId:n})},onToggleTreeExpand(){t.table.expandRows=f.value.getTreeExpandRecords()},recoveryOpenRows(){var s=t.table.expandRows;s.length>0&&(f.value.setTreeExpand(t.table.data[1],!0),s.forEach(n=>{f.value.setTreeExpand(t.table.data.filter(r=>r.id==n.id),!0)}))}};return H(()=>{u.findList()}),R(w(w({},U(t)),u),{power:k,refForm:i,refTable:f,dayjs:q})}}),ae={class:"p-24"},ne=m("\u67E5\u8BE2"),se=m("\u91CD\u7F6E"),le={key:0},ie=m("\xA0\xA0\u6536\u8D77"),re={key:1},de=m("\xA0\xA0\u5C55\u5F00"),ce=m(" \u65B0\u5EFA "),pe=m(" \u6279\u91CF\u5220\u9664 "),me=["onClick"],ue=["onClick"],fe=b("a",{class:"text-danger"},"\u5220\u9664",-1);function _e(e,t,i,f,k,u){const s=d("a-input"),n=d("a-col"),r=d("a-button"),y=d("a-row"),T=d("a-card"),v=d("AppIcons"),C=d("a-popconfirm"),c=d("vxe-column"),I=d("a-divider"),M=d("vxe-table"),Y=d("a-spin"),A=d("Info");return p(),h("div",ae,[G(o(T,{class:"w100 mb-24",bodyStyle:"padding:0"},{default:a(()=>[o(y,{gutter:[24,24],class:"p-24"},{default:a(()=>[o(n,{xs:24,sm:12,md:8,lg:6,xl:4},{default:a(()=>[o(s,{value:e.table.search.vm.name,"onUpdate:value":t[0]||(t[0]=l=>e.table.search.vm.name=l),placeholder:"\u540D\u79F0"},null,8,["value"])]),_:1}),o(n,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:a(()=>[o(r,{type:"primary",class:"mr-24",onClick:e.findList},{default:a(()=>[ne]),_:1},8,["onClick"]),o(r,{class:"mr-24",onClick:e.onResetSearch},{default:a(()=>[se]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512),[[J,e.table.search.state]]),o(T,null,{default:a(()=>[o(y,{gutter:[24,24]},{default:a(()=>[o(n,{xs:24,sm:24,md:12,lg:12,xl:12},{default:a(()=>[e.power.search?(p(),g(r,{key:0,class:"mr-24",onClick:t[1]||(t[1]=l=>e.table.search.state=!e.table.search.state)},{default:a(()=>[e.table.search.state?(p(),h("div",le,[o(v,{name:"UpOutlined"}),ie])):(p(),h("div",re,[o(v,{name:"DownOutlined"}),de]))]),_:1})):_("",!0),e.power.insert?(p(),g(r,{key:1,type:"primary",class:"mr-24",onClick:t[2]||(t[2]=l=>e.openForm())},{icon:a(()=>[o(v,{name:"PlusOutlined"})]),default:a(()=>[ce]),_:1})):_("",!0),e.power.delete?(p(),g(C,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:t[3]||(t[3]=l=>e.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[o(r,{type:"danger",class:"mr-24"},{icon:a(()=>[o(v,{name:"DeleteOutlined"})]),default:a(()=>[pe]),_:1})]),_:1})):_("",!0)]),_:1}),o(n,{xs:24,sm:24,md:12,lg:12,xl:12,class:"text-right"})]),_:1}),o(Y,{spinning:e.table.loading},{default:a(()=>[o(M,{class:"mt-24",ref:"refTable",resizable:"",data:e.table.data,"row-config":{isHover:!0},"tree-config":{transform:!0,rowField:"id",parentField:"parentId"},onToggleTreeExpand:e.onToggleTreeExpand},{default:a(()=>[o(c,{type:"checkbox",width:"40"}),o(c,{field:"name",title:"\u540D\u79F0","show-overflow":"","tree-node":"",width:"200"}),o(c,{field:"icon",title:"\u56FE\u6807",width:"60"},{default:a(({row:l})=>[o(v,{name:l.icon},null,8,["name"])]),_:1}),o(c,{field:"number",title:"\u7F16\u53F7",width:"80"}),o(c,{field:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0","show-overflow":"","min-width":"220"}),o(c,{field:"url",title:"\u7EC4\u4EF6\u5730\u5740","show-overflow":"",width:"250"}),o(c,{field:"router",title:"\u8DEF\u7531\u5730\u5740","show-overflow":"",width:"250"}),o(c,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4",width:"120"},{default:a(({row:l})=>[m(E(e.dayjs(l.lastModificationTime).format("YYYY-MM-DD")),1)]),_:1}),o(c,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4",width:"120"},{default:a(({row:l})=>[m(E(e.dayjs(l.creationTime).format("YYYY-MM-DD")),1)]),_:1}),o(c,{field:"id",title:"\u64CD\u4F5C",width:"200"},{default:a(({row:l})=>[e.power.insert?(p(),h(S,{key:0},[b("a",{href:"javascript:void(0)",onClick:x=>e.openForm(null,l.id)},"\u65B0\u5EFA",8,me),o(I,{type:"vertical"})],64)):_("",!0),e.power.update?(p(),h(S,{key:1},[b("a",{href:"javascript:void(0)",onClick:x=>e.openForm(l.id,l.parentId)},"\u7F16\u8F91",8,ue),o(I,{type:"vertical"})],64)):_("",!0),e.power.delete?(p(),g(C,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:x=>e.deleteList(l.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:a(()=>[fe]),_:2},1032,["onConfirm"])):_("",!0)]),_:1})]),_:1},8,["data","onToggleTreeExpand"])]),_:1},8,["spinning"])]),_:1}),o(A,{ref:"refForm",onOnSuccess:t[4]||(t[4]=()=>e.findList())},null,512)])}var be=Q(oe,[["render",_e]]);export{be as default};
