import{_ as V,b as j,r as M,K as P,a as L,i as q,I as O,o as G,c as r,j as m,d as S,f as a,w as n,e as T,l,q as y,A as C,C as v,n as c,g as H,h as J,b0 as b,t as I}from"./index-0c8a61e2.js";import Q from"./List-1181ac16.js";import W from"./Info-92fee449.js";import{o as X}from"./organizationService-7031dd37.js";const Y=h=>(H("data-v-70d3277f"),h=h(),J(),h),Z=c("\u67E5\u8BE2"),ee=c("\u91CD\u7F6E"),te=c(" \u65B0\u5EFA "),ae=c(" \u6279\u91CF\u5220\u9664 "),ne=c(" \u5E26\u56DE\u6570\u636E "),oe=c("\u5BFC\u51FA Excel"),se=c(" \u66F4\u591A\u64CD\u4F5C "),le=c("\u91CD\u7F6E"),ie=c(" \u68C0\u7D22 "),re=["onClick"],de=Y(()=>T("a",{class:"text-danger"},"\u5220\u9664",-1)),ce={name:"system_user"},ue=Object.assign(ce,{props:{isFindBack:{type:Boolean,default(){return!1}},defaultRowIds:Array,type:{type:Boolean,default(){return!0}}},emits:["onChange"],setup(h,{emit:z}){const f=h,$=j(),t=M({search:{state:!1,vm:{name:null,loginName:null,organizationId:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,data:[],tree:{data:[],expandedKeys:[],selectedKeys:[],loadingTree:!1},findBack:{defaultRowIds:P(()=>f.defaultRowIds)}}),R=L(null),k=L(null),_=$.getPowerByMenuId(q.currentRoute.value.meta.menuId),s={onChange(o){const{currentPage:e,pageSize:d}=o;t.page=e==0?1:e,t.rows=d,s.findList()},onResetSearch(){t.page=1;let o=t.search.vm;for(let e in o)o[e]=null;s.findList()},findList(){t.loading=!0,b.findList(t.rows,t.page,t.search.vm).then(o=>{let e=o.data;t.loading=!1,t.page=e.page,t.rows=e.size,t.total=e.total,t.data=e.dataSource,s.findBack.setCheckboxRow()})},deleteList(o){let e=[];o?e.push(o):e=k.value.table.getCheckboxRecords().map(d=>d.id),b.deleteList(e).then(d=>{d.code==1&&(I.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),s.findList())})},openForm(o){if(!o&&!t.search.vm.organizationId)return I.message("\u8BF7\u9009\u62E9\u7EC4\u7EC7!","\u8B66\u544A");R.value.openForm({visible:!0,key:o,organizationId:t.search.vm.organizationId})},exportExcel(){b.exportExcel(t.search.vm)},sysOrganizationTree(){t.tree.loadingTree=!0,X.sysOrganizationTree().then(o=>{t.tree.loadingTree=!1;let e=o.data;t.tree.data=e.rows,t.tree.expandedKeys=e.expandedRowKeys,s.findList()})},getFirst(){t.tree.selectedKeys=[]},findBack:{initRows(){!f.isFindBack||O(()=>f.defaultRowIds,o=>{s.findBack.setCheckboxRow()})},setCheckboxRow(){!f.isFindBack||(k.value.table.setAllCheckboxRow(!1),k.value.table.setCheckboxRow(s.findBack.getRowsByIds(t.findBack.defaultRowIds),!0))},onChange(){if(!!f.isFindBack){var o=k.value.table.getCheckboxRecords();if(f.type&&o.length>1)return I.message("\u53EA\u80FD\u9009\u62E9\u4E00\u6761\u6570\u636E!","\u8B66\u544A");z("onChange",k.value.table.getCheckboxRecords())}},getRowsByIds(o){if(!!f.isFindBack){var e=[],d=t.data;for(let x=0;x<d.length;x++){const w=d[x];o.filter(g=>g==w.id).length>0&&e.push(w)}return e}}}};return s.findBack.initRows(),O(()=>t.tree.selectedKeys,o=>{t.search.vm.organizationId=o.length>0?o[0]:null,s.findList()}),G(()=>{s.sysOrganizationTree()}),(o,e)=>{const d=r("a-tree"),x=r("a-spin"),w=r("a-card"),g=r("a-col"),B=r("a-input"),u=r("a-button"),K=r("a-row"),F=r("a-popconfirm"),N=r("a-menu-item"),U=r("a-menu"),A=r("a-dropdown"),p=r("vxe-column"),D=r("a-divider");return m(),S("div",null,[a(K,{gutter:[15,15]},{default:n(()=>[a(g,{xs:24,sm:12,md:12,lg:5,xl:5},{default:n(()=>[a(w,{title:"\u7EC4\u7EC7\u67B6\u6784",class:"w100 mb-15 min-height"},{extra:n(()=>[T("a",{href:"javascript:void(0)",onClick:e[0]||(e[0]=(...i)=>s.getFirst&&s.getFirst(...i))},"\u67E5\u770B\u4E00\u7EA7")]),default:n(()=>[a(x,{spinning:l(t).tree.loadingTree},{default:n(()=>[a(d,{expandedKeys:l(t).tree.expandedKeys,"onUpdate:expandedKeys":e[1]||(e[1]=i=>l(t).tree.expandedKeys=i),selectedKeys:l(t).tree.selectedKeys,"onUpdate:selectedKeys":e[2]||(e[2]=i=>l(t).tree.selectedKeys=i),"tree-data":l(t).tree.data},null,8,["expandedKeys","selectedKeys","tree-data"])]),_:1},8,["spinning"])]),_:1})]),_:1}),a(g,{xs:24,sm:12,md:12,lg:19,xl:19},{default:n(()=>[a(Q,{ref_key:"refList",ref:k,tableData:l(t),onOnChange:s.onChange},{search:n(()=>[a(K,{gutter:[15,15]},{default:n(()=>[a(g,{xs:24,sm:12,md:8,lg:6,xl:6},{default:n(()=>[a(B,{value:l(t).search.vm.name,"onUpdate:value":e[3]||(e[3]=i=>l(t).search.vm.name=i),placeholder:"\u771F\u5B9E\u540D\u79F0"},null,8,["value"])]),_:1}),a(g,{xs:24,sm:12,md:8,lg:6,xl:6},{default:n(()=>[a(B,{value:l(t).search.vm.loginName,"onUpdate:value":e[4]||(e[4]=i=>l(t).search.vm.loginName=i),placeholder:"\u8D26\u6237\u540D\u79F0"},null,8,["value"])]),_:1}),a(g,{xs:24,sm:12,md:8,lg:6,xl:6,style:{float:"right"}},{default:n(()=>[a(u,{type:"primary",class:"mr-15",onClick:s.findList},{default:n(()=>[Z]),_:1},8,["onClick"]),a(u,{class:"mr-15",onClick:s.onResetSearch},{default:n(()=>[ee]),_:1},8,["onClick"])]),_:1})]),_:1})]),"toolbar-left":n(()=>[l(_).insert&&!o.$props.isFindBack?(m(),y(u,{key:0,type:"primary",onClick:e[5]||(e[5]=i=>s.openForm())},{icon:n(()=>[a(C,{name:"PlusOutlined"})]),default:n(()=>[te]),_:1})):v("",!0),l(_).delete&&!o.$props.isFindBack?(m(),y(F,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:e[6]||(e[6]=i=>s.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[a(u,{type:"danger"},{icon:n(()=>[a(C,{name:"DeleteOutlined"})]),default:n(()=>[ae]),_:1})]),_:1})):v("",!0),o.$props.isFindBack?(m(),y(u,{key:2,type:"primary",onClick:e[7]||(e[7]=i=>s.findBack.onChange())},{icon:n(()=>[a(C,{name:"CheckOutlined"})]),default:n(()=>[ne]),_:1})):v("",!0),a(A,null,{overlay:n(()=>[a(U,null,{default:n(()=>[a(N,{key:"1",onClick:s.exportExcel},{default:n(()=>[oe]),_:1},8,["onClick"])]),_:1})]),default:n(()=>[a(u,null,{default:n(()=>[se,a(C,{name:"DownOutlined"})]),_:1})]),_:1})]),"toolbar-right":n(()=>[a(B,{value:l(t).search.vm.name,"onUpdate:value":e[8]||(e[8]=i=>l(t).search.vm.name=i),placeholder:"\u540D\u79F0",onKeyup:s.findList},null,8,["value","onKeyup"]),a(u,{onClick:s.onResetSearch},{default:n(()=>[le]),_:1},8,["onClick"]),l(_).search?(m(),y(u,{key:0,onClick:e[9]||(e[9]=i=>l(t).search.state=!l(t).search.state)},{icon:n(()=>[a(C,{name:l(t).search.state?"UpOutlined":"DownOutlined"},null,8,["name"])]),default:n(()=>[ie]),_:1})):v("",!0)]),"table-col-default":n(()=>[a(p,{field:"name",title:"\u771F\u5B9E\u59D3\u540D"}),a(p,{field:"loginName",title:"\u8D26\u53F7"}),a(p,{field:"\u6240\u5C5E\u89D2\u8272",title:"\u6240\u5C5E\u89D2\u8272"}),a(p,{field:"phone",title:"\u8054\u7CFB\u7535\u8BDD"}),a(p,{field:"organizationName",title:"\u6240\u5C5E\u7EC4\u7EC7"}),a(p,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4"}),a(p,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4"}),(l(_).update||l(_).delete)&&!o.$props.isFindBack?(m(),y(p,{key:0,field:"id",title:"\u64CD\u4F5C"},{default:n(({row:i})=>[l(_).update?(m(),S("a",{key:0,href:"javascript:void(0)",onClick:E=>s.openForm(i.id)},"\u7F16\u8F91",8,re)):v("",!0),a(D,{type:"vertical"}),l(_).delete?(m(),y(F,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:E=>s.deleteList(i.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[de]),_:2},1032,["onConfirm"])):v("",!0)]),_:1})):v("",!0)]),_:1},8,["tableData","onOnChange"])]),_:1})]),_:1}),a(W,{ref_key:"refForm",ref:R,onOnSuccess:e[10]||(e[10]=()=>s.findList())},null,512)])}}});var ge=V(ue,[["__scopeId","data-v-70d3277f"]]);export{ge as default};
