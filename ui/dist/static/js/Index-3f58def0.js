var D=Object.defineProperty,J=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var T=(e,a,p)=>a in e?D(e,a,{enumerable:!0,configurable:!0,writable:!0,value:p}):e[a]=p,I=(e,a)=>{for(var p in a||(a={}))M.call(a,p)&&T(e,p,a[p]);if(x)for(var p of x(a))q.call(a,p)&&T(e,p,a[p]);return e},F=(e,a)=>J(e,j(a));import{d as G,s as H,c as Z,e as K,w as S,t as Q,u as W,f as i,q as c,v as k,y as t,m as n,x as $,E as X,G as Y,j as y,A as h,B as g,Z as ee,_ as te}from"./vendor-4ca571b9.js";import{_ as ae,A as ne,a as oe,r as se,s as B,t as z}from"./index-af5e2f14.js";import le from"./Info-269d8157.js";import{o as re}from"./organizationService-aaabfcac.js";const ie=G({name:"system_user",components:{AppIcon:ne,Info:le},props:{isFindBack:Boolean,onChange:Function,defaultRowIds:Array,type:{type:Boolean,default(){return!0}}},setup(e,a){const p=oe(),o=H({table:{search:{state:!1,vm:{name:null,loginName:null,organizationId:null}},loading:!1,pageSizeOptions:[10,20,50,100,500,1e3],rows:10,page:1,total:0,data:[]},tree:{data:[],expandedKeys:[],selectedKeys:[],loadingTree:!1},findBack:{defaultRowIds:Z(()=>e.defaultRowIds)}}),w=K(null),_=K(null),C=p.getPowerByMenuId(se.currentRoute.value.meta.menuId),d={onChange(l){const{currentPage:s,pageSize:u}=l;o.table.page=s==0?1:s,o.table.rows=u,d.findList()},onResetSearch(){o.table.page=1;let l=o.table.search.vm;for(let s in l)l[s]=null;d.findList()},findList(){o.table.loading=!0,B.findList(o.table.rows,o.table.page,o.table.search.vm).then(l=>{let s=l.data;o.table.loading=!1,o.table.page=s.page,o.table.rows=s.size,o.table.total=s.total,o.table.data=s.dataSource,d.findBack.setCheckboxRow()})},deleteList(l){let s=[];l?s.push(l):s=_.value.getCheckboxRecords().map(u=>u.id),B.deleteList(s).then(u=>{u.code==1&&(z.message("\u5220\u9664\u6210\u529F!","\u6210\u529F"),d.findList())})},openForm(l){if(!l&&!o.table.search.vm.organizationId)return z.message("\u8BF7\u9009\u62E9\u7EC4\u7EC7!","\u8B66\u544A");w.value.openForm({visible:!0,key:l,organizationId:o.table.search.vm.organizationId})},exportExcel(){B.exportExcel(o.table.search.vm)},sysOrganizationTree(){o.tree.loadingTree=!0,re.sysOrganizationTree().then(l=>{o.tree.loadingTree=!1;let s=l.data;o.tree.data=s.rows,o.tree.expandedKeys=s.expandedRowKeys,d.findList()})},getFirst(){o.tree.selectedKeys=[]},findBack:{initRows(){S(()=>e.defaultRowIds,()=>{d.findBack.setCheckboxRow()})},setCheckboxRow(){_.value.setAllCheckboxRow(!1),_.value.setCheckboxRow(d.findBack.getRowsByIds(o.findBack.defaultRowIds),!0)},onChange(){var l=_.value.getCheckboxRecords();if(e.type&&l.length>1)return z.message("\u53EA\u80FD\u9009\u62E9\u4E00\u6761\u6570\u636E!","\u8B66\u544A");a.emit("onChange",_.value.getCheckboxRecords())},getRowsByIds(l){var s=[],u=o.table.data;for(let m=0;m<u.length;m++){const b=u[m];l.filter(v=>v==b.id).length>0&&(s.push(b),console.log("id=",b))}return s}}};return d.findBack.initRows(),S(()=>o.tree.selectedKeys,l=>{o.table.search.vm.organizationId=l.length>0?l[0]:null,d.findList()}),Q(()=>{d.sysOrganizationTree()}),F(I(I({},W(o)),d),{power:C,refForm:w,refTable:_})}}),de=e=>(ee("data-v-60aa0862"),e=e(),te(),e),pe=g("\u67E5\u8BE2"),ue=g("\u91CD\u7F6E"),me={key:0},ce=g("\xA0\xA0\u6536\u8D77"),fe={key:1},ge=g("\xA0\xA0\u5C55\u5F00"),ve=g(" \u65B0\u5EFA "),_e=g(" \u6279\u91CF\u5220\u9664 "),be=g(" \u5E26\u56DE\u6570\u636E "),he=g("\u5BFC\u51FA Excel"),ye=g(" \u66F4\u591A\u64CD\u4F5C "),ke=["onClick"],we=de(()=>$("a",{class:"text-danger"},"\u5220\u9664",-1));function Ce(e,a,p,o,w,_){const C=i("a-tree"),d=i("a-spin"),l=i("a-card"),s=i("a-col"),u=i("a-input"),m=i("a-button"),b=i("a-row"),v=i("AppIcon"),R=i("a-popconfirm"),L=i("a-menu-item"),N=i("a-menu"),O=i("a-dropdown"),f=i("vxe-column"),P=i("a-divider"),A=i("vxe-table"),U=i("vxe-pager"),E=i("Info");return c(),k("div",null,[t(b,{gutter:[15,15]},{default:n(()=>[t(s,{xs:24,sm:12,md:12,lg:5,xl:5},{default:n(()=>[t(l,{title:"\u7EC4\u7EC7\u67B6\u6784",class:"w100 mb-15 min-height"},{extra:n(()=>[$("a",{href:"javascript:void(0)",onClick:a[0]||(a[0]=(...r)=>e.getFirst&&e.getFirst(...r))},"\u67E5\u770B\u4E00\u7EA7")]),default:n(()=>[t(d,{spinning:e.tree.loadingTree},{default:n(()=>[t(C,{expandedKeys:e.tree.expandedKeys,"onUpdate:expandedKeys":a[1]||(a[1]=r=>e.tree.expandedKeys=r),selectedKeys:e.tree.selectedKeys,"onUpdate:selectedKeys":a[2]||(a[2]=r=>e.tree.selectedKeys=r),"tree-data":e.tree.data},null,8,["expandedKeys","selectedKeys","tree-data"])]),_:1},8,["spinning"])]),_:1})]),_:1}),t(s,{xs:24,sm:12,md:12,lg:19,xl:19},{default:n(()=>[X(t(l,{class:"mb-15"},{default:n(()=>[t(b,{gutter:[15,15]},{default:n(()=>[t(s,{xs:24,sm:12,md:8,lg:6,xl:4},{default:n(()=>[t(u,{value:e.table.search.vm.name,"onUpdate:value":a[3]||(a[3]=r=>e.table.search.vm.name=r),placeholder:"\u771F\u5B9E\u540D\u79F0"},null,8,["value"])]),_:1}),t(s,{xs:24,sm:12,md:8,lg:6,xl:4},{default:n(()=>[t(u,{value:e.table.search.vm.loginName,"onUpdate:value":a[4]||(a[4]=r=>e.table.search.vm.loginName=r),placeholder:"\u8D26\u6237\u540D\u79F0"},null,8,["value"])]),_:1}),t(s,{xs:24,sm:12,md:8,lg:6,xl:4,style:{float:"right"}},{default:n(()=>[t(m,{type:"primary",class:"mr-15",onClick:e.findList},{default:n(()=>[pe]),_:1},8,["onClick"]),t(m,{class:"mr-15",onClick:e.onResetSearch},{default:n(()=>[ue]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},512),[[Y,e.table.search.state]]),t(l,null,{default:n(()=>[t(b,{gutter:[15,15]},{default:n(()=>[t(s,{xs:24,sm:24,md:12,lg:12,xl:12},{default:n(()=>[e.power.search?(c(),y(m,{key:0,class:"mr-15",onClick:a[5]||(a[5]=r=>e.table.search.state=!e.table.search.state)},{default:n(()=>[e.table.search.state?(c(),k("div",me,[t(v,{name:"UpOutlined"}),ce])):(c(),k("div",fe,[t(v,{name:"DownOutlined"}),ge]))]),_:1})):h("",!0),e.power.insert&&!e.$props.isFindBack?(c(),y(m,{key:1,type:"primary",class:"mr-15",onClick:a[6]||(a[6]=r=>e.openForm())},{icon:n(()=>[t(v,{name:"PlusOutlined"})]),default:n(()=>[ve]),_:1})):h("",!0),e.power.delete&&!e.$props.isFindBack?(c(),y(R,{key:2,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:a[7]||(a[7]=r=>e.deleteList()),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[t(m,{type:"danger",class:"mr-15"},{icon:n(()=>[t(v,{name:"DeleteOutlined"})]),default:n(()=>[_e]),_:1})]),_:1})):h("",!0),e.$props.isFindBack?(c(),y(m,{key:3,type:"primary",class:"mr-15",onClick:a[8]||(a[8]=r=>e.findBack.onChange())},{icon:n(()=>[t(v,{name:"CheckOutlined"})]),default:n(()=>[be]),_:1})):h("",!0)]),_:1}),t(s,{xs:24,sm:24,md:12,lg:12,xl:12,class:"text-right"},{default:n(()=>[t(O,null,{overlay:n(()=>[t(N,null,{default:n(()=>[t(L,{key:"1",onClick:e.exportExcel},{default:n(()=>[he]),_:1},8,["onClick"])]),_:1})]),default:n(()=>[t(m,null,{default:n(()=>[ye,t(v,{name:"DownOutlined"})]),_:1})]),_:1})]),_:1})]),_:1}),t(d,{spinning:e.table.loading},{default:n(()=>[t(A,{class:"mt-15",ref:"refTable",size:"medium",border:"",stripe:"",data:e.table.data,"row-config":{isCurrent:!0,isHover:!0},"column-config":{isCurrent:!0,resizable:!0},"checkbox-config":{highlight:!0}},{default:n(()=>[t(f,{type:"checkbox",width:"60"}),t(f,{field:"name",title:"\u771F\u5B9E\u59D3\u540D"}),t(f,{field:"loginName",title:"\u8D26\u53F7"}),t(f,{field:"\u6240\u5C5E\u89D2\u8272",title:"\u6240\u5C5E\u89D2\u8272"}),t(f,{field:"phone",title:"\u8054\u7CFB\u7535\u8BDD"}),t(f,{field:"organizationName",title:"\u6240\u5C5E\u7EC4\u7EC7"}),t(f,{field:"lastModificationTime",title:"\u66F4\u65B0\u65F6\u95F4"}),t(f,{field:"creationTime",title:"\u521B\u5EFA\u65F6\u95F4"}),(e.power.update||e.power.delete)&&!e.$props.isFindBack?(c(),y(f,{key:0,field:"id",title:"\u64CD\u4F5C"},{default:n(({row:r})=>[e.power.update?(c(),k("a",{key:0,href:"javascript:void(0)",onClick:V=>e.openForm(r.id)},"\u7F16\u8F91",8,ke)):h("",!0),t(P,{type:"vertical"}),e.power.delete?(c(),y(R,{key:1,title:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onConfirm:V=>e.deleteList(r.id),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"},{default:n(()=>[we]),_:2},1032,["onConfirm"])):h("",!0)]),_:1})):h("",!0)]),_:1},8,["data"]),t(U,{class:"mt-15",background:"","current-page":e.table.page,"onUpdate:current-page":a[9]||(a[9]=r=>e.table.page=r),"page-size":e.table.rows,"onUpdate:page-size":a[10]||(a[10]=r=>e.table.rows=r),total:e.table.total,"page-sizes":e.table.pageSizeOptions,layouts:["PrevJump","PrevPage","JumpNumber","NextPage","NextJump","Sizes","FullJump","Total"],onPageChange:e.onChange},null,8,["current-page","page-size","total","page-sizes","onPageChange"])]),_:1},8,["spinning"])]),_:1})]),_:1})]),_:1}),t(E,{ref:"refForm",onOnSuccess:a[11]||(a[11]=()=>e.findList())},null,512)])}var Te=ae(ie,[["render",Ce],["__scopeId","data-v-60aa0862"]]);export{Te as default};
